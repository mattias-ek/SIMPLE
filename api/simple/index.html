
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../../examples/rose_diagram/">
      
      
        <link rel="next" href="../plotting/">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>User Reference - SIMPLE v0.4.3</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#user-reference" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="SIMPLE v0.4.3" class="md-header__button md-logo" aria-label="SIMPLE v0.4.3" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            SIMPLE v0.4.3
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              User Reference
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="SIMPLE v0.4.3" class="md-nav__button md-logo" aria-label="SIMPLE v0.4.3" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    SIMPLE v0.4.3
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    User Guide
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Tutorials
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Tutorials
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/ccsne_tutorial1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tutorial 1 - Getting Started
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/ccsne_tutorial2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tutorial 2 - Normalising abundances
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/ccsne_tutorial3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tutorial 3 - Plotting
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Examples
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Examples
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/create_simple_db/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Create CCSNe database
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/rose_diagram/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Introduction to rose diagrams
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    User Reference
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    User Reference
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-simple-namespace" class="md-nav__link">
    <span class="md-ellipsis">
      
        The simple Namespace
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.add_weights" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;add_weights
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.add_weights_ccsne" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;add_weights_ccsne
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.asarray" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;asarray
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.aselement" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;aselement
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.aselements" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;aselements
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.asisolist" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;asisolist
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.asisotope" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;asisotope
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.asisotopes" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;asisotopes
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.askeyarray" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;askeyarray
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.asratio" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;asratio
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.asratios" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;asratios
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.create_legend" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;create_legend
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.create_rose_plot" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;create_rose_plot
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.create_subplots" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;create_subplots
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.get_data" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_data
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.get_isotopes_of_element" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_isotopes_of_element
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.hist" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;hist
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.hist_ccsne" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;hist_ccsne
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.load_collection" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;load_collection
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.load_defaults" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;load_defaults
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.new_collection" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;new_collection
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.plot" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;plot
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.plot_ccsne" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;plot_ccsne
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.set_logging_level" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;set_logging_level
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.slope" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;slope
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.update_axes" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;update_axes
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    API Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    API Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../plotting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    simple.plotting
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../norm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    simple.norm
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    simple.models
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    simple.utils
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ccsne/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    simple.ccsne
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../roseaxes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    simple.roseaxes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../changelog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Changelog
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    About
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-simple-namespace" class="md-nav__link">
    <span class="md-ellipsis">
      
        The simple Namespace
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.add_weights" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;add_weights
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.add_weights_ccsne" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;add_weights_ccsne
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.asarray" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;asarray
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.aselement" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;aselement
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.aselements" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;aselements
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.asisolist" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;asisolist
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.asisotope" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;asisotope
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.asisotopes" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;asisotopes
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.askeyarray" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;askeyarray
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.asratio" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;asratio
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.asratios" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;asratios
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.create_legend" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;create_legend
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.create_rose_plot" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;create_rose_plot
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.create_subplots" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;create_subplots
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.get_data" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_data
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.get_isotopes_of_element" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_isotopes_of_element
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.hist" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;hist
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.hist_ccsne" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;hist_ccsne
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.load_collection" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;load_collection
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.load_defaults" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;load_defaults
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.new_collection" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;new_collection
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.plot" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;plot
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.plot_ccsne" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;plot_ccsne
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.set_logging_level" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;set_logging_level
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.slope" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;slope
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.update_axes" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;update_axes
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="user-reference">User Reference</h1>
<p>The <code>simple</code> namespace exposes the core functionality required for standard use.<br />
This includes convenient access to all primary user-facing classes and functions, making it the recommended entry 
point for most workflows.</p>
<p>For more advanced, specialised, or lower-level functionality, you can import directly from the individual submodules:</p>
<ul>
<li><a href="/api/models/"><code>simple.models</code></a>: primary object structures</li>
<li><a href="/api/norm/"><code>simple.norm</code></a>: normalisation schemes</li>
<li><a href="/api/plotting/"><code>simple.plotting</code></a>: visualisation utilities</li>
<li><a href="/api/utils/"><code>simple.utils</code></a>: miscellaneous internal and support utilities</li>
<li><a href="/api/ccsne/"><code>simple.ccsne</code></a>: CCSNe-specific utilities</li>
<li><a href="/api/roseaxes/"><code>simple.roseaxes</code></a>: contains the RoseAxes class and associated utilities.</li>
</ul>
<hr />
<h2 id="the-simple-namespace">The <code>simple</code> Namespace</h2>


<div class="doc doc-object doc-module">




    <div class="doc doc-contents first">



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="simple.add_weights" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">add_weights</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">add_weights</span><span class="p">(</span><span class="n">modeldata</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">sum_weights</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">norm_weights</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">default_attrname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mask_na</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axisname</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Add weights to the specified axis of each datapoint in the modeldata dictionary.</p>
<p>This function appends a new array of weights (under <code>axisname</code>) to each datapoint
in <code>modeldata</code>. The weights can be a constant or a string referring to data to be individually
retrieved from each model. Optionally, the weights can be summed, normalized, and masked for missing data.</p>
<p>The 'mask' and 'mask_na' arguments should be the same as those used to generate <code>modeldata</code> to ensure
consistent results.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code>modeldata</code></b>
              (<code><span title="dict">dict</span></code>)
          –
          <div class="doc-md-description">
            <p>The data dictionary returned from <code>get_data</code>. It should be a
dict of models, each containing a list of datapoint dictionaries.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>axis</code></b>
              (<code><span title="str">str</span></code>)
          –
          <div class="doc-md-description">
            <p>The axis in the datapoints that the weights correspond to (e.g., 'x', 'y').</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>weights</code></b>
              (<code>(<span title="int">int</span>, <span title="float">float</span>, <span title="str">str</span>)</code>, default:
                  <code>1</code>
)
          –
          <div class="doc-md-description">
            <p>The weights to add. Can be:
- A scalar to apply uniformly,
- A string key that will be used to retrieve data from each model individually.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>sum_weights</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>If True and <code>weights</code> is a string consisting of multiple keys, the values for the different
keys are summed together and used for each datapoint for a given model. Default is True.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>norm_weights</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>If True, normalise weights along the specified axis. Default is True.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>default_attrname</code></b>
              (<code><span title="str">str</span> or None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Attribute name to use when fetching weights if not included
in labels. Optional.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>unit</code></b>
              (<code><span title="str">str</span> or None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Unit to assign to the fetched weight values. Optional.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>default_value</code></b>
              (<code><span title="float">float</span></code>, default:
                  <code>0</code>
)
          –
          <div class="doc-md-description">
            <p>Default value to assign if weights are missing. Default is 0.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>mask</code></b>
              (<code><span title="str">str</span> or None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Optional mask to apply to the data when computing or assigning weights.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>mask_na</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>If True, mask values will be replaced with NaNs. If False, masked values are omitted.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>axisname</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;w&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>The name under which the weight data will be stored in each datapoint. Default is 'w'.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>dict</code></b>          –
          <div class="doc-md-description">
            <p>The modified <code>modeldata</code>, with weight arrays added to each datapoint.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Raises:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="ValueError">ValueError</span></code>
            –
          <div class="doc-md-description">
            <p>If the number of weight arrays does not match the number of datapoints
and they cannot be broadcast.</p>
          </div>
        </li>
    </ul>

            <details class="quote">
              <summary>Source code in <code>simple/plotting.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@utils</span><span class="o">.</span><span class="n">set_default_kwargs</span><span class="p">()</span>
<span class="k">def</span><span class="w"> </span><span class="nf">add_weights</span><span class="p">(</span><span class="n">modeldata</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
                <span class="n">sum_weights</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">norm_weights</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">default_attrname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">mask</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mask_na</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axisname</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Add weights to the specified axis of each datapoint in the modeldata dictionary.</span>

<span class="sd">    This function appends a new array of weights (under `axisname`) to each datapoint</span>
<span class="sd">    in `modeldata`. The weights can be a constant or a string referring to data to be individually</span>
<span class="sd">    retrieved from each model. Optionally, the weights can be summed, normalized, and masked for missing data.</span>

<span class="sd">    The &#39;mask&#39; and &#39;mask_na&#39; arguments should be the same as those used to generate `modeldata` to ensure</span>
<span class="sd">    consistent results.</span>

<span class="sd">    Args:</span>
<span class="sd">        modeldata (dict): The data dictionary returned from `get_data`. It should be a</span>
<span class="sd">            dict of models, each containing a list of datapoint dictionaries.</span>
<span class="sd">        axis (str): The axis in the datapoints that the weights correspond to (e.g., &#39;x&#39;, &#39;y&#39;).</span>
<span class="sd">        weights (int, float, str): The weights to add. Can be:</span>
<span class="sd">            - A scalar to apply uniformly,</span>
<span class="sd">            - A string key that will be used to retrieve data from each model individually.</span>
<span class="sd">        sum_weights (bool): If True and `weights` is a string consisting of multiple keys, the values for the different</span>
<span class="sd">            keys are summed together and used for each datapoint for a given model. Default is True.</span>
<span class="sd">        norm_weights (bool): If True, normalise weights along the specified axis. Default is True.</span>
<span class="sd">        default_attrname (str or None): Attribute name to use when fetching weights if not included</span>
<span class="sd">            in labels. Optional.</span>
<span class="sd">        unit (str or None): Unit to assign to the fetched weight values. Optional.</span>
<span class="sd">        default_value (float): Default value to assign if weights are missing. Default is 0.</span>
<span class="sd">        mask (str or None): Optional mask to apply to the data when computing or assigning weights.</span>
<span class="sd">        mask_na (bool): If True, mask values will be replaced with NaNs. If False, masked values are omitted.</span>
<span class="sd">        axisname (str): The name under which the weight data will be stored in each datapoint. Default is &#39;w&#39;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: The modified `modeldata`, with weight arrays added to each datapoint.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the number of weight arrays does not match the number of datapoints</span>
<span class="sd">            and they cannot be broadcast.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Remove any previous weights</span>
    <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">modeldata</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">dp</span> <span class="ow">in</span> <span class="n">modeldata</span><span class="p">[</span><span class="n">model</span><span class="p">]:</span>
            <span class="n">dp</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">axisname</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="n">models</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">modeldata</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">modeldata_w</span><span class="p">,</span> <span class="n">axis_labels_w</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;w&#39;</span><span class="p">:</span> <span class="n">weights</span><span class="p">},</span>
                                              <span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">,</span> <span class="n">mask_na</span><span class="o">=</span><span class="n">mask_na</span><span class="p">,</span>
                                              <span class="n">default_attrname</span><span class="o">=</span><span class="n">default_attrname</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">unit</span><span class="p">,</span>
                                              <span class="n">default_value</span><span class="o">=</span><span class="n">default_value</span><span class="p">,</span>
                                              <span class="n">attrname_in_label</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">model_in_label</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">axis_name_in_label</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                              <span class="n">latex_labels</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">sum_weights</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">model</span><span class="p">,</span> <span class="n">datapoints_w</span> <span class="ow">in</span> <span class="n">modeldata_w</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">datapoints_w</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">dw</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="s1">&#39;Missing label&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">dw</span> <span class="ow">in</span> <span class="n">datapoints_w</span><span class="p">]</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">model</span><span class="si">}</span><span class="s1">: Calculating weights by adding together: </span><span class="si">{</span><span class="n">axis_labels_w</span><span class="p">[</span><span class="s2">&quot;w&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> &lt;w: </span><span class="si">{</span><span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span><span class="si">}</span><span class="s1">&gt;&#39;</span><span class="p">)</span>
                    <span class="n">modeldata_w</span><span class="p">[</span><span class="n">model</span><span class="p">]</span> <span class="o">=</span> <span class="p">[{</span><span class="n">axisname</span><span class="p">:</span> <span class="n">functools</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="p">,</span> <span class="p">[</span><span class="n">dw</span><span class="p">[</span><span class="s1">&#39;w&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">dw</span> <span class="ow">in</span> <span class="n">datapoints_w</span><span class="p">])}]</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">modeldata_w</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span><span class="p">:</span>
            <span class="n">datapoints_xy</span> <span class="o">=</span> <span class="n">modeldata</span><span class="p">[</span><span class="n">model</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">mask</span><span class="p">:</span>
                <span class="n">m</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_mask</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">mask_na</span><span class="p">:</span>
                    <span class="n">modeldata_w</span><span class="p">[</span><span class="n">model</span><span class="p">]</span> <span class="o">=</span> <span class="p">[{</span><span class="n">axisname</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)}]</span>
                    <span class="n">modeldata_w</span><span class="p">[</span><span class="n">model</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">axisname</span><span class="p">][</span><span class="n">np</span><span class="o">.</span><span class="n">logical_not</span><span class="p">(</span><span class="n">m</span><span class="p">)]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">modeldata_w</span><span class="p">[</span><span class="n">model</span><span class="p">]</span> <span class="o">=</span> <span class="p">[{</span><span class="n">axisname</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="n">m</span><span class="p">),</span> <span class="n">weights</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)}]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">modeldata_w</span><span class="p">[</span><span class="n">model</span><span class="p">]</span> <span class="o">=</span> <span class="p">[{</span><span class="n">axisname</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">dp</span><span class="p">[</span><span class="n">axis</span><span class="p">],</span> <span class="n">weights</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)}</span> <span class="k">for</span> <span class="n">dp</span> <span class="ow">in</span> <span class="n">datapoints_xy</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">model</span><span class="p">,</span> <span class="n">datapoints</span> <span class="ow">in</span> <span class="n">modeldata</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">datapoints_w</span> <span class="o">=</span> <span class="n">modeldata_w</span><span class="p">[</span><span class="n">model</span><span class="p">]</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">datapoints_w</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">datapoints</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">datapoint</span> <span class="ow">in</span> <span class="n">datapoints</span><span class="p">:</span>
                <span class="n">datapoint</span><span class="p">[</span><span class="n">axisname</span><span class="p">]</span> <span class="o">=</span> <span class="n">datapoints_w</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">axisname</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">datapoints_w</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">datapoints</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">datapoint</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">datapoints</span><span class="p">):</span>
                <span class="n">datapoint</span><span class="p">[</span><span class="n">axisname</span><span class="p">]</span> <span class="o">=</span> <span class="n">datapoints_w</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">axisname</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Size of weights data incompatible with size of </span><span class="si">{</span><span class="n">axis</span><span class="si">}</span><span class="s1"> data&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">norm_weights</span><span class="p">:</span>
        <span class="n">_norm_weights</span><span class="p">(</span><span class="n">modeldata</span><span class="p">,</span> <span class="n">axisname</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">modeldata</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="simple.add_weights_ccsne" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">add_weights_ccsne</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">add_weights_ccsne</span><span class="p">(</span><span class="n">modeldata</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Add weights to the specified axis of each CCSNe datapoint in the modeldata dictionary.</p>
<p>Before normalisation, if applied, the weight of each datapoint will be multiplied by the
mass of each mass coordinate.</p>
<p>This function appends a new array of weights (under <code>axisname</code>) to each datapoint
in <code>modeldata</code>. The weights can be a constant or a string referring to data to be indvidually
retrieved from each model. Optionally, the weights can be summed,
normalized, and masked for missing data.</p>
<p>The <code>mask</code> and <code>mask_na</code> arguments should be the same as those used to generate 'modeldata' to ensure
conistent results.</p>
<p>Add weights to CCSNe datapoints by combining standard weighting with mass coordinate scaling.</p>
<p>This function extends <code>add_weights</code> by additionally multiplying the resulting weights
by the mass associated with each mass coordinate in CCSNe models.</p>
<p>The initial weighting follows the same logic as <code>add_weights</code>, accepting either a scalar
or a string referring to model attributes. The 'mask' and 'mask_na' arguments should
match those used when creating <code>modeldata</code> to ensure consistency.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code>modeldata</code></b>
              (<code><span title="dict">dict</span></code>)
          –
          <div class="doc-md-description">
            <p>The data dictionary as returned by <code>get_data</code>, structured as
{model_name: list of datapoints}. Each datapoint is a dictionary.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>axis</code></b>
              (<code><span title="str">str</span></code>)
          –
          <div class="doc-md-description">
            <p>The axis key to which the weights apply (e.g., 'x', 'y').</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>weights</code></b>
              (<code>int, float, or str</code>, default:
                  <code>1</code>
)
          –
          <div class="doc-md-description">
            <p>The weight specification. Can be:
- A scalar to apply uniformly across all datapoints,
- A string key to retrieve values from each model individually.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>**kwargs</code></b>
          –
          <div class="doc-md-description">
            <p>Any valid keyword arguments for the <code>add_weights</code> function.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>dict</code></b>          –
          <div class="doc-md-description">
            <p>The modified <code>modeldata</code>, with weight arrays added to each datapoint.</p>
          </div>
        </li>
    </ul>

            <details class="quote">
              <summary>Source code in <code>simple/ccsne.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@utils</span><span class="o">.</span><span class="n">set_default_kwargs</span><span class="p">(</span><span class="n">inherits_</span><span class="o">=</span><span class="n">plotting</span><span class="o">.</span><span class="n">add_weights</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">add_weights_ccsne</span><span class="p">(</span><span class="n">modeldata</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">weights</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Add weights to the specified axis of each CCSNe datapoint in the modeldata dictionary.</span>

<span class="sd">    Before normalisation, if applied, the weight of each datapoint will be multiplied by the</span>
<span class="sd">    mass of each mass coordinate.</span>

<span class="sd">    This function appends a new array of weights (under `axisname`) to each datapoint</span>
<span class="sd">    in `modeldata`. The weights can be a constant or a string referring to data to be indvidually</span>
<span class="sd">    retrieved from each model. Optionally, the weights can be summed,</span>
<span class="sd">    normalized, and masked for missing data.</span>

<span class="sd">    The `mask` and `mask_na` arguments should be the same as those used to generate &#39;modeldata&#39; to ensure</span>
<span class="sd">    conistent results.</span>

<span class="sd">    Add weights to CCSNe datapoints by combining standard weighting with mass coordinate scaling.</span>

<span class="sd">    This function extends `add_weights` by additionally multiplying the resulting weights</span>
<span class="sd">    by the mass associated with each mass coordinate in CCSNe models.</span>

<span class="sd">    The initial weighting follows the same logic as `add_weights`, accepting either a scalar</span>
<span class="sd">    or a string referring to model attributes. The &#39;mask&#39; and &#39;mask_na&#39; arguments should</span>
<span class="sd">    match those used when creating `modeldata` to ensure consistency.</span>

<span class="sd">    Args:</span>
<span class="sd">        modeldata (dict): The data dictionary as returned by `get_data`, structured as</span>
<span class="sd">            {model_name: list of datapoints}. Each datapoint is a dictionary.</span>
<span class="sd">        axis (str): The axis key to which the weights apply (e.g., &#39;x&#39;, &#39;y&#39;).</span>
<span class="sd">        weights (int, float, or str): The weight specification. Can be:</span>
<span class="sd">            - A scalar to apply uniformly across all datapoints,</span>
<span class="sd">            - A string key to retrieve values from each model individually.</span>
<span class="sd">        **kwargs: Any valid keyword arguments for the `add_weights` function.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: The modified `modeldata`, with weight arrays added to each datapoint.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">mask</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;mask&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">mask_na</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;mask_na&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">axisname</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;axisname&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>

    <span class="n">norm_weights</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;norm_weights&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span> <span class="c1"># Defaults to the value of add_weights</span>
    <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;norm_weights&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">modeldata</span> <span class="o">=</span> <span class="n">plotting</span><span class="o">.</span><span class="n">add_weights</span><span class="p">(</span><span class="n">modeldata</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Multiplying all weights by the mass coordinate mass&#39;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">model</span><span class="p">,</span> <span class="n">datapoints</span> <span class="ow">in</span> <span class="n">modeldata</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">masscoord_mass</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">masscoord_mass</span>
        <span class="k">if</span> <span class="n">mask</span><span class="p">:</span>
            <span class="n">imask</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_mask</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">ki</span><span class="p">,</span> <span class="n">datapoint</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">datapoints</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">mask</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">mask_na</span><span class="p">:</span>
                <span class="n">datapoint</span><span class="p">[</span><span class="n">axisname</span><span class="p">]</span> <span class="o">=</span> <span class="n">datapoint</span><span class="p">[</span><span class="n">axisname</span><span class="p">]</span> <span class="o">*</span> <span class="n">masscoord_mass</span><span class="p">[</span><span class="n">imask</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">datapoint</span><span class="p">[</span><span class="n">axisname</span><span class="p">]</span> <span class="o">=</span> <span class="n">datapoint</span><span class="p">[</span><span class="n">axisname</span><span class="p">]</span> <span class="o">*</span> <span class="n">masscoord_mass</span>

    <span class="k">if</span> <span class="n">norm_weights</span><span class="p">:</span>
        <span class="n">plotting</span><span class="o">.</span><span class="n">_norm_weights</span><span class="p">(</span><span class="n">modeldata</span><span class="p">,</span> <span class="n">axisname</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">modeldata</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="simple.asarray" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">asarray</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">asarray</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">saving</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Convert <code>data</code> to a numpy array.</p>
<p>If <code>data</code> is a string or a sequence of strings and <code>saving=False</code>, either a single string or a tuple
of string will be returned. If <code>saving</code> is <code>True</code> the values will be converted to an array with a byte dtype.
This ensures values are compatible with the hdf5 library.</p>
<p>Arrays with a <code>bytes</code> dtype will automatically be converted to the <code>str</code> dtype. If <code>saving</code> is <code>False</code> then
this values will be converted to either a string or a tuple of strings (see above).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code>values</code></b>
          –
          <div class="doc-md-description">
            <p>An values like object.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>dtype</code></b>
          –
          <div class="doc-md-description">
            <p>The data type of the returned values.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>saving</code></b>
          –
          <div class="doc-md-description">
            <p>Should be <code>True</code> is the data is to be saved in a hdf5 file.</p>
          </div>
        </li>
    </ul>

            <details class="quote">
              <summary>Source code in <code>simple/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">asarray</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">saving</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert ``data`` to a numpy array.</span>

<span class="sd">    If ``data`` is a string or a sequence of strings and ``saving=False``, either a single string or a tuple</span>
<span class="sd">    of string will be returned. If ``saving`` is ``True`` the values will be converted to an array with a byte dtype.</span>
<span class="sd">    This ensures values are compatible with the hdf5 library.</span>

<span class="sd">    Arrays with a ``bytes`` dtype will automatically be converted to the ``str`` dtype. If ``saving`` is ``False`` then</span>
<span class="sd">    this values will be converted to either a string or a tuple of strings (see above).</span>

<span class="sd">    Args:</span>
<span class="sd">        values (): An values like object.</span>
<span class="sd">        dtype (): The data type of the returned values.</span>
<span class="sd">        saving (): Should be ``True`` is the data is to be saved in a hdf5 file.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">values</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">bytes_</span><span class="p">:</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">str_</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">saving</span> <span class="ow">and</span> <span class="n">values</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">str_</span><span class="p">:</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
            <span class="n">values</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">saving</span> <span class="ow">and</span> <span class="n">values</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">str_</span><span class="p">:</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">bytes_</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">values</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="simple.aselement" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">aselement</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">aselement</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="n">without_suffix</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">allow_invalid</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Returns a <a class="autorefs autorefs-internal" href="../utils/#simple.utils.Element"><code>Element</code></a> representing an element symbol.</p>
<p>The returned element format is the capitalised element
symbol followed by the suffix, if present. E.g. <code>Pd-104*</code> where
<code>*</code> is the suffix.</p>
<p>The case of the element symbol is not considered.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code>string</code></b>
              (<code><span title="str">str</span></code>)
          –
          <div class="doc-md-description">
            <p>A string containing an element symbol.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>without_suffix</code></b>
          –
          <div class="doc-md-description">
            <p>If <code>True</code> the suffix part of the string is ignored.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>allow_invalid</code></b>
          –
          <div class="doc-md-description">
            <p>If <code>False</code>, and <code>string</code> cannot be parsed into an element string, an exception is
raised. If <code>True</code> then <code>string.strip()</code> is returned instead.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">ele</span> <span class="o">=</span> <span class="n">simple</span><span class="o">.</span><span class="n">asisotope</span><span class="p">(</span><span class="s2">&quot;pd&quot;</span><span class="p">);</span> <span class="n">ele</span>
<span class="go">&quot;Pd&quot;</span>
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>simple/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">aselement</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="n">without_suffix</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">allow_invalid</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a [``Element``][simple.utils.Element] representing an element symbol.</span>

<span class="sd">    The returned element format is the capitalised element</span>
<span class="sd">    symbol followed by the suffix, if present. E.g. ``Pd-104*`` where</span>
<span class="sd">    ``*`` is the suffix.</span>

<span class="sd">    The case of the element symbol is not considered.</span>

<span class="sd">    Args:</span>
<span class="sd">        string (str): A string containing an element symbol.</span>
<span class="sd">        without_suffix (): If ``True`` the suffix part of the string is ignored.</span>
<span class="sd">        allow_invalid ():  If ``False``, and ``string`` cannot be parsed into an element string, an exception is</span>
<span class="sd">            raised. If ``True`` then ``string.strip()`` is returned instead.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; ele = simple.asisotope(&quot;pd&quot;); ele</span>
<span class="sd">        &quot;Pd&quot;</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span> <span class="ow">is</span> <span class="n">Element</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">without_suffix</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">string</span><span class="o">.</span><span class="n">without_suffix</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">string</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">string</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;``string`` must a str not </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Element</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="n">without_suffix</span><span class="o">=</span><span class="n">without_suffix</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">allow_invalid</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">string</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="simple.aselements" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">aselements</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">aselements</span><span class="p">(</span><span class="n">strings</span><span class="p">,</span> <span class="n">without_suffix</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">allow_invalid</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Returns a tuple of <a class="autorefs autorefs-internal" href="../utils/#simple.utils.Element"><code>Element</code></a> strings where each string represents an element symbol.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code>strings</code></b>
          –
          <div class="doc-md-description">
            <p>Can either be a string with element symbol seperated by a <code>,</code> or a sequence of strings.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>without_suffix</code></b>
          –
          <div class="doc-md-description">
            <p>If <code>True</code> the suffix part of each isotope string is ignored.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>allow_invalid</code></b>
          –
          <div class="doc-md-description">
            <p>If <code>False</code>, and a string cannot be parsed into an isotope string, an exception is
raised. If <code>True</code> then <code>string.strip()</code> is returned instead.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">simple</span><span class="o">.</span><span class="n">asisotopes</span><span class="p">(</span><span class="s1">&#39;ru, pd, cd&#39;</span><span class="p">)</span>
<span class="go">(&#39;Ru&#39;, &#39;Pd&#39;, &#39;Cd&#39;)</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">simple</span><span class="o">.</span><span class="n">asisotopes</span><span class="p">([</span><span class="s1">&#39;ru&#39;</span><span class="p">,</span> <span class="s1">&#39;pd&#39;</span><span class="p">,</span> <span class="s1">&#39;cd&#39;</span><span class="p">])</span>
<span class="go">(&#39;Ru&#39;, &#39;Pd&#39;, &#39;Cd&#39;)</span>
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>simple/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">aselements</span><span class="p">(</span><span class="n">strings</span><span class="p">,</span> <span class="n">without_suffix</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">allow_invalid</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a tuple of [``Element``][simple.utils.Element] strings where each string represents an element symbol.</span>

<span class="sd">    Args:</span>
<span class="sd">        strings (): Can either be a string with element symbol seperated by a ``,`` or a sequence of strings.</span>
<span class="sd">        without_suffix (): If ``True`` the suffix part of each isotope string is ignored.</span>
<span class="sd">        allow_invalid ():  If ``False``, and a string cannot be parsed into an isotope string, an exception is</span>
<span class="sd">            raised. If ``True`` then ``string.strip()`` is returned instead.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; simple.asisotopes(&#39;ru, pd, cd&#39;)</span>
<span class="sd">        (&#39;Ru&#39;, &#39;Pd&#39;, &#39;Cd&#39;)</span>

<span class="sd">        &gt;&gt;&gt; simple.asisotopes([&#39;ru&#39;, &#39;pd&#39;, &#39;cd&#39;])</span>
<span class="sd">        (&#39;Ru&#39;, &#39;Pd&#39;, &#39;Cd&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">strings</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">strings</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">strings</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)]</span>

    <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">aselement</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="n">without_suffix</span><span class="o">=</span><span class="n">without_suffix</span><span class="p">,</span> <span class="n">allow_invalid</span><span class="o">=</span><span class="n">allow_invalid</span><span class="p">)</span> <span class="k">for</span> <span class="n">string</span> <span class="ow">in</span> <span class="n">strings</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="simple.asisolist" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">asisolist</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">asisolist</span><span class="p">(</span><span class="n">isolist</span><span class="p">,</span> <span class="n">without_suffix</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">allow_invalid</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Return a dictionary consisting of an isotope key mapped to a tuple of isotopes that should make up the
key isotope.</p>
<p>If <code>isolist</code> is list or tuple of keys then each key will be mapped only to itself.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code>isolist</code></b>
          –
          <div class="doc-md-description">
            <p>Either a dictionary mapping a single isotope to a list of isotopes or a sequence of isotopes that
will be mapped to themselfs.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>without_suffix</code></b>
          –
          <div class="doc-md-description">
            <p>If <code>True</code> the suffix part of each isotope string is ignored.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>allow_invalid</code></b>
          –
          <div class="doc-md-description">
            <p>If <code>True</code> invalid isotopes string are allowed. If <code>False</code> they will instead raise
an exception.</p>
          </div>
        </li>
    </ul>

            <details class="quote">
              <summary>Source code in <code>simple/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">asisolist</span><span class="p">(</span><span class="n">isolist</span><span class="p">,</span> <span class="n">without_suffix</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">allow_invalid</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a dictionary consisting of an isotope key mapped to a tuple of isotopes that should make up the</span>
<span class="sd">    key isotope.</span>

<span class="sd">    If ``isolist`` is list or tuple of keys then each key will be mapped only to itself.</span>

<span class="sd">    Args:</span>
<span class="sd">        isolist (): Either a dictionary mapping a single isotope to a list of isotopes or a sequence of isotopes that</span>
<span class="sd">            will be mapped to themselfs.</span>
<span class="sd">        without_suffix (): If ``True`` the suffix part of each isotope string is ignored.</span>
<span class="sd">        allow_invalid (): If ``True`` invalid isotopes string are allowed. If ``False`` they will instead raise</span>
<span class="sd">            an exception.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">isolist</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="n">isolist</span> <span class="o">=</span> <span class="n">asisotopes</span><span class="p">(</span><span class="n">isolist</span><span class="p">,</span> <span class="n">without_suffix</span><span class="o">=</span><span class="n">without_suffix</span><span class="p">,</span> <span class="n">allow_invalid</span><span class="o">=</span><span class="n">allow_invalid</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{</span><span class="n">iso</span><span class="p">:</span> <span class="p">(</span><span class="n">iso</span><span class="p">,)</span> <span class="k">for</span> <span class="n">iso</span> <span class="ow">in</span> <span class="n">isolist</span><span class="p">}</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{</span><span class="n">asisotope</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">without_suffix</span><span class="o">=</span><span class="n">without_suffix</span><span class="p">,</span> <span class="n">allow_invalid</span><span class="o">=</span><span class="n">allow_invalid</span><span class="p">):</span>
                <span class="n">asisotopes</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">without_suffix</span><span class="o">=</span><span class="n">without_suffix</span><span class="p">,</span> <span class="n">allow_invalid</span><span class="o">=</span><span class="n">allow_invalid</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">isolist</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="simple.asisotope" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">asisotope</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">asisotope</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="n">without_suffix</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">allow_invalid</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Returns a <a class="autorefs autorefs-internal" href="../utils/#simple.utils.Isotope"><code>Isotope</code></a> representing an isotope.</p>
<p>The returned isotope format is the capitalised element
symbol followed by a dash followed by the mass number followed by the suffix, if present. E.g. <code>Pd-104*</code> where
<code>*</code> is the suffix.</p>
<p>The order of the element symbol and mass number in <code>string</code> is not important, but they must proceed the suffix.
The element symbol and mass number may be seperated by <code>-</code>. The case of the element symbol is not
considered.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code>string</code></b>
              (<code><span title="str">str</span></code>)
          –
          <div class="doc-md-description">
            <p>A string element symbol and a mass number.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>without_suffix</code></b>
          –
          <div class="doc-md-description">
            <p>If <code>True</code> the suffix part of the isotope string is ignored.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>allow_invalid</code></b>
          –
          <div class="doc-md-description">
            <p>If <code>False</code>, and <code>string</code> cannot be parsed into an isotope string, an exception is
raised. If <code>True</code> then <code>string.strip()</code> is returned instead.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">iso</span> <span class="o">=</span> <span class="n">simple</span><span class="o">.</span><span class="n">asisotope</span><span class="p">(</span><span class="s2">&quot;104pd&quot;</span><span class="p">);</span> <span class="n">iso</span> <span class="c1"># pd104, 104-Pd etc are also valid</span>
<span class="go">&quot;Pd-104&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iso</span><span class="o">.</span><span class="n">symbol</span><span class="p">,</span> <span class="n">iso</span><span class="o">.</span><span class="n">mass</span>
<span class="go">&quot;Pd&quot;, &quot;104&quot;</span>
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>simple/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">asisotope</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="n">without_suffix</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">allow_invalid</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a [``Isotope``][simple.utils.Isotope] representing an isotope.</span>

<span class="sd">    The returned isotope format is the capitalised element</span>
<span class="sd">    symbol followed by a dash followed by the mass number followed by the suffix, if present. E.g. ``Pd-104*`` where</span>
<span class="sd">    ``*`` is the suffix.</span>

<span class="sd">    The order of the element symbol and mass number in ``string`` is not important, but they must proceed the suffix.</span>
<span class="sd">    The element symbol and mass number may be seperated by ``-``. The case of the element symbol is not</span>
<span class="sd">    considered.</span>

<span class="sd">    Args:</span>
<span class="sd">        string (str): A string element symbol and a mass number.</span>
<span class="sd">        without_suffix (): If ``True`` the suffix part of the isotope string is ignored.</span>
<span class="sd">        allow_invalid ():  If ``False``, and ``string`` cannot be parsed into an isotope string, an exception is</span>
<span class="sd">            raised. If ``True`` then ``string.strip()`` is returned instead.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; iso = simple.asisotope(&quot;104pd&quot;); iso # pd104, 104-Pd etc are also valid</span>
<span class="sd">        &quot;Pd-104&quot;</span>
<span class="sd">        &gt;&gt;&gt; iso.symbol, iso.mass</span>
<span class="sd">        &quot;Pd&quot;, &quot;104&quot;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span> <span class="ow">is</span> <span class="n">Isotope</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">without_suffix</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">string</span><span class="o">.</span><span class="n">without_suffix</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">string</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">string</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;``string`` must a str not </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Isotope</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="n">without_suffix</span><span class="o">=</span><span class="n">without_suffix</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">allow_invalid</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">string</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="simple.asisotopes" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">asisotopes</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">asisotopes</span><span class="p">(</span><span class="n">strings</span><span class="p">,</span> <span class="n">without_suffix</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">allow_invalid</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Returns a tuple of <a class="autorefs autorefs-internal" href="../utils/#simple.utils.Isotope"><code>Isotope</code></a> strings where each string represents an isotope.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code>strings</code></b>
          –
          <div class="doc-md-description">
            <p>Can either be a string with isotopes seperated by a <code>,</code> or a sequence of strings.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>without_suffix</code></b>
          –
          <div class="doc-md-description">
            <p>If <code>True</code> the suffix part of each isotope string is ignored.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>allow_invalid</code></b>
          –
          <div class="doc-md-description">
            <p>If <code>False</code>, and a string cannot be parsed into an isotope string, an exception is
raised. If <code>True</code> then <code>string.strip()</code> is returned instead.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">simple</span><span class="o">.</span><span class="n">asisotopes</span><span class="p">(</span><span class="s1">&#39;104pd, pd105, 106-Pd&#39;</span><span class="p">)</span>
<span class="go">(&#39;Pd-104&#39;, &#39;Pd-105, 106-Pd&#39;)</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">simple</span><span class="o">.</span><span class="n">asisotopes</span><span class="p">([</span><span class="s1">&#39;104pd&#39;</span><span class="p">,</span> <span class="s1">&#39;pd105&#39;</span><span class="p">,</span> <span class="s1">&#39;106-Pd&#39;</span><span class="p">])</span>
<span class="go">(&#39;Pd-104&#39;, &#39;Pd-105, 106-Pd&#39;)</span>
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>simple/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">956</span>
<span class="normal">957</span>
<span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span>
<span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span>
<span class="normal">967</span>
<span class="normal">968</span>
<span class="normal">969</span>
<span class="normal">970</span>
<span class="normal">971</span>
<span class="normal">972</span>
<span class="normal">973</span>
<span class="normal">974</span>
<span class="normal">975</span>
<span class="normal">976</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">asisotopes</span><span class="p">(</span><span class="n">strings</span><span class="p">,</span> <span class="n">without_suffix</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">allow_invalid</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a tuple of [``Isotope``][simple.utils.Isotope] strings where each string represents an isotope.</span>

<span class="sd">    Args:</span>
<span class="sd">        strings (): Can either be a string with isotopes seperated by a ``,`` or a sequence of strings.</span>
<span class="sd">        without_suffix (): If ``True`` the suffix part of each isotope string is ignored.</span>
<span class="sd">        allow_invalid ():  If ``False``, and a string cannot be parsed into an isotope string, an exception is</span>
<span class="sd">            raised. If ``True`` then ``string.strip()`` is returned instead.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; simple.asisotopes(&#39;104pd, pd105, 106-Pd&#39;)</span>
<span class="sd">        (&#39;Pd-104&#39;, &#39;Pd-105, 106-Pd&#39;)</span>

<span class="sd">        &gt;&gt;&gt; simple.asisotopes([&#39;104pd&#39;, &#39;pd105&#39;, &#39;106-Pd&#39;])</span>
<span class="sd">        (&#39;Pd-104&#39;, &#39;Pd-105, 106-Pd&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">strings</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">strings</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">strings</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)]</span>

    <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">asisotope</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="n">without_suffix</span><span class="o">=</span><span class="n">without_suffix</span><span class="p">,</span> <span class="n">allow_invalid</span><span class="o">=</span><span class="n">allow_invalid</span><span class="p">)</span> <span class="k">for</span> <span class="n">string</span> <span class="ow">in</span> <span class="n">strings</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="simple.askeyarray" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">askeyarray</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">askeyarray</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">keys</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Returns a numpy array where the columns can be accessed by the column key.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code>values</code></b>
          –
          <div class="doc-md-description">
            <p>An array consisting of 2 dimensions where first dimension is the row and the second
dimension is the column.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>keys</code></b>
          –
          <div class="doc-md-description">
            <p>The keys for each column in <code>values</code>. Must be the same length as the second dimension of <code>values</code>.
of <code>array</code>.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>dtype</code></b>
          –
          <div class="doc-md-description">
            <p>The values type of the returned array. All columns will have the same dtype.</p>
          </div>
        </li>
    </ul>
        <p><strong>Notes</strong>
If <code>values</code> has less then 2 dimensions then it is assumed to represent a single row of values.</p>
<p>It is not possible to save this type of array in hdf5 files if they have more than a few hundred columns.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">simple</span><span class="o">.</span><span class="n">askeyarray</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]],</span> <span class="p">[</span><span class="s1">&#39;Pd-104&#39;</span><span class="p">,</span><span class="s1">&#39;Pd-105&#39;</span><span class="p">,</span><span class="s1">&#39;Pd-106&#39;</span><span class="p">]);</span> <span class="n">a</span>
<span class="go">array([(1, 2, 3), (4, 5, 6)],</span>
<span class="go">      dtype=[(&#39;Pd-104&#39;, &#39;&lt;i8&#39;), (&#39;Pd-105&#39;, &#39;&lt;i8&#39;), (&#39;Pd-106&#39;, &#39;&lt;i8&#39;)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="s1">&#39;Pd-104&#39;</span><span class="p">]</span>
<span class="go">array([1, 4])</span>
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>simple/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">askeyarray</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">keys</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a numpy array where the columns can be accessed by the column key.</span>

<span class="sd">    Args:</span>
<span class="sd">        values (): An array consisting of 2 dimensions where first dimension is the row and the second</span>
<span class="sd">            dimension is the column.</span>
<span class="sd">        keys (): The keys for each column in ``values``. Must be the same length as the second dimension of ``values``.</span>
<span class="sd">            of ``array``.</span>
<span class="sd">        dtype (): The values type of the returned array. All columns will have the same dtype.</span>

<span class="sd">    **Notes**</span>
<span class="sd">    If ``values`` has less then 2 dimensions then it is assumed to represent a single row of values.</span>

<span class="sd">    It is not possible to save this type of array in hdf5 files if they have more than a few hundred columns.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; a = simple.askeyarray([[1,2,3],[4,5,6]], [&#39;Pd-104&#39;,&#39;Pd-105&#39;,&#39;Pd-106&#39;]); a</span>
<span class="sd">        array([(1, 2, 3), (4, 5, 6)],</span>
<span class="sd">              dtype=[(&#39;Pd-104&#39;, &#39;&lt;i8&#39;), (&#39;Pd-105&#39;, &#39;&lt;i8&#39;), (&#39;Pd-106&#39;, &#39;&lt;i8&#39;)])</span>
<span class="sd">        &gt;&gt;&gt; a[&#39;Pd-104&#39;]</span>
<span class="sd">        array([1, 4])</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">keys</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)]</span>

    <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
    <span class="n">dtype</span> <span class="o">=</span> <span class="p">[(</span><span class="n">k</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">a</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;``values`` cannot have more than 2 dimensions&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">keys</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s1">&#39;item (r:</span><span class="si">{</span><span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">, c:</span><span class="si">{</span><span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">) must have same number of columns as there are keys (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">tuple</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">a</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="simple.asratio" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">asratio</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">asratio</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="n">without_suffix</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">allow_invalid</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Returns a <a class="autorefs autorefs-internal" href="../utils/#simple.utils.Isotope"><code>Ratio</code></a> string representing the ratio of two isotopes.</p>
<p>The format of the returned string is the numerator followed by
a <code>/</code> followed by the normiso. The numerator and normiso string be parsed by <code>asisotope</code> together with
the given <code>without_suffix</code> and <code>allow_invalid</code> arguments passed to this function.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code>string</code></b>
              (<code><span title="str">str</span></code>)
          –
          <div class="doc-md-description">
            <p>A string contaning two strings seperated by a single <code>/</code>.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>without_suffix</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>If <code>True</code> the suffix part of the numerator and normiso string is ignored.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>allow_invalid</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>Whether the numerator and normiso has to be a valid isotope string.</p>
          </div>
        </li>
    </ul>
        <p>If the returned string is an isotope string it will have the following attributes and methods.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><span title="simple.asratio.numer">numer</span></code></b>
              (<code><span title="str">str</span></code>)
          –
          <div class="doc-md-description">
            <p>The numerator string</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="simple.asratio.denom">denom</span></code></b>
              (<code><span title="str">str</span></code>)
          –
          <div class="doc-md-description">
            <p>The normiso string</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Functions:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><span title="simple.asratio.latex">latex</span></code></b>
            –
            <div class="doc-md-description">
              <p>Returns a latex formatted version of the isotope.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><span title="simple.asratio.without_suffix">without_suffix</span></code></b>
            –
            <div class="doc-md-description">
              <p>Returns a ratio string omitting the numerator and normiso suffix.</p>
            </div>
          </li>
    </ul>

            <details class="quote">
              <summary>Source code in <code>simple/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">asratio</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="n">without_suffix</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">allow_invalid</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a [``Ratio``][simple.utils.Isotope] string representing the ratio of two isotopes.</span>

<span class="sd">    The format of the returned string is the numerator followed by</span>
<span class="sd">    a ``/`` followed by the normiso. The numerator and normiso string be parsed by ``asisotope`` together with</span>
<span class="sd">    the given ``without_suffix`` and ``allow_invalid`` arguments passed to this function.</span>

<span class="sd">    Args:</span>
<span class="sd">        string (str): A string contaning two strings seperated by a single ``/``.</span>
<span class="sd">        without_suffix (bool): If ``True`` the suffix part of the numerator and normiso string is ignored.</span>
<span class="sd">        allow_invalid (bool): Whether the numerator and normiso has to be a valid isotope string.</span>

<span class="sd">    If the returned string is an isotope string it will have the following attributes and methods.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        numer (str): The numerator string</span>
<span class="sd">        denom (str): The normiso string</span>

<span class="sd">    Methods:</span>
<span class="sd">        latex(string): Returns a latex formatted version of the isotope.</span>
<span class="sd">        without_suffix(): Returns a ratio string omitting the numerator and normiso suffix.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span> <span class="ow">is</span> <span class="n">Ratio</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">string</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">string</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;``string`` must a str not </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">string</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Ratio</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="n">without_suffix</span><span class="o">=</span><span class="n">without_suffix</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">allow_invalid</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">string</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="simple.asratios" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">asratios</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">asratios</span><span class="p">(</span><span class="n">strings</span><span class="p">,</span> <span class="n">without_suffix</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">allow_invalid</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Returns a tuple of <a class="autorefs autorefs-internal" href="../utils/#simple.utils.Isotope"><code>Ratio</code></a> strings where each string represents the ratio of two isotopes.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code>strings</code></b>
          –
          <div class="doc-md-description">
            <p>Can either be a string with isotope ratios seperated by a <code>,</code> or a sequence of strings.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>without_suffix</code></b>
          –
          <div class="doc-md-description">
            <p>If <code>True</code> the suffix part of each isotope string is ignored.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>allow_invalid</code></b>
          –
          <div class="doc-md-description">
            <p>If <code>False</code>, and a string cannot be parsed into an isotope string, an exception is
raised. If <code>True</code> then <code>string.strip()</code> is returned instead.</p>
          </div>
        </li>
    </ul>

            <details class="quote">
              <summary>Source code in <code>simple/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">asratios</span><span class="p">(</span><span class="n">strings</span><span class="p">,</span> <span class="n">without_suffix</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">allow_invalid</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a tuple of [``Ratio``][simple.utils.Isotope] strings where each string represents the ratio of two isotopes.</span>

<span class="sd">    Args:</span>
<span class="sd">        strings (): Can either be a string with isotope ratios seperated by a ``,`` or a sequence of strings.</span>
<span class="sd">        without_suffix (): If ``True`` the suffix part of each isotope string is ignored.</span>
<span class="sd">        allow_invalid ():  If ``False``, and a string cannot be parsed into an isotope string, an exception is</span>
<span class="sd">            raised. If ``True`` then ``string.strip()`` is returned instead.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">strings</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">strings</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">strings</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)]</span>

    <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">asratio</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="n">without_suffix</span><span class="o">=</span><span class="n">without_suffix</span><span class="p">,</span> <span class="n">allow_invalid</span><span class="o">=</span><span class="n">allow_invalid</span><span class="p">)</span> <span class="k">for</span> <span class="n">string</span> <span class="ow">in</span> <span class="n">strings</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="simple.create_legend" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">create_legend</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">create_legend</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">outside</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">outside_margin</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Add a legend to a plot.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code>ax</code></b>
          –
          <div class="doc-md-description">
            <p>The working axes. Accepted values are any matplotlib Axes object or plt instance.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>outside</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>If <code>True</code> the legend will be drawn just outside the upper left corner of the plot. This will
overwrite any <code>loc</code> and <code>bbox_to_anchor</code> arguments in <code>kwargs</code>.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>outside_margin</code></b>
          –
          <div class="doc-md-description">
            <p>Margin between the plot and the legend. Relative to the width of the plot.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>**kwargs</code></b>
          –
          <div class="doc-md-description">
            <p>Any valid argument for matplotlibs
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.legend.html"><code>legend</code></a> function.</p>
          </div>
        </li>
    </ul>

            <details class="quote">
              <summary>Source code in <code>simple/plotting.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@utils</span><span class="o">.</span><span class="n">set_default_kwargs</span><span class="p">()</span>
<span class="k">def</span><span class="w"> </span><span class="nf">create_legend</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">outside</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">outside_margin</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Add a legend to a plot.</span>

<span class="sd">    Args:</span>
<span class="sd">        ax (): The working axes. Accepted values are any matplotlib Axes object or plt instance.</span>
<span class="sd">        outside (bool): If ``True`` the legend will be drawn just outside the upper left corner of the plot. This will</span>
<span class="sd">            overwrite any ``loc`` and ``bbox_to_anchor`` arguments in ``kwargs``.</span>
<span class="sd">        outside_margin (): Margin between the plot and the legend. Relative to the width of the plot.</span>
<span class="sd">        **kwargs (): Any valid argument for matplotlibs</span>
<span class="sd">            [``legend``](https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.legend.html) function.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">get_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">outside</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;loc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;upper left&#39;</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;bbox_to_anchor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">outside_margin</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">kwargs</span><span class="o">.</span><span class="n">pop_many</span><span class="p">(</span><span class="n">create_legend</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="simple.create_rose_plot" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">create_rose_plot</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">create_rose_plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">xscale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">yscale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">segment</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rres</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Create a plot with a <a class="autorefs autorefs-internal" href="../roseaxes/#simple.roseaxes.RoseAxes">rose projection</a>.</p>
<p>The rose ax is a subclass of matplotlibs
<a href="https://matplotlib.org/stable/api/projections/polar.html#matplotlib.projections.polar.PolarAxes">polar axes</a>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code>ax</code></b>
          –
          <div class="doc-md-description">
            <p>A matplotlib axes object, or an object with a <code>gca()</code> method (e.g. <code>plt</code>). If the
axes does not have a rose projection, it will be destroyed and replaced by a new [RoseAxes][(]simple.roseaxes.RoseAxes].</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>xscale</code></b>
          –
          <div class="doc-md-description">
            <p>The scale of the x axis.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>yscale</code></b>
          –
          <div class="doc-md-description">
            <p>The scale of the y axis.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>segment</code></b>
          –
          <div class="doc-md-description">
            <p>Which segment of the rose diagram to show. Options are <code>N</code>, <code>E</code>, <code>S</code>, <code>W</code>,
<code>NE</code>, <code>SE</code>, <code>SW</code>, <code>NW</code> and <code>None</code>. If <code>None</code> the entire circle is shown.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>rres</code></b>
          –
          <div class="doc-md-description">
            <p>The resolution of lines drawn along the radius <code>r</code>. The number of points in a line is calculated as</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>RoseAxes</code></b>          –
          <div class="doc-md-description">
            <p>The new rose ax.</p>
          </div>
        </li>
    </ul>

            <details class="quote">
              <summary>Source code in <code>simple/plotting.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@set_default_kwargs</span><span class="p">(</span><span class="n">layout</span><span class="o">=</span><span class="s1">&#39;constrained&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">create_rose_plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">xscale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">yscale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                     <span class="n">segment</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rres</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a plot with a [rose projection][simple.roseaxes.RoseAxes].</span>

<span class="sd">    The rose ax is a subclass of matplotlibs</span>
<span class="sd">    [polar axes](https://matplotlib.org/stable/api/projections/polar.html#matplotlib.projections.polar.PolarAxes).</span>

<span class="sd">    Args:</span>
<span class="sd">        ax (): A matplotlib axes object, or an object with a ``gca()`` method (e.g. ``plt``). If the</span>
<span class="sd">            axes does not have a rose projection, it will be destroyed and replaced by a new [RoseAxes][(]simple.roseaxes.RoseAxes].</span>
<span class="sd">        xscale (): The scale of the x axis.</span>
<span class="sd">        yscale (): The scale of the y axis.</span>
<span class="sd">        segment (): Which segment of the rose diagram to show. Options are ``N``, ``E``, ``S``, ``W``,</span>
<span class="sd">            ``NE``, ``SE``, ``SW``, ``NW`` and ``None``. If ``None`` the entire circle is shown.</span>
<span class="sd">        rres (): The resolution of lines drawn along the radius ``r``. The number of points in a line is calculated as</span>
<span class="sd">        ``r*rres+1`` (Min. 2).</span>

<span class="sd">    Returns:</span>
<span class="sd">        RoseAxes : The new rose ax.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="s1">&#39;rose&#39;</span><span class="p">},</span> <span class="n">layout</span><span class="o">=</span><span class="s1">&#39;constrained&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">get_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ax</span><span class="o">.</span><span class="n">name</span> <span class="o">!=</span> <span class="s1">&#39;rose&#39;</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Wrong Axes projection for rose plot. Deleting axes and creating a new one.&#39;</span><span class="p">)</span>
            <span class="n">subplot_dict</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="s1">&#39;_SIMPLE_subplot_dict&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">subplot_dict_key</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="s1">&#39;_SIMPLE_subplot_dict_key&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_figure</span><span class="p">()</span>
            <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">stop</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_subplotspec</span><span class="p">()</span><span class="o">.</span><span class="n">get_geometry</span><span class="p">()</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">start</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;rose&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">subplot_dict</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">subplot_dict</span><span class="p">[</span><span class="n">subplot_dict_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ax</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">_SIMPLE_subplot_dict</span> <span class="o">=</span> <span class="n">subplot_dict</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">_SIMPLE_subplot_dict_key</span> <span class="o">=</span> <span class="n">subplot_dict_key</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_xyscale</span><span class="p">(</span><span class="n">xscale</span><span class="p">,</span> <span class="n">yscale</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">segment</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xysegment</span><span class="p">(</span><span class="n">segment</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">rres</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_rres</span><span class="p">(</span><span class="n">rres</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">ax</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="simple.create_subplots" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">create_subplots</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">create_subplots</span><span class="p">(</span><span class="n">mosaic</span><span class="p">,</span> <span class="n">update_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Create a series of subplots.</p>
<p>See <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplot_mosaic.html#matplotlib.pyplot.subplot_mosaic">matplotlib's documentation</a>
for a more thorough description of the <em>mosaic</em> argument and other possible arguments.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code>mosaic</code></b>
          –
          <div class="doc-md-description">
            <p>A visual layout of how you want your subplots to be arranged. This can either
be a nested list of strings or a single string with each subplot represented by a single character, where
<code>;</code> represent a new row.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>update_fig</code></b>
          –
          <div class="doc-md-description">
            <p>If <code>True</code> (default), the figure will be updated using any <em>kwargs</em> prefixed with <code>fig_</code>.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>kwargs</code></b>
          –
          <div class="doc-md-description">
            <p>Keyword arguments to go with the <code>mosaic</code> argument. Kwargs prefixed with <code>fig_</code> will be used with
[<code>update_figure</code>][simple.plot.update_figure] to update the figure.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>dict</code></b>          –
          <div class="doc-md-description">
            <p>A dictionary containing the subplots.</p>
          </div>
        </li>
    </ul>

            <details class="quote">
              <summary>Source code in <code>simple/plotting.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@add_shortcut</span><span class="p">(</span><span class="s1">&#39;AB&#39;</span><span class="p">,</span> <span class="n">mosaic</span><span class="o">=</span><span class="s1">&#39;AB&#39;</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">))</span>
<span class="nd">@add_shortcut</span><span class="p">(</span><span class="s1">&#39;AB_CD&#39;</span><span class="p">,</span> <span class="n">mosaic</span><span class="o">=</span><span class="s1">&#39;AB;CD&#39;</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">11</span><span class="p">))</span>
<span class="nd">@set_default_kwargs</span><span class="p">(</span><span class="n">layout</span><span class="o">=</span><span class="s1">&#39;constrained&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">create_subplots</span><span class="p">(</span><span class="n">mosaic</span><span class="p">,</span> <span class="n">update_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a series of subplots.</span>

<span class="sd">    See [matplotlib&#39;s documentation](https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplot_mosaic.html#matplotlib.pyplot.subplot_mosaic)</span>
<span class="sd">    for a more thorough description of the *mosaic* argument and other possible arguments.</span>

<span class="sd">    Args:</span>
<span class="sd">        mosaic (): A visual layout of how you want your subplots to be arranged. This can either</span>
<span class="sd">            be a nested list of strings or a single string with each subplot represented by a single character, where</span>
<span class="sd">            `;` represent a new row.</span>
<span class="sd">        update_fig (): If ``True`` (default), the figure will be updated using any *kwargs* prefixed with ``fig_``.</span>
<span class="sd">        kwargs (): Keyword arguments to go with the ``mosaic`` argument. Kwargs prefixed with ``fig_`` will be used with</span>
<span class="sd">            [`update_figure`][simple.plot.update_figure] to update the figure.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: A dictionary containing the subplots.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fig_kwargs</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop_many</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;fig&#39;</span><span class="p">,</span> <span class="n">remove_prefix</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">subplots</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot_mosaic</span><span class="p">(</span><span class="n">mosaic</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="n">update_figure</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">fig_kwargs</span><span class="p">,</span> <span class="n">update_fig</span><span class="o">=</span><span class="n">update_fig</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">sp</span> <span class="ow">in</span> <span class="n">subplots</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">sp</span><span class="o">.</span><span class="n">_SIMPLE_subplot_dict</span> <span class="o">=</span> <span class="n">subplots</span>
        <span class="n">sp</span><span class="o">.</span><span class="n">_SIMPLE_subplot_dict_name</span> <span class="o">=</span> <span class="n">key</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">_SIMPLE_subplots</span> <span class="o">=</span> <span class="n">subplots</span>
    <span class="k">return</span> <span class="n">subplots</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="simple.get_data" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">get_data</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_data</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">axis_names</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">latex_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_attrname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_value</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">key_in_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">numer_in_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">denom_in_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">model_in_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">unit_in_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">attrname_in_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">axis_name_in_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">prefix_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">suffix_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mask_na</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Get one or more datasets from a group of models together with suitable labels.</p>
<p>Each data point is a dictionary that contains a value for each of the axis given in <em>axis_names</em> plus a label
describing the data point. The value for each axis is determined by the <em>key</em> argument. This argument has two
possible components; the name of the attribute and the index, or key, to be applied this, or the
<em>default_attrname</em>, attribute.</p>
<p>The name of the attribute must start with a <code>.</code> followed by the path to the attribute relative to the Model
object using successive <code>.</code> for nested attributes, e.g. <code>.intnorm.eRi</code>.</p>
<p>The index, or key, part of the <em>key</em> can either be an integer, a slice or a sequence of keys seperated by <code>,</code>.
The keys will be parsed into either <a class="autorefs autorefs-internal" href="../utils/#simple.utils.Isotope">Isotope</a>, <a class="autorefs autorefs-internal" href="../utils/#simple.utils.Ratio">Ratio</a>, or
<a class="autorefs autorefs-internal" href="../utils/#simple.utils.Element">Element</a> strings. If a key is given it is assumed that the attribute contains an isotope
key array. Therefore, Element strings will be replaced with all the isotopes of that element
present in the attribute (Across all models) and Ratio strings will return the numerator value divided by the
denominator value.</p>
<p>If the attribute name is given in <em>key</em> then the index, or key, part must be enclosed in square brackets, e.g.
<code>.intnorm.eRi[105Pd]</code>. If the <em>default_attrname</em> should be used then <em>key</em> should only contain the index, or key.</p>
<p>By the default the label for each data point only contains the information is not shared with all other data points.
Information that is shared between all data points is instead included in the axis labels.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code>models</code></b>
          –
          <div class="doc-md-description">
            <p>A collection of models to plot. A subselection of these models can be made using the <em>where</em>
argument.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>axis_names</code></b>
          –
          <div class="doc-md-description">
            
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>where</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>If given will be used to create a subselection of <em>models</em>. Any <em>kwargs</em> prefixed
with <code>where_</code> will be supplied as keyword arguments. See
 [<code>ModelCollection.where</code>][(]simple.models.ModelCollection.where] for more details.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>latex_labels</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to use the latex formatting in the labels, when available.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>key</code></b>
              (<code>(<span title="str">str</span>, <span title="int">int</span>, <span title="slice">slice</span>)</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>This can either be a valid index to the <em>default_attrname</em> array or the path, with
or without a valid index, of a different attribute. Accepts either single universal value
or a list of values, one for each axis (See below for details).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>default_attrname</code></b>
          –
          <div class="doc-md-description">
            <p>The name of the default attribute to use if <em>xkey</em> and <em>ykey</em> are indexes. By default,
the default key array is used. Accepts either single universal value or a list of values, one for each
axis (See below for details).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>unit</code></b>
          –
          <div class="doc-md-description">
            <p>The desired unit for the <em>xkey</em> and <em>ykey</em>. Different units for <em>xkey</em> and <em>ykey</em> can be specified
by supplying a <code>(&lt;xkey_unit&gt;, &lt;ykey_unit&gt;)</code> sequence. Accepts either single universal value
or a list of values, one for each axis (See below for details).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>default_value</code></b>
          –
          <div class="doc-md-description">
            <p>The value given to invalid indexes of arrays. Must have a shape compatible with the size
of the indexed array. Accepts either single universal value
or a list of values, one for each axis (See below for details).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>key_in_label</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to include the key index in the label. Accepts either single universal value
or a list of values, one for each axis (See below for details).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>numer_in_label</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to include the numerator of a key index in the label. Accepts either single
universal value or a list of values, one for each axis (See below for details).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>denom_in_label</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to include the denominator of a key index in the label. Accepts either single
universal value or a list of values, one for each axis (See below for details).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>model_in_label</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to include the model name in the label. Accepts either single universal value
or a list of values, one for each axis (See below for details).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>unit_in_label</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to include the unit in the label. Accepts either single universal value
or a list of values, one for each axis (See below for details).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>attrname_in_label</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to include the attribute name in the label. By default
the name is only included if it is different from the <em>default_attrname</em>. Accepts a single universal
value or a list of values, one for each axis (See below for details).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>axis_name_in_label</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to include the axis name in the label. Accepts either single universal value
or a value for each axis (See below for details).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>label</code></b>
              (<code>(<span title="str">str</span>, <span title="bool">bool</span>, None)</code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>The label for individual datapoints. Accepts either a single universal value or
a list of values, one per data point (See below for details).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>prefix_label</code></b>
          –
          <div class="doc-md-description">
            <p>Text to be added to the beginning of each data point label. Accepts either a single universal
value or a list of values, one per data point (See below for details).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>suffix_label</code></b>
          –
          <div class="doc-md-description">
            <p>Text to be added at the end of each data point label. Accepts either a single universal
value or a list of values, one per data point (See below for details).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>mask</code></b>
              (<code>(<span title="str">str</span>, <span title="int">int</span>, <span title="slice">slice</span>)</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Can be used to apply a mask to the data which is plotted. See the
<code>get_mask</code> function of the Model object. Accepts either a single universal
value or a list of values, one per model (See below for details).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>mask_na</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>If <code>True</code> masked values will be replaced by <code>np.nan</code> values. Only works if all arrays
in a dataset have a float based datatype. Accepts either a single universal
value or a list of values, one per model (See below for details).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>**kwargs</code></b>
          –
          <div class="doc-md-description">
            
          </div>
        </li>
    </ul>


<details class="one-per-axis-arguments" open>
  <summary>One per axis arguments</summary>
  <p>These arguments allow you to set a different value for each axis in <em>axis_names</em>. This can be
either a single value used for all the axis or a sequence of values, one per axis.</p>
<p>It is also possible to define the value for a specific axis by  including a keyword argument consiting
of the axis name followed directly by the argument name. The value specified this way will take presidence over
the value given by the argument itself. For example <code>xkey=102Pd</code> will set the <em>key</em> argument for
the <em>x</em> axis to <code>102Pd</code>.</p>
</details>

<details class="one-per-data-point-arguments" open>
  <summary>One per data point arguments</summary>
  <p>These arguments allow you to set a different value for each data point. The number of data points is
equal to the number of models multiplied by the number of datasets generated. This can be
either a single value used for all the axis or a sequence of values, one per data point.</p>
</details>

<details class="one-per-model-arguments" open>
  <summary>One per model arguments</summary>
  <p>These arguments allow you to set a different value for each model in <em>models</em>. This can be
either a single value used for all the axis or a sequence of values, one per model.</p>
</details>

<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          –
          <div class="doc-md-description">
            <p>Tuple[dict, dict]: Two dictionaries containing:</p>
<ul>
<li>
<p>A dictionary with the data points for each model, mapped to the model name</p>
</li>
<li>
<p>A dictionary containing labels for each axis, mapped to the axis name.</p>
</li>
</ul>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Here is an example of how the return data can be used.</p>
<pre><code>model_datapoints, axis_labels = simple.get_data(models, 'x, y', xkey=..., ykey=...)

# Set the axis labels
plt.set_xlabel(axis_labels['x'])
plt.set_ylabel(axis_labels['y'])

# Iterate though the data and plot it
for model_name, datapoints in model_datapoints.items():
    for dp in datapoints:
        plt.plot(dp['x'], dp['y'], label=dp['label'])
</code></pre>

            <details class="quote">
              <summary>Source code in <code>simple/plotting.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@utils</span><span class="o">.</span><span class="n">set_default_kwargs</span><span class="p">()</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_data</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">axis_names</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">latex_labels</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
             <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_attrname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span>
             <span class="n">key_in_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">numer_in_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">denom_in_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">model_in_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">unit_in_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">attrname_in_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">axis_name_in_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">label</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">prefix_label</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">suffix_label</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">mask</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">mask_na</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
             <span class="n">kwargs</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get one or more datasets from a group of models together with suitable labels.</span>

<span class="sd">    Each data point is a dictionary that contains a value for each of the axis given in *axis_names* plus a label</span>
<span class="sd">    describing the data point. The value for each axis is determined by the *key* argument. This argument has two</span>
<span class="sd">    possible components; the name of the attribute and the index, or key, to be applied this, or the</span>
<span class="sd">    *default_attrname*, attribute.</span>

<span class="sd">    The name of the attribute must start with a ``.`` followed by the path to the attribute relative to the Model</span>
<span class="sd">    object using successive ``.`` for nested attributes, e.g. ``.intnorm.eRi``.</span>

<span class="sd">    The index, or key, part of the *key* can either be an integer, a slice or a sequence of keys seperated by ``,``.</span>
<span class="sd">    The keys will be parsed into either [Isotope][simple.utils.Isotope], [Ratio][simple.utils.Ratio], or</span>
<span class="sd">    [Element][simple.utils.Element] strings. If a key is given it is assumed that the attribute contains an isotope</span>
<span class="sd">    key array. Therefore, Element strings will be replaced with all the isotopes of that element</span>
<span class="sd">    present in the attribute (Across all models) and Ratio strings will return the numerator value divided by the</span>
<span class="sd">    denominator value.</span>

<span class="sd">    If the attribute name is given in *key* then the index, or key, part must be enclosed in square brackets, e.g.</span>
<span class="sd">    ``.intnorm.eRi[105Pd]``. If the *default_attrname* should be used then *key* should only contain the index, or key.</span>

<span class="sd">    By the default the label for each data point only contains the information is not shared with all other data points.</span>
<span class="sd">    Information that is shared between all data points is instead included in the axis labels.</span>

<span class="sd">    Args:</span>
<span class="sd">        models (): A collection of models to plot. A subselection of these models can be made using the *where*</span>
<span class="sd">            argument.</span>
<span class="sd">        axis_names ():</span>
<span class="sd">        where (str): If given will be used to create a subselection of *models*. Any *kwargs* prefixed</span>
<span class="sd">            with ``where_`` will be supplied as keyword arguments. See</span>
<span class="sd">             [``ModelCollection.where``][(]simple.models.ModelCollection.where] for more details.</span>
<span class="sd">        latex_labels (bool): Whether to use the latex formatting in the labels, when available.</span>
<span class="sd">        key (str, int, slice): This can either be a valid index to the *default_attrname* array or the path, with</span>
<span class="sd">            or without a valid index, of a different attribute. Accepts either single universal value</span>
<span class="sd">            or a list of values, one for each axis (See below for details).</span>
<span class="sd">        default_attrname (): The name of the default attribute to use if *xkey* and *ykey* are indexes. By default,</span>
<span class="sd">            the default key array is used. Accepts either single universal value or a list of values, one for each</span>
<span class="sd">            axis (See below for details).</span>
<span class="sd">        unit (): The desired unit for the *xkey* and *ykey*. Different units for *xkey* and *ykey* can be specified</span>
<span class="sd">            by supplying a ``(&lt;xkey_unit&gt;, &lt;ykey_unit&gt;)`` sequence. Accepts either single universal value</span>
<span class="sd">            or a list of values, one for each axis (See below for details).</span>
<span class="sd">        default_value (): The value given to invalid indexes of arrays. Must have a shape compatible with the size</span>
<span class="sd">            of the indexed array. Accepts either single universal value</span>
<span class="sd">            or a list of values, one for each axis (See below for details).</span>
<span class="sd">        key_in_label (bool): Whether to include the key index in the label. Accepts either single universal value</span>
<span class="sd">            or a list of values, one for each axis (See below for details).</span>
<span class="sd">        numer_in_label (bool): Whether to include the numerator of a key index in the label. Accepts either single</span>
<span class="sd">            universal value or a list of values, one for each axis (See below for details).</span>
<span class="sd">        denom_in_label (bool): Whether to include the denominator of a key index in the label. Accepts either single</span>
<span class="sd">            universal value or a list of values, one for each axis (See below for details).</span>
<span class="sd">        model_in_label (bool): Whether to include the model name in the label. Accepts either single universal value</span>
<span class="sd">            or a list of values, one for each axis (See below for details).</span>
<span class="sd">        unit_in_label (bool): Whether to include the unit in the label. Accepts either single universal value</span>
<span class="sd">            or a list of values, one for each axis (See below for details).</span>
<span class="sd">        attrname_in_label (bool): Whether to include the attribute name in the label. By default</span>
<span class="sd">            the name is only included if it is different from the *default_attrname*. Accepts a single universal</span>
<span class="sd">            value or a list of values, one for each axis (See below for details).</span>
<span class="sd">        axis_name_in_label (bool): Whether to include the axis name in the label. Accepts either single universal value</span>
<span class="sd">            or a value for each axis (See below for details).</span>
<span class="sd">        label (str, bool, None): The label for individual datapoints. Accepts either a single universal value or</span>
<span class="sd">            a list of values, one per data point (See below for details).</span>
<span class="sd">        prefix_label (): Text to be added to the beginning of each data point label. Accepts either a single universal</span>
<span class="sd">            value or a list of values, one per data point (See below for details).</span>
<span class="sd">        suffix_label (): Text to be added at the end of each data point label. Accepts either a single universal</span>
<span class="sd">            value or a list of values, one per data point (See below for details).</span>
<span class="sd">        mask (str, int, slice): Can be used to apply a mask to the data which is plotted. See the</span>
<span class="sd">            ``get_mask`` function of the Model object. Accepts either a single universal</span>
<span class="sd">            value or a list of values, one per model (See below for details).</span>
<span class="sd">        mask_na (bool): If ``True`` masked values will be replaced by ``np.nan`` values. Only works if all arrays</span>
<span class="sd">            in a dataset have a float based datatype. Accepts either a single universal</span>
<span class="sd">            value or a list of values, one per model (See below for details).</span>
<span class="sd">        **kwargs:</span>

<span class="sd">    One per axis arguments:</span>
<span class="sd">        These arguments allow you to set a different value for each axis in *axis_names*. This can be</span>
<span class="sd">        either a single value used for all the axis or a sequence of values, one per axis.</span>

<span class="sd">        It is also possible to define the value for a specific axis by  including a keyword argument consiting</span>
<span class="sd">        of the axis name followed directly by the argument name. The value specified this way will take presidence over</span>
<span class="sd">        the value given by the argument itself. For example ``xkey=102Pd`` will set the *key* argument for</span>
<span class="sd">        the *x* axis to ``102Pd``.</span>


<span class="sd">    One per data point arguments:</span>
<span class="sd">        These arguments allow you to set a different value for each data point. The number of data points is</span>
<span class="sd">        equal to the number of models multiplied by the number of datasets generated. This can be</span>
<span class="sd">        either a single value used for all the axis or a sequence of values, one per data point.</span>


<span class="sd">    One per model arguments:</span>
<span class="sd">        These arguments allow you to set a different value for each model in *models*. This can be</span>
<span class="sd">        either a single value used for all the axis or a sequence of values, one per model.</span>


<span class="sd">    Returns:</span>
<span class="sd">        Tuple[dict, dict]: Two dictionaries containing:</span>

<span class="sd">            - A dictionary with the data points for each model, mapped to the model name</span>

<span class="sd">            - A dictionary containing labels for each axis, mapped to the axis name.</span>

<span class="sd">    Examples:</span>
<span class="sd">        Here is an example of how the return data can be used.</span>
<span class="sd">        ```</span>
<span class="sd">        model_datapoints, axis_labels = simple.get_data(models, &#39;x, y&#39;, xkey=..., ykey=...)</span>

<span class="sd">        # Set the axis labels</span>
<span class="sd">        plt.set_xlabel(axis_labels[&#39;x&#39;])</span>
<span class="sd">        plt.set_ylabel(axis_labels[&#39;y&#39;])</span>

<span class="sd">        # Iterate though the data and plot it</span>
<span class="sd">        for model_name, datapoints in model_datapoints.items():</span>
<span class="sd">            for dp in datapoints:</span>
<span class="sd">                plt.plot(dp[&#39;x&#39;], dp[&#39;y&#39;], label=dp[&#39;label&#39;])</span>
<span class="sd">        ```</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">where_kwargs</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop_many</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;where&#39;</span><span class="p">)</span>
    <span class="n">models</span> <span class="o">=</span> <span class="n">get_models</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">where</span><span class="p">,</span> <span class="n">where_kwargs</span><span class="o">=</span><span class="n">where_kwargs</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">axis_names</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="n">axis_name_args</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">axis_names</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">axis_key_args</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">axis_names</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
    <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">axis_names</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;,&#39;</span> <span class="ow">in</span> <span class="n">axis_names</span><span class="p">:</span>
            <span class="n">axis_name_args</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">axis_names</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">axis_name_args</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">axis_names</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
        <span class="n">axis_key_args</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;``axis_name`` must be a string or a dict&#39;</span><span class="p">)</span>

    <span class="n">lenargs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">axis_name_args</span><span class="p">)</span>
    <span class="n">lenmodels</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">models</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">one_per_n</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n_name</span><span class="p">,</span> <span class="n">arg_name</span><span class="p">,</span> <span class="n">arg_value</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg_value</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg_value</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">arg_value</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">arg_value</span><span class="p">)</span> <span class="o">==</span> <span class="n">n</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">arg_value</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">arg_value</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">arg_value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Length of ``</span><span class="si">{</span><span class="n">arg_name</span><span class="si">}</span><span class="s1">`` (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">arg_value</span><span class="p">)</span><span class="si">}</span><span class="s1">) must be equal to number of </span><span class="si">{</span><span class="n">n_name</span><span class="si">}</span><span class="s1"> (</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">one_per_arg</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="n">args</span> <span class="o">=</span> <span class="n">one_per_n</span><span class="p">(</span><span class="n">lenargs</span><span class="p">,</span> <span class="s1">&#39;axis&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">axis</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axis_name_args</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">k</span><span class="o">:=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">axis</span><span class="si">}{</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="n">args</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">k</span><span class="o">:=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">axis</span><span class="si">}{</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="n">args</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">args</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">parse_key_string</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">data_arrays</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">utils</span><span class="o">.</span><span class="n">asisotopes</span><span class="p">(</span><span class="n">key</span><span class="p">),</span> <span class="s1">&#39;iso&#39;</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">utils</span><span class="o">.</span><span class="n">asratios</span><span class="p">(</span><span class="n">key</span><span class="p">),</span> <span class="s1">&#39;rat&#39;</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">elements</span> <span class="o">=</span>  <span class="n">utils</span><span class="o">.</span><span class="n">aselements</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Unable to parse &quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s1">&quot; into a sequence of valid Element, Isotope or Ratio string.&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Because the key list should be the same for all models we need to go through them all here</span>
            <span class="c1"># incase some have more or less isotopes in the specified data array</span>
            <span class="n">all_isotopes</span> <span class="o">=</span> <span class="p">()</span>
            <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">:</span>
                <span class="n">element_isotopes</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">data_arrays</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">))</span> <span class="ow">or</span> <span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">fields</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Data array &quot;</span><span class="si">{</span><span class="n">attrname</span><span class="si">}</span><span class="s1">&quot; of model </span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1"> is not a key array. &#39;</span>
                                         <span class="sa">f</span><span class="s1">&#39;Cannot extract isotope keys.&#39;</span><span class="p">)</span>

                    <span class="k">for</span> <span class="n">iso</span> <span class="ow">in</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_isotopes_of_element</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">fields</span><span class="p">,</span> <span class="n">element</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">iso</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">element_isotopes</span><span class="p">:</span>
                            <span class="n">element_isotopes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iso</span><span class="p">)</span>
                <span class="n">all_isotopes</span> <span class="o">+=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">element_isotopes</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">iso</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">iso</span><span class="o">.</span><span class="n">mass</span><span class="p">)))</span>
            <span class="k">return</span> <span class="n">all_isotopes</span><span class="p">,</span> <span class="s1">&#39;iso&#39;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_data_label</span><span class="p">(</span><span class="n">keylabels</span><span class="p">,</span> <span class="n">keys</span><span class="p">,</span> <span class="n">key_in_label</span><span class="p">,</span> <span class="n">numer_in_label</span><span class="p">,</span> <span class="n">denom_in_label</span><span class="p">):</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="ow">is</span> <span class="n">utils</span><span class="o">.</span><span class="n">Isotope</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">key_in_label</span><span class="p">:</span>
                    <span class="n">label</span> <span class="o">=</span> <span class="n">keylabels</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;!</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="k">elif</span> <span class="n">key_in_label</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">numer_in_label</span> <span class="ow">and</span> <span class="n">denom_in_label</span><span class="p">:</span>
                    <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">keylabels</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="o">.</span><span class="n">numer</span><span class="p">,</span><span class="w"> </span><span class="sa">f</span><span class="s2">&quot;!</span><span class="si">{</span><span class="n">key</span><span class="o">.</span><span class="n">numer</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">keylabels</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="o">.</span><span class="n">denom</span><span class="p">,</span><span class="w"> </span><span class="sa">f</span><span class="s2">&quot;!</span><span class="si">{</span><span class="n">key</span><span class="o">.</span><span class="n">denom</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1"> &#39;</span>
                <span class="k">elif</span> <span class="n">numer_in_label</span><span class="p">:</span>
                    <span class="n">label</span> <span class="o">=</span> <span class="n">keylabels</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="o">.</span><span class="n">numer</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;!</span><span class="si">{</span><span class="n">key</span><span class="o">.</span><span class="n">numer</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">denom_in_label</span><span class="p">:</span>
                    <span class="n">label</span> <span class="o">=</span> <span class="n">keylabels</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="o">.</span><span class="n">denom</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;!</span><span class="si">{</span><span class="n">key</span><span class="o">.</span><span class="n">denom</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">labels</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_data_index</span><span class="p">(</span><span class="n">data_array</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">mi</span><span class="p">,</span> <span class="n">ai</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">data_array</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">models</span><span class="p">[</span><span class="n">mi</span><span class="p">]</span><span class="si">}</span><span class="s1">.</span><span class="si">{</span><span class="n">attrname_a</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span><span class="si">}</span><span class="s1">: Missing field &quot;</span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s1">&quot; replaced by the default value (</span><span class="si">{</span><span class="n">default_value</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data_array</span><span class="p">),</span> <span class="n">default_value_args</span><span class="p">[</span><span class="n">ai</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">error</span>

    <span class="k">if</span> <span class="n">axis_key_args</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">axis_key_args</span> <span class="o">=</span> <span class="n">one_per_arg</span><span class="p">(</span><span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>

    <span class="n">default_attrname_args</span> <span class="o">=</span> <span class="n">one_per_arg</span><span class="p">(</span><span class="s1">&#39;default_attrname&#39;</span><span class="p">,</span> <span class="n">default_attrname</span><span class="p">)</span>
    <span class="n">desired_unit_args</span> <span class="o">=</span> <span class="n">one_per_arg</span><span class="p">(</span><span class="s1">&#39;unit&#39;</span><span class="p">,</span> <span class="n">unit</span><span class="p">)</span>
    <span class="n">default_value_args</span> <span class="o">=</span> <span class="n">one_per_arg</span><span class="p">(</span><span class="s1">&#39;default_value&#39;</span><span class="p">,</span> <span class="n">default_value</span><span class="p">)</span>
    <span class="n">key_in_label_args</span> <span class="o">=</span> <span class="n">one_per_arg</span><span class="p">(</span><span class="s1">&#39;key_in_label&#39;</span><span class="p">,</span> <span class="n">key_in_label</span><span class="p">)</span>
    <span class="n">numer_in_label_args</span> <span class="o">=</span> <span class="n">one_per_arg</span><span class="p">(</span><span class="s1">&#39;numer_in_label&#39;</span><span class="p">,</span> <span class="n">numer_in_label</span><span class="p">)</span>
    <span class="n">denom_in_label_args</span> <span class="o">=</span> <span class="n">one_per_arg</span><span class="p">(</span><span class="s1">&#39;denom_in_label&#39;</span><span class="p">,</span> <span class="n">denom_in_label</span><span class="p">)</span>
    <span class="n">model_in_label_args</span> <span class="o">=</span> <span class="n">one_per_arg</span><span class="p">(</span><span class="s1">&#39;model_in_label&#39;</span><span class="p">,</span> <span class="n">model_in_label</span><span class="p">)</span>
    <span class="n">unit_in_label_args</span> <span class="o">=</span> <span class="n">one_per_arg</span><span class="p">(</span><span class="s1">&#39;unit_in_label&#39;</span><span class="p">,</span> <span class="n">unit_in_label</span><span class="p">)</span>
    <span class="n">attrname_in_label_args</span> <span class="o">=</span> <span class="n">one_per_arg</span><span class="p">(</span><span class="s1">&#39;attrname_in_label&#39;</span><span class="p">,</span> <span class="n">attrname_in_label</span><span class="p">)</span>
    <span class="n">axis_name_in_label_args</span> <span class="o">=</span> <span class="n">one_per_arg</span><span class="p">(</span><span class="s1">&#39;axis_name_in_label&#39;</span><span class="p">,</span> <span class="n">axis_name_in_label</span><span class="p">)</span>

    <span class="n">mask_args</span> <span class="o">=</span> <span class="n">one_per_n</span><span class="p">(</span><span class="n">lenmodels</span><span class="p">,</span> <span class="s1">&#39;models&#39;</span><span class="p">,</span> <span class="s1">&#39;mask&#39;</span><span class="p">,</span> <span class="n">mask</span><span class="p">)</span>
    <span class="n">mask_na_args</span> <span class="o">=</span> <span class="n">one_per_n</span><span class="p">(</span><span class="n">lenmodels</span><span class="p">,</span> <span class="s1">&#39;models&#39;</span><span class="p">,</span> <span class="s1">&#39;mask_na&#39;</span><span class="p">,</span> <span class="n">mask_na</span><span class="p">)</span>

    <span class="c1"># _a -   [arg1, arg2, ...]</span>
    <span class="c1"># _am -  [(arg1_model1, arg1_model2, ...), (arg2_model1, arg2_model2, ...)]</span>
    <span class="c1"># _amk - [({arg1_model1_key1, arg1_model1_key2, ...}, {arg1_model2_key1, arg1_model2_key2, ...}), ...]</span>
    <span class="n">attrname_a</span><span class="p">,</span> <span class="n">keys_ak</span><span class="p">,</span> <span class="n">keytype_a</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">data_arrays_am</span><span class="p">,</span> <span class="n">data_units_am</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">data_label_am</span><span class="p">,</span> <span class="n">data_keylabels_am</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">ai</span><span class="p">,</span> <span class="n">arg</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axis_key_args</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">str</span><span class="p">:</span>
            <span class="n">attrname</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">parse_attrname</span><span class="p">(</span><span class="n">default_attrname_args</span><span class="p">[</span><span class="n">ai</span><span class="p">])</span>
            <span class="n">key</span> <span class="o">=</span> <span class="n">arg</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">arg</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">):</span>
                <span class="n">m</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^([A-Za-z0-9_.]+)(?:\[(.*?)\])?$&#39;</span><span class="p">,</span> <span class="n">arg</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">m</span><span class="p">:</span>
                    <span class="n">attrname</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">parse_attrname</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
                    <span class="n">key</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">attrname_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">attrname_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Invalid arg: </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">attrname</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">parse_attrname</span><span class="p">(</span><span class="n">default_attrname_args</span><span class="p">[</span><span class="n">ai</span><span class="p">])</span>
                <span class="n">key</span> <span class="o">=</span> <span class="n">arg</span>

        <span class="k">if</span> <span class="n">attrname_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">attrname</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">attrname_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="n">attrname_a</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">attrname</span><span class="p">)</span>

        <span class="c1"># Here we get all the data arrays</span>
        <span class="c1"># For this we only need the attrname</span>
        <span class="n">data_arrays_am</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
        <span class="n">data_units_am</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
        <span class="n">data_label_am</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
        <span class="n">data_keylabels_am</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
        <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span><span class="p">:</span>
            <span class="n">data</span><span class="p">,</span> <span class="n">data_unit</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_array</span><span class="p">(</span><span class="n">attrname</span><span class="p">,</span> <span class="n">desired_unit_args</span><span class="p">[</span><span class="n">ai</span><span class="p">])</span>
            <span class="n">data_arrays_am</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">data_units_am</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data_unit</span><span class="p">)</span>

            <span class="n">attr_label</span><span class="p">,</span> <span class="n">key_labels</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_array_labels</span><span class="p">(</span><span class="n">attrname</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="n">latex_labels</span><span class="p">)</span>
            <span class="n">data_label_am</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">attr_label</span><span class="p">)</span>
            <span class="n">data_keylabels_am</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key_labels</span><span class="p">)</span>


        <span class="c1"># Parse the key</span>
        <span class="c1"># Is the key is an element symbol it will extract all isotopes of that element from the data</span>
        <span class="c1"># Hence why we need to get the data arrays before this step</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
            <span class="c1"># Check if key is an integer index or slice</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^\s*(-?\d+)\s*$|^\s*(-?\d*)\s*:\s*(-?\d*)\s*(?::\s*(-?\d*))?\s*$&#39;</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">m</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span>
                    <span class="n">key</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>  <span class="c1"># Slice</span>
                    <span class="n">key</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                                <span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                                <span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span> <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
                <span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">key</span><span class="p">,)</span>
                <span class="n">keytype</span> <span class="o">=</span> <span class="s1">&#39;index&#39;</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">key</span><span class="p">,</span> <span class="n">keytype</span> <span class="o">=</span> <span class="n">parse_key_string</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">data_arrays_am</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">int</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">slice</span><span class="p">:</span>
            <span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">key</span><span class="p">,)</span>
            <span class="n">keytype</span> <span class="o">=</span> <span class="s1">&#39;index&#39;</span>
        <span class="k">elif</span> <span class="n">key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="p">)</span>
            <span class="n">keytype</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">key</span><span class="p">,</span> <span class="n">keytype</span> <span class="o">=</span> <span class="n">parse_key_string</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">data_arrays_am</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

        <span class="n">keys_ak</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="n">keytype_a</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">keytype</span><span class="p">)</span>

    <span class="c1"># Make sure the size of the keys is the same for all args</span>
    <span class="n">size</span> <span class="o">=</span> <span class="p">{</span><span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">keys_ak</span><span class="p">}</span>
    <span class="n">size</span><span class="o">.</span><span class="n">discard</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">size</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Length of indexes for not compatible </span><span class="si">{</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">attrname_a</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">size</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">lenkeys</span> <span class="o">=</span> <span class="n">size</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">lenkeys</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">for</span> <span class="n">ai</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">lenargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">keys_ak</span><span class="p">[</span><span class="n">ai</span><span class="p">])</span> <span class="o">!=</span> <span class="n">lenkeys</span><span class="p">:</span>
            <span class="c1"># current size can only be 1. Repeat until it is the correct length</span>
            <span class="n">keys_ak</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">keys_ak</span><span class="p">[</span><span class="n">ai</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">lenkeys</span><span class="p">)]</span>

    <span class="n">axis_label_args</span> <span class="o">=</span> <span class="p">[</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">label&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">axis_name_args</span><span class="p">]</span>
    <span class="n">axis_prefix_label_args</span> <span class="o">=</span> <span class="p">[</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">prefix_label&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">axis_name_args</span><span class="p">]</span>
    <span class="n">axis_suffix_label_args</span> <span class="o">=</span> <span class="p">[</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">suffix_label&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">axis_name_args</span><span class="p">]</span>
    <span class="n">label_args</span> <span class="o">=</span> <span class="n">one_per_n</span><span class="p">(</span><span class="n">lenmodels</span> <span class="o">*</span> <span class="n">lenkeys</span><span class="p">,</span> <span class="s1">&#39;datapoints&#39;</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>
    <span class="n">prefix_label_args</span> <span class="o">=</span> <span class="n">one_per_n</span><span class="p">(</span><span class="n">lenmodels</span> <span class="o">*</span> <span class="n">lenkeys</span><span class="p">,</span> <span class="s1">&#39;datapoints&#39;</span><span class="p">,</span> <span class="s1">&#39;prefix_label&#39;</span><span class="p">,</span> <span class="n">prefix_label</span><span class="p">)</span>
    <span class="n">suffix_label_args</span> <span class="o">=</span> <span class="n">one_per_n</span><span class="p">(</span><span class="n">lenmodels</span> <span class="o">*</span> <span class="n">lenkeys</span><span class="p">,</span> <span class="s1">&#39;datapoints&#39;</span><span class="p">,</span> <span class="s1">&#39;suffix_label&#39;</span><span class="p">,</span> <span class="n">suffix_label</span><span class="p">)</span>

    <span class="n">result_data</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">result_axis_label</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">data_labels_amk</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Get the arg label which can be used as an axis label</span>
    <span class="c1"># Get the data point label for each arg. These are all combined later</span>
    <span class="c1"># Model name is not added. It will be added once the individual arg labels have been joined</span>
    <span class="k">for</span> <span class="n">ai</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">lenargs</span><span class="p">):</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="n">keys_ak</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span>
        <span class="n">keytype</span> <span class="o">=</span> <span class="n">keytype_a</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span>

        <span class="c1"># Find common keys that can go into the arg label</span>
        <span class="k">if</span> <span class="n">keytype</span> <span class="o">==</span> <span class="s1">&#39;iso&#39;</span><span class="p">:</span>
            <span class="n">unique_keylabels</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">mi</span><span class="p">,</span> <span class="n">keylabels</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data_keylabels_am</span><span class="p">[</span><span class="n">ai</span><span class="p">]):</span>
                <span class="k">if</span> <span class="n">keylabels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data array &#39;</span><span class="si">{</span><span class="n">attrname_a</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39; of model &#39;</span><span class="si">{</span><span class="n">models</span><span class="p">[</span><span class="n">mi</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; is not a key array.&quot;</span><span class="p">)</span>
                <span class="n">unique_keylabels</span> <span class="o">=</span> <span class="p">{</span><span class="o">*</span><span class="n">unique_keylabels</span><span class="p">,</span> <span class="o">*</span><span class="p">(</span><span class="n">keylabels</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">)}</span>

            <span class="n">unique_keylabels</span><span class="o">.</span><span class="n">discard</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_keylabels</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="c1"># Same label for all data points</span>
                <span class="n">arg_label</span> <span class="o">=</span> <span class="n">unique_keylabels</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">key_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">key_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">if</span> <span class="n">axis_name_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">axis_name_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">arg_label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&lt;</span><span class="si">{</span><span class="n">axis_name_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span><span class="si">}</span><span class="s2">&gt;&quot;</span>
                <span class="k">if</span> <span class="n">key_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">key_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">if</span> <span class="n">axis_name_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">axis_name_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">elif</span> <span class="n">keytype</span> <span class="o">==</span> <span class="s1">&#39;rat&#39;</span><span class="p">:</span>
            <span class="n">unique_n_keylabels</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">unique_d_keylabels</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">keylabels</span> <span class="ow">in</span> <span class="n">data_keylabels_am</span><span class="p">[</span><span class="n">ai</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">keylabels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data array &#39;</span><span class="si">{</span><span class="n">attrname</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39; of model &#39;</span><span class="si">{</span><span class="n">models</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; is not a key array.&quot;</span><span class="p">)</span>

                <span class="n">unique_n_keylabels</span> <span class="o">=</span> <span class="p">{</span><span class="o">*</span><span class="n">unique_n_keylabels</span><span class="p">,</span> <span class="o">*</span><span class="p">(</span><span class="n">keylabels</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">k</span><span class="o">.</span><span class="n">numer</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">)}</span>
                <span class="n">unique_d_keylabels</span> <span class="o">=</span> <span class="p">{</span><span class="o">*</span><span class="n">unique_d_keylabels</span><span class="p">,</span> <span class="o">*</span><span class="p">(</span><span class="n">keylabels</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">k</span><span class="o">.</span><span class="n">denom</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">)}</span>

            <span class="n">unique_n_keylabels</span><span class="o">.</span><span class="n">discard</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="n">unique_d_keylabels</span><span class="o">.</span><span class="n">discard</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">key_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">numer_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">numer_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="o">=</span> <span class="n">key_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">denom_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">denom_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="o">=</span> <span class="n">key_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_n_keylabels</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_d_keylabels</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">arg_label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">unique_n_keylabels</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span><span class="si">}</span><span class="s2"> / </span><span class="si">{</span><span class="n">unique_d_keylabels</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="k">if</span> <span class="n">key_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">key_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">if</span> <span class="n">numer_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">numer_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">if</span> <span class="n">denom_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">denom_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">if</span> <span class="n">axis_name_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">axis_name_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_n_keylabels</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">arg_label</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">unique_n_keylabels</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span><span class="si">}</span><span class="s1"> / &lt;</span><span class="si">{</span><span class="n">axis_name_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span><span class="si">}</span><span class="s1">&gt;&#39;</span>
                <span class="k">if</span> <span class="n">key_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">key_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">if</span> <span class="n">numer_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">numer_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">if</span> <span class="n">denom_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">denom_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">if</span> <span class="n">axis_name_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">axis_name_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_d_keylabels</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">arg_label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&lt;</span><span class="si">{</span><span class="n">axis_name_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span><span class="si">}</span><span class="s2">&gt; / </span><span class="si">{</span><span class="n">unique_d_keylabels</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="k">if</span> <span class="n">key_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">key_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">if</span> <span class="n">numer_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">numer_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">if</span> <span class="n">denom_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">denom_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">if</span> <span class="n">axis_name_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">axis_name_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">arg_label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&lt;</span><span class="si">{</span><span class="n">axis_name_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span><span class="si">}</span><span class="s2">&gt;&quot;</span>
                <span class="k">if</span> <span class="n">key_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">key_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">if</span> <span class="n">numer_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">numer_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">if</span> <span class="n">denom_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">denom_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">if</span> <span class="n">axis_name_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">axis_name_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">arg_label</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

            <span class="c1"># Neither are possible so just set to False</span>
            <span class="n">key_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">axis_name_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># Create labels for each key</span>
        <span class="n">data_labels_amk</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
        <span class="k">if</span> <span class="n">keytype</span> <span class="o">==</span> <span class="s1">&#39;iso&#39;</span> <span class="ow">or</span> <span class="n">keytype</span> <span class="o">==</span> <span class="s1">&#39;rat&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">keylabels</span> <span class="ow">in</span> <span class="n">data_keylabels_am</span><span class="p">[</span><span class="n">ai</span><span class="p">]:</span>
                <span class="n">data_labels_amk</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_data_label</span><span class="p">(</span><span class="n">keylabels</span><span class="p">,</span> <span class="n">keys</span><span class="p">,</span>
                                                          <span class="n">key_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">],</span> <span class="n">numer_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">],</span> <span class="n">denom_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]))</span>
                <span class="k">if</span> <span class="n">attrname_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">attrname_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># No keys so just creates an empty label</span>
            <span class="n">data_labels_amk</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">([[</span><span class="s1">&#39;&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">lenkeys</span><span class="p">)]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">lenmodels</span><span class="p">)])</span>
            <span class="k">if</span> <span class="n">attrname_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">attrname_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="c1"># Add the unit either to arg label if common across all models or to each key label</span>
        <span class="c1"># [unit] added to the end of the string</span>
        <span class="k">if</span> <span class="n">unit_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">unique_data_units</span> <span class="o">=</span> <span class="p">{</span><span class="o">*</span><span class="n">data_units_am</span><span class="p">[</span><span class="n">ai</span><span class="p">]}</span>
            <span class="n">unique_data_units</span><span class="o">.</span><span class="n">discard</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_data_units</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">arg_label</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">arg_label</span><span class="si">}</span><span class="s1"> [</span><span class="si">{</span><span class="n">unique_data_units</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span><span class="si">}</span><span class="s1">]&#39;</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_data_units</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">mi</span><span class="p">,</span> <span class="n">arg_data_labels_k</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data_labels_amk</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
                    <span class="k">for</span> <span class="n">ki</span><span class="p">,</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">arg_data_labels_k</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">data_units_am</span><span class="p">[</span><span class="n">ai</span><span class="p">][</span><span class="n">mi</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="n">data_labels_amk</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">mi</span><span class="p">][</span><span class="n">ki</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s1"> [</span><span class="si">{</span><span class="n">data_units_am</span><span class="p">[</span><span class="n">ai</span><span class="p">][</span><span class="n">mi</span><span class="p">]</span><span class="si">}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

        <span class="c1"># Add the attrname either to arg label if common across all models or to each key label</span>
        <span class="c1"># arrname added to the start of the string</span>
        <span class="k">if</span> <span class="n">attrname_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]:</span>
            <span class="n">unique_data_label</span> <span class="o">=</span> <span class="p">{</span><span class="o">*</span><span class="n">data_label_am</span><span class="p">[</span><span class="n">ai</span><span class="p">]}</span>
            <span class="n">unique_data_label</span><span class="o">.</span><span class="n">discard</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_data_label</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">arg_label</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                    <span class="n">arg_label</span> <span class="o">=</span> <span class="n">unique_data_label</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">arg_label</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">unique_data_label</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span><span class="si">}</span><span class="s1"> | </span><span class="si">{</span><span class="n">arg_label</span><span class="si">}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_data_label</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">mi</span><span class="p">,</span> <span class="n">arg_data_labels_k</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data_labels_amk</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
                    <span class="k">for</span> <span class="n">ki</span><span class="p">,</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">arg_data_labels_k</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">data_label_am</span><span class="p">[</span><span class="n">ai</span><span class="p">][</span><span class="n">mi</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                                <span class="n">data_labels_amk</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">mi</span><span class="p">][</span><span class="n">ki</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_label_am</span><span class="p">[</span><span class="n">ai</span><span class="p">][</span><span class="n">mi</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">data_labels_amk</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">mi</span><span class="p">][</span><span class="n">ki</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">data_label_am</span><span class="p">[</span><span class="n">ai</span><span class="p">][</span><span class="n">mi</span><span class="p">]</span><span class="si">}</span><span class="s1"> | </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

        <span class="n">axis_label_arg</span> <span class="o">=</span> <span class="n">axis_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">axis_label_arg</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">prefix</span> <span class="o">=</span> <span class="n">axis_prefix_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span>
            <span class="n">suffix</span> <span class="o">=</span> <span class="n">axis_suffix_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">prefix</span><span class="p">:</span>
                <span class="n">arg_label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}{</span><span class="n">arg_label</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">if</span> <span class="n">suffix</span><span class="p">:</span>
                <span class="n">arg_label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">arg_label</span><span class="si">}{</span><span class="n">suffix</span><span class="si">}</span><span class="s2">&quot;</span>

            <span class="n">result_axis_label</span><span class="p">[</span><span class="n">axis_name_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]]</span> <span class="o">=</span> <span class="n">arg_label</span> <span class="ow">or</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result_axis_label</span><span class="p">[</span><span class="n">axis_name_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]]</span> <span class="o">=</span> <span class="n">axis_label_arg</span> <span class="ow">or</span> <span class="kc">None</span>

    <span class="n">has_labels</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">for</span> <span class="n">mi</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">lenmodels</span><span class="p">):</span>
        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ki</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">lenkeys</span><span class="p">):</span>
            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">({})</span>

            <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="k">for</span> <span class="n">ai</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">lenargs</span><span class="p">):</span>
                <span class="n">data_array</span> <span class="o">=</span> <span class="n">data_arrays_am</span><span class="p">[</span><span class="n">ai</span><span class="p">][</span><span class="n">mi</span><span class="p">]</span>
                <span class="n">keytype</span> <span class="o">=</span> <span class="n">keytype_a</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span>

                <span class="k">if</span> <span class="n">keytype</span> <span class="o">==</span> <span class="s1">&#39;rat&#39;</span><span class="p">:</span>
                    <span class="n">key</span> <span class="o">=</span> <span class="n">keys_ak</span><span class="p">[</span><span class="n">ai</span><span class="p">][</span><span class="n">ki</span><span class="p">]</span>
                    <span class="n">n</span> <span class="o">=</span> <span class="n">get_data_index</span><span class="p">(</span><span class="n">data_array</span><span class="p">,</span> <span class="n">key</span><span class="o">.</span><span class="n">numer</span><span class="p">,</span> <span class="n">mi</span><span class="p">,</span> <span class="n">ai</span><span class="p">)</span>
                    <span class="n">d</span> <span class="o">=</span> <span class="n">get_data_index</span><span class="p">(</span><span class="n">data_array</span><span class="p">,</span> <span class="n">key</span><span class="o">.</span><span class="n">denom</span><span class="p">,</span> <span class="n">mi</span><span class="p">,</span> <span class="n">ai</span><span class="p">)</span>
                    <span class="n">data</span> <span class="o">=</span> <span class="n">n</span><span class="o">/</span><span class="n">d</span>

                <span class="k">elif</span> <span class="n">keytype</span> <span class="o">==</span> <span class="s1">&#39;iso&#39;</span> <span class="ow">or</span> <span class="n">keytype</span> <span class="o">==</span> <span class="s1">&#39;index&#39;</span><span class="p">:</span>
                    <span class="n">key</span> <span class="o">=</span> <span class="n">keys_ak</span><span class="p">[</span><span class="n">ai</span><span class="p">][</span><span class="n">ki</span><span class="p">]</span>
                    <span class="n">data</span> <span class="o">=</span> <span class="n">get_data_index</span><span class="p">(</span><span class="n">data_array</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">mi</span><span class="p">,</span> <span class="n">ai</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span> <span class="c1"># keytype == &#39;none&#39;</span>
                    <span class="n">data</span> <span class="o">=</span> <span class="n">data_array</span>

                <span class="n">results</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">axis_name_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]]</span> <span class="o">=</span> <span class="n">data</span>

                <span class="n">data_label</span> <span class="o">=</span> <span class="n">data_labels_amk</span><span class="p">[</span><span class="n">ai</span><span class="p">][</span><span class="n">mi</span><span class="p">][</span><span class="n">ki</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">data_label</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">axis_name_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]:</span>
                        <span class="n">label</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;&lt;</span><span class="si">{</span><span class="n">axis_name_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">data_label</span><span class="si">}</span><span class="s2">&gt;&quot;</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">label</span> <span class="o">+=</span> <span class="n">data_label</span>

            <span class="k">if</span> <span class="n">mask_args</span><span class="p">[</span><span class="n">mi</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">imask</span> <span class="o">=</span> <span class="n">models</span><span class="p">[</span><span class="n">mi</span><span class="p">]</span><span class="o">.</span><span class="n">get_mask</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="o">**</span><span class="n">results</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">mask_na_args</span><span class="p">[</span><span class="n">mi</span><span class="p">]</span> <span class="ow">and</span> <span class="kc">False</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">results</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
                    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">results</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                        <span class="n">v</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                        <span class="n">v</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">logical_not</span><span class="p">(</span><span class="n">imask</span><span class="p">)]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
                        <span class="n">results</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">results</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                        <span class="n">results</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">imask</span><span class="p">]</span>

            <span class="n">label_arg</span> <span class="o">=</span> <span class="n">label_args</span><span class="p">[(</span><span class="n">mi</span> <span class="o">*</span> <span class="n">lenkeys</span><span class="p">)</span> <span class="o">+</span> <span class="n">ki</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">label_arg</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">prefix</span> <span class="o">=</span> <span class="n">prefix_label_args</span><span class="p">[</span><span class="n">mi</span> <span class="o">*</span> <span class="n">lenkeys</span> <span class="o">+</span> <span class="n">ki</span><span class="p">]</span>
                <span class="n">suffix</span> <span class="o">=</span> <span class="n">suffix_label_args</span><span class="p">[</span><span class="n">mi</span> <span class="o">*</span> <span class="n">lenkeys</span> <span class="o">+</span> <span class="n">ki</span><span class="p">]</span>

                <span class="k">if</span> <span class="n">model_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="ow">or</span> <span class="p">(</span><span class="n">model_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">lenmodels</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">label</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                        <span class="n">label</span> <span class="o">=</span> <span class="n">models</span><span class="p">[</span><span class="n">mi</span><span class="p">]</span><span class="o">.</span><span class="n">name</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s1"> (</span><span class="si">{</span><span class="n">models</span><span class="p">[</span><span class="n">mi</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
                    <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}{</span><span class="n">label</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">suffix</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
                    <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">label</span><span class="si">}{</span><span class="n">suffix</span><span class="si">}</span><span class="s2">&quot;</span>

                <span class="n">results</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">label</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="ow">or</span> <span class="kc">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">results</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">label_arg</span> <span class="ow">or</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="n">results</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;label&#39;</span><span class="p">]:</span>
                <span class="n">has_labels</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="n">result_data</span><span class="p">[</span><span class="n">models</span><span class="p">[</span><span class="n">mi</span><span class="p">]]</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">has_labels</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;legend&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;legend&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">return</span> <span class="n">result_data</span><span class="p">,</span> <span class="n">result_axis_label</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="simple.get_isotopes_of_element" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">get_isotopes_of_element</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_isotopes_of_element</span><span class="p">(</span><span class="n">isotopes</span><span class="p">,</span> <span class="n">element</span><span class="p">,</span> <span class="n">isotopes_without_suffix</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Returns a tuple of all isotopes in a sequence that contain the given element symbol.</p>
<p><strong>Note</strong> The strings in <code>isotopes</code> will be passed through <a class="autorefs autorefs-internal" href="#simple.asisotopes">asisotopes</a> before
the evaluation and therefore do not have to be correcly formatted. Invalid isotope string are allowed
but will be ignored by the evaluation.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code>isotopes</code></b>
          –
          <div class="doc-md-description">
            <p>An iterable of strings representing isotopes.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>element</code></b>
              (<code><span title="str">str</span></code>)
          –
          <div class="doc-md-description">
            <p>The element symbol.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>isotopes_without_suffix</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>If <code>True</code> suffixes will be removed from the isotopes in <code>isotopes</code>
before the evaluation takes place.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">simple</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">get_isotopes_of_element</span><span class="p">([</span><span class="s2">&quot;Ru-101&quot;</span><span class="p">,</span> <span class="s2">&quot;Pd-102&quot;</span><span class="p">,</span> <span class="s2">&quot;Rh-103&quot;</span><span class="p">,</span> <span class="s2">&quot;Pd-104&quot;</span><span class="p">],</span> <span class="s2">&quot;Pd&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="s2">&quot;Pd-102&quot;</span><span class="p">,</span> <span class="s2">&quot;Pd-104&quot;</span><span class="p">)</span>
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>simple/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_isotopes_of_element</span><span class="p">(</span><span class="n">isotopes</span><span class="p">,</span> <span class="n">element</span><span class="p">,</span> <span class="n">isotopes_without_suffix</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a tuple of all isotopes in a sequence that contain the given element symbol.</span>

<span class="sd">    **Note** The strings in ``isotopes`` will be passed through [asisotopes][simple.asisotopes] before</span>
<span class="sd">    the evaluation and therefore do not have to be correcly formatted. Invalid isotope string are allowed</span>
<span class="sd">    but will be ignored by the evaluation.</span>

<span class="sd">    Args:</span>
<span class="sd">        isotopes (): An iterable of strings representing isotopes.</span>
<span class="sd">        element (str): The element symbol.</span>
<span class="sd">        isotopes_without_suffix (bool): If ``True`` suffixes will be removed from the isotopes in ``isotopes``</span>
<span class="sd">            before the evaluation takes place.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; simple.utils.get_isotopes_of_element([&quot;Ru-101&quot;, &quot;Pd-102&quot;, &quot;Rh-103&quot;, &quot;Pd-104&quot;], &quot;Pd&quot;)</span>
<span class="sd">        &gt;&gt;&gt; (&quot;Pd-102&quot;, &quot;Pd-104&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">isotopes</span> <span class="o">=</span> <span class="n">asisolist</span><span class="p">(</span><span class="n">isotopes</span><span class="p">,</span> <span class="n">without_suffix</span><span class="o">=</span><span class="n">isotopes_without_suffix</span><span class="p">,</span> <span class="n">allow_invalid</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">element</span> <span class="o">=</span> <span class="n">aselement</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">iso</span> <span class="k">for</span> <span class="n">iso</span> <span class="ow">in</span> <span class="n">isotopes</span> <span class="k">if</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">iso</span><span class="p">)</span> <span class="ow">is</span> <span class="n">Isotope</span> <span class="ow">and</span> <span class="n">iso</span><span class="o">.</span><span class="n">element</span> <span class="o">==</span> <span class="n">element</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="simple.hist" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">hist</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">hist</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">xkey</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ykey</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">sum_weights</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">norm_weights</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rescale</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">default_attrname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">weights_default_attrname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">weights_unit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">weights_default_value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mask_na</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">update_ax</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">update_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Make a traditional histogram of <em>xkey</em> or <em>ykey</em>, or a circular histogram for the slope of <em>ykey</em>/<em>xkey</em>
on <em>axis</em>, for each model in <em>models</em>.</p>
<p>This function retrieves data using <a class="autorefs autorefs-internal" href="#simple.get_data"><code>get_data</code></a> and plots it using matplotlib
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.plot.html"><code>plot</code></a> for 1d histograms and
SIMPLE's <a class="autorefs autorefs-internal" href="../roseaxes/#simple.roseaxes.RoseAxes.mhist"><code>RoseAxes.mhist</code></a> for 2d histograms. It supports
optional filtering, masking, and per-model or per-dataset styling. Additional arguments can be passed using
keyword prefixes to control axes, figure appearance, legends, and more.</p>
<p>This function is split into two stages: <a class="autorefs autorefs-internal" href="../plotting/#simple.plotting.hist_get_data"><code>hist_get_data</code></a> and
[<code>hist_draw</code>][simple.plotting.hist_draw], which can be used independently.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code>models</code></b>
              (<code><span title="ModelCollection">ModelCollection</span></code>)
          –
          <div class="doc-md-description">
            <p>A collection of models to plot. A subset can be selected using the <em>where</em> argument.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>xkey, ykey</code></b>
              (<code>str, int, or slice</code>)
          –
          <div class="doc-md-description">
            <p>Keys or indices used to retrieve the x and y data arrays. These may refer to
array indices (relative to <em>default_attrname</em>) or full attribute paths. See <a class="autorefs autorefs-internal" href="#simple.get_data"><code>get_data</code></a>
for more information. If only <em>xkey</em> or <em>ykey</em> is specified then a traditional histogram is drawn. If
both are specified, then a circular histogram of the slopes is drawn.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>weights</code></b>
              (<code><span title="float">float</span> or <span title="str">str</span></code>, default:
                  <code>1</code>
)
          –
          <div class="doc-md-description">
            <p>Weighting factor for the histogram. See <a class="autorefs autorefs-internal" href="#simple.add_weights"><code>add_weights</code></a> for
details.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>r</code></b>
              (<code><span title="float">float</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Radius of the circular histogram. If None, the radius is automatically determined. A sequence of
values can be passed, one for each dataset.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>sum_weights</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to sum the weights if multiple weight datasets are present. See
<a class="autorefs autorefs-internal" href="#simple.add_weights"><code>add_weights</code></a> for details.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>norm_weights</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to normalise the weights to sum to 1. See <a class="autorefs autorefs-internal" href="#simple.add_weights"><code>add_weights</code></a>
for details.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>default_attrname</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Name of the default attribute used when <em>xkey</em> or <em>ykey</em> is an index.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>unit</code></b>
              (<code><span title="str">str</span> or <span title="tuple">tuple</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Desired unit(s) for the x and y axes. Use a tuple <code>(xunit, yunit)</code> for different units.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>where</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Filter expression to select a subset of <em>models</em>. See
<a class="autorefs autorefs-internal" href="../models/#simple.models.ModelCollection.where"><code>ModelCollection.where</code></a>.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>mask</code></b>
              (<code>str, int, or slice</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Optional mask to apply to the data. See the <code>get_mask</code> method on model instances.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>mask_na</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>If True, masked values are replaced with <code>np.nan</code>. Only applies if <em>xkey</em> and <em>ykey</em> are
float-based.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>ax</code></b>
              (<code><span title="matplotlib.axes.Axes">Axes</span> or None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>The axes to plot on. If None, defaults to <code>plt.gca()</code>.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>legend</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to add a legend. If <code>None</code>, a legend is shown if at least one datapoint has a label.
Legend made using <a class="autorefs autorefs-internal" href="../plotting/#simple.plotting.create_legend"><code>create_legend</code></a>.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>update_ax, update_fig</code></b>
              (<code><span title="bool">bool</span></code>)
          –
          <div class="doc-md-description">
            <p>Whether to apply <code>ax_&lt;keyword&gt;</code> and <code>fig_&lt;keyword&gt;</code> arguments using
<a class="autorefs autorefs-internal" href="../plotting/#simple.plotting.update_axes"><code>update_axes</code></a>.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>kwargs</code></b>
              (<code><span title="dict">dict</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Keyword arguments can be provided either explicitly via <code>kwargs</code> or implicitly via
<code>**kwargs</code>. If the same keyword is provided in both, the value in kwargs takes precedence. A description of
accepted keywords is provided below.</p>
          </div>
        </li>
    </ul>


<details class="accepted-keyword-arguments" open>
  <summary>Accepted keyword arguments</summary>
  <p>Direct keywords:
    - Any keyword accepted by <a class="autorefs autorefs-internal" href="#simple.get_data"><code>simple.get_data()</code></a>.
    - <code>color</code>: Can be a list of colours, <code>True</code> for defaults, or <code>False</code> to use black.
    - <code>linestyle</code>: Can be a list of styles, <code>True</code> for defaults, or <code>False</code> to disable lines.
    - <code>color_by_model</code>, <code>linestyle_by_model</code>: If <code>True</code> every dataset for each model will be
      plotted with the same colour/linestyle value. If <code>False</code>, the corresponding datasets for each model
      will be plotted with the same value. If <code>None</code> the default behaviour is used.</p>
<p>Prefixed keywords:
    - <code>plt_&lt;keyword&gt;</code>: Keywords passed to the primary plotting function, <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.axline.html"><code>axline</code></a>.
    - <code>where_&lt;keyword&gt;</code>: Keywords passed to the model filtering function, <a class="autorefs autorefs-internal" href="../models/#simple.models.ModelCollection.where"><code>ModelCollection.where</code></a>.
    - <code>weights_&lt;keyword&gt;</code>: Keywords passed to <a class="autorefs autorefs-internal" href="#simple.add_weights"><code>add_weights</code></a>.
    - <code>ax_&lt;keyword&gt;</code>: Keywords passed to <a class="autorefs autorefs-internal" href="../plotting/#simple.plotting.update_axes"><code>update_axes</code></a>.
    - <code>fig_&lt;keyword&gt;</code>: Keywords passed to [<code>update_fig</code>][simple.plotting.update_fig].
    - <code>legend_&lt;keyword&gt;</code>: Keywords passed to <a class="autorefs autorefs-internal" href="../plotting/#simple.plotting.create_legend"><code>create_legend</code></a>.
    - <code>histogram_&lt;keyword&gt;</code>: Keywords for numpys
        <a href="https://numpy.org/doc/stable/reference/generated/numpy.histogram.html"><code>histogram</code></a> function. Only
        used for 1-d histograms.
    - <code>rose_&lt;keyword&gt;</code>: Keywords passed to [<code>create_rose_plot</code>][simple.roseaxes.create_rose_plot]. Only used
        for 2-d histograms (and only if the figure is not already a <code>RoseAxes</code> instance).</p>
</details>

<details class="axis-and-data-labels" open>
  <summary>Axis and data labels</summary>
  <p>Axis labels are automatically inferred based on shared and unique elements in the data. You can override them
using <code>ax_xlabel</code> and <code>ax_ylabel</code> in <em>kwargs</em>. Datapoint labels can be overridden with a list of labels
(one per line in the legend).</p>
</details>

<details class="shortcuts-and-default-values" open>
  <summary>Shortcuts and default values</summary>
  <p>This function includes shortcut variants with predefined default values:</p>
<ul>
<li><code>plot.intnorm</code>: sets <code>default_attrname="intnorm.eRi"</code> and <code>unit=None</code></li>
<li><code>plot.stdnorm</code>: sets <code>default_attrname="stdnorm.Ri"</code> and <code>unit=None</code></li>
<li><code>plot.abundance</code>: sets <code>default_attrname="abundance"</code> and <code>unit=None</code></li>
</ul>
<p>Default argument values can also be updated through <code>plot.update_kwargs()</code>. Values defined in the function
signature are used only if not overridden there. You can retrieve the default arguments using <code>plot.kwargs</code></p>
</details>

<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          –
          <div class="doc-md-description">
            <p>matplotlib.axes.Axes: The axes object used for plotting.</p>
          </div>
        </li>
    </ul>

            <details class="quote">
              <summary>Source code in <code>simple/plotting.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@utils</span><span class="o">.</span><span class="n">add_shortcut</span><span class="p">(</span><span class="s1">&#39;abundance&#39;</span><span class="p">,</span> <span class="n">default_attrname</span> <span class="o">=</span><span class="s1">&#39;abundance&#39;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="nd">@utils</span><span class="o">.</span><span class="n">add_shortcut</span><span class="p">(</span><span class="s1">&#39;stdnorm&#39;</span><span class="p">,</span> <span class="n">default_attrname</span> <span class="o">=</span><span class="s1">&#39;stdnorm.Ri&#39;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="nd">@utils</span><span class="o">.</span><span class="n">add_shortcut</span><span class="p">(</span><span class="s1">&#39;intnorm&#39;</span><span class="p">,</span> <span class="n">default_attrname</span><span class="o">=</span><span class="s1">&#39;intnorm.eRi&#39;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="nd">@utils</span><span class="o">.</span><span class="n">set_default_kwargs</span><span class="p">(</span>
    <span class="n">linestyle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">linestyle_by_model</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">color_by_model</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">ax_kw_xlabel_fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
    <span class="n">ax_kw_ylabel_fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
    <span class="n">legend_outside</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">ax_tick_params</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="n">fig_size</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mf">6.5</span><span class="p">),</span>
    <span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">hist</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">xkey</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ykey</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
         <span class="n">sum_weights</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">norm_weights</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
         <span class="n">bins</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rescale</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
         <span class="n">default_attrname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
         <span class="n">weights_default_attrname</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">weights_unit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">weights_default_value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
         <span class="n">where</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mask_na</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
         <span class="n">legend</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">update_ax</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">update_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
         <span class="n">kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Make a traditional histogram of *xkey* or *ykey*, or a circular histogram for the slope of *ykey*/*xkey*</span>
<span class="sd">    on *axis*, for each model in *models*.</span>

<span class="sd">    This function retrieves data using [`get_data`][simple.get_data] and plots it using matplotlib</span>
<span class="sd">    [`plot`](https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.plot.html) for 1d histograms and</span>
<span class="sd">    SIMPLE&#39;s [`RoseAxes.mhist`][simple.roseaxes.RoseAxes.mhist] for 2d histograms. It supports</span>
<span class="sd">    optional filtering, masking, and per-model or per-dataset styling. Additional arguments can be passed using</span>
<span class="sd">    keyword prefixes to control axes, figure appearance, legends, and more.</span>

<span class="sd">    This function is split into two stages: [`hist_get_data`][simple.plotting.hist_get_data] and</span>
<span class="sd">    [`hist_draw`][simple.plotting.hist_draw], which can be used independently.</span>

<span class="sd">    Args:</span>
<span class="sd">        models (ModelCollection): A collection of models to plot. A subset can be selected using the *where* argument.</span>
<span class="sd">        xkey, ykey (str, int, or slice): Keys or indices used to retrieve the x and y data arrays. These may refer to</span>
<span class="sd">            array indices (relative to *default_attrname*) or full attribute paths. See [`get_data`][simple.get_data]</span>
<span class="sd">            for more information. If only *xkey* or *ykey* is specified then a traditional histogram is drawn. If</span>
<span class="sd">            both are specified, then a circular histogram of the slopes is drawn.</span>
<span class="sd">        weights (float or str): Weighting factor for the histogram. See [`add_weights`][simple.add_weights] for</span>
<span class="sd">            details.</span>
<span class="sd">        r (float): Radius of the circular histogram. If None, the radius is automatically determined. A sequence of</span>
<span class="sd">            values can be passed, one for each dataset.</span>
<span class="sd">        sum_weights (bool): Whether to sum the weights if multiple weight datasets are present. See</span>
<span class="sd">            [`add_weights`][simple.add_weights] for details.</span>
<span class="sd">        norm_weights (bool): Whether to normalise the weights to sum to 1. See [`add_weights`][simple.add_weights]</span>
<span class="sd">            for details.</span>
<span class="sd">        default_attrname (str): Name of the default attribute used when *xkey* or *ykey* is an index.</span>
<span class="sd">        unit (str or tuple): Desired unit(s) for the x and y axes. Use a tuple `(xunit, yunit)` for different units.</span>
<span class="sd">        where (str): Filter expression to select a subset of *models*. See</span>
<span class="sd">            [`ModelCollection.where`][simple.models.ModelCollection.where].</span>
<span class="sd">        mask (str, int, or slice): Optional mask to apply to the data. See the `get_mask` method on model instances.</span>
<span class="sd">        mask_na (bool): If True, masked values are replaced with `np.nan`. Only applies if *xkey* and *ykey* are</span>
<span class="sd">            float-based.</span>
<span class="sd">        ax (matplotlib.axes.Axes or None): The axes to plot on. If None, defaults to `plt.gca()`.</span>
<span class="sd">        legend (bool): Whether to add a legend. If `None`, a legend is shown if at least one datapoint has a label.</span>
<span class="sd">            Legend made using [`create_legend`][simple.plotting.create_legend].</span>
<span class="sd">        update_ax, update_fig (bool): Whether to apply `ax_&lt;keyword&gt;` and `fig_&lt;keyword&gt;` arguments using</span>
<span class="sd">            [`update_axes`][simple.plotting.update_axes].</span>
<span class="sd">        kwargs (dict, optional): Keyword arguments can be provided either explicitly via `kwargs` or implicitly via</span>
<span class="sd">            `**kwargs`. If the same keyword is provided in both, the value in kwargs takes precedence. A description of</span>
<span class="sd">            accepted keywords is provided below.</span>

<span class="sd">    Accepted keyword arguments:</span>
<span class="sd">        Direct keywords:</span>
<span class="sd">            - Any keyword accepted by [`simple.get_data()`][simple.get_data].</span>
<span class="sd">            - `color`: Can be a list of colours, `True` for defaults, or `False` to use black.</span>
<span class="sd">            - `linestyle`: Can be a list of styles, `True` for defaults, or `False` to disable lines.</span>
<span class="sd">            - `color_by_model`, `linestyle_by_model`: If `True` every dataset for each model will be</span>
<span class="sd">              plotted with the same colour/linestyle value. If `False`, the corresponding datasets for each model</span>
<span class="sd">              will be plotted with the same value. If `None` the default behaviour is used.</span>


<span class="sd">        Prefixed keywords:</span>
<span class="sd">            - `plt_&lt;keyword&gt;`: Keywords passed to the primary plotting function, [`axline`](https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.axline.html).</span>
<span class="sd">            - `where_&lt;keyword&gt;`: Keywords passed to the model filtering function, [`ModelCollection.where`][simple.models.ModelCollection.where].</span>
<span class="sd">            - `weights_&lt;keyword&gt;`: Keywords passed to [`add_weights`][simple.add_weights].</span>
<span class="sd">            - `ax_&lt;keyword&gt;`: Keywords passed to [`update_axes`][simple.plotting.update_axes].</span>
<span class="sd">            - `fig_&lt;keyword&gt;`: Keywords passed to [`update_fig`][simple.plotting.update_fig].</span>
<span class="sd">            - `legend_&lt;keyword&gt;`: Keywords passed to [`create_legend`][simple.plotting.create_legend].</span>
<span class="sd">            - `histogram_&lt;keyword&gt;`: Keywords for numpys</span>
<span class="sd">                [`histogram`](https://numpy.org/doc/stable/reference/generated/numpy.histogram.html) function. Only</span>
<span class="sd">                used for 1-d histograms.</span>
<span class="sd">            - `rose_&lt;keyword&gt;`: Keywords passed to [`create_rose_plot`][simple.roseaxes.create_rose_plot]. Only used</span>
<span class="sd">                for 2-d histograms (and only if the figure is not already a `RoseAxes` instance).</span>


<span class="sd">    Axis and data labels:</span>
<span class="sd">        Axis labels are automatically inferred based on shared and unique elements in the data. You can override them</span>
<span class="sd">        using `ax_xlabel` and `ax_ylabel` in *kwargs*. Datapoint labels can be overridden with a list of labels</span>
<span class="sd">        (one per line in the legend).</span>

<span class="sd">    Shortcuts and default values:</span>
<span class="sd">        This function includes shortcut variants with predefined default values:</span>

<span class="sd">        - `plot.intnorm`: sets `default_attrname=&quot;intnorm.eRi&quot;` and `unit=None`</span>
<span class="sd">        - `plot.stdnorm`: sets `default_attrname=&quot;stdnorm.Ri&quot;` and `unit=None`</span>
<span class="sd">        - `plot.abundance`: sets `default_attrname=&quot;abundance&quot;` and `unit=None`</span>

<span class="sd">        Default argument values can also be updated through `plot.update_kwargs()`. Values defined in the function</span>
<span class="sd">        signature are used only if not overridden there. You can retrieve the default arguments using `plot.kwargs`</span>

<span class="sd">    Returns:</span>
<span class="sd">        matplotlib.axes.Axes: The axes object used for plotting.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">modeldata</span><span class="p">,</span> <span class="n">axis_labels</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="n">hist_get_data</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">xkey</span><span class="p">,</span> <span class="n">ykey</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span>
                                                 <span class="n">sum_weights</span><span class="o">=</span><span class="n">sum_weights</span><span class="p">,</span> <span class="n">norm_weights</span><span class="o">=</span><span class="n">norm_weights</span><span class="p">,</span>
                                                 <span class="n">default_attrname</span><span class="o">=</span><span class="n">default_attrname</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">unit</span><span class="p">,</span>
                                                 <span class="n">weights_default_attrname</span><span class="o">=</span><span class="n">weights_default_attrname</span><span class="p">,</span>
                                                 <span class="n">weights_unit</span><span class="o">=</span><span class="n">weights_unit</span><span class="p">,</span> <span class="n">weights_default_value</span><span class="o">=</span><span class="n">weights_default_value</span><span class="p">,</span>
                                                 <span class="n">where</span><span class="o">=</span><span class="n">where</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">,</span> <span class="n">mask_na</span><span class="o">=</span><span class="n">mask_na</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="s1">&#39;xy&#39;</span><span class="p">:</span>
        <span class="c1"># 2d - circular histogram</span>
        <span class="k">return</span> <span class="n">hist_draw2d</span><span class="p">(</span><span class="n">modeldata</span><span class="p">,</span> <span class="n">axis_labels</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">fill</span><span class="p">,</span> <span class="n">rescale</span><span class="o">=</span><span class="n">rescale</span><span class="p">,</span>
                             <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span> <span class="n">update_ax</span><span class="o">=</span><span class="n">update_ax</span><span class="p">,</span> <span class="n">update_fig</span><span class="o">=</span><span class="n">update_fig</span><span class="p">,</span>
                             <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># 1d - traditional histogram</span>
        <span class="k">return</span> <span class="n">hist_draw1d</span><span class="p">(</span><span class="n">modeldata</span><span class="p">,</span> <span class="n">axis_labels</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">fill</span><span class="p">,</span> <span class="n">rescale</span><span class="o">=</span><span class="n">rescale</span><span class="p">,</span>
                             <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span> <span class="n">update_ax</span><span class="o">=</span><span class="n">update_ax</span><span class="p">,</span> <span class="n">update_fig</span><span class="o">=</span><span class="n">update_fig</span><span class="p">,</span>
                             <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="simple.hist_ccsne" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">hist_ccsne</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">hist_ccsne</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">xkey</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ykey</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>CCSNe implementation of <a class="autorefs autorefs-internal" href="#simple.hist"><code>hist</code></a>. See this function for more details and a
description of the optional arguments.</p>
<p><strong>Note</strong> Weights are calculated using <a class="autorefs autorefs-internal" href="../ccsne/#simple.ccsne.add_weights_ccsne"><code>add_weights_ccsne</code></a> where each
weight is multiplied by the mass associated with each mass coordinate in CCSNe models.</p>

            <details class="quote">
              <summary>Source code in <code>simple/ccsne.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@utils</span><span class="o">.</span><span class="n">set_default_kwargs</span><span class="p">(</span><span class="n">inherits_</span><span class="o">=</span><span class="n">plotting</span><span class="o">.</span><span class="n">hist</span><span class="p">,</span>
                                  <span class="n">weights_default_attrname</span><span class="o">=</span><span class="s1">&#39;abundance&#39;</span><span class="p">,</span> <span class="n">weights_unit</span><span class="o">=</span><span class="s1">&#39;mass&#39;</span><span class="p">,</span>
                                  <span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">hist_ccsne</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">xkey</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ykey</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    CCSNe implementation of [`hist`][simple.hist]. See this function for more details and a</span>
<span class="sd">    description of the optional arguments.</span>

<span class="sd">    **Note** Weights are calculated using [`add_weights_ccsne`][simple.ccsne.add_weights_ccsne] where each</span>
<span class="sd">    weight is multiplied by the mass associated with each mass coordinate in CCSNe models.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;SIMPLE_add_weights&#39;</span><span class="p">,</span> <span class="n">add_weights_ccsne</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">plotting</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">xkey</span><span class="p">,</span> <span class="n">ykey</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="n">r</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="simple.load_collection" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">load_collection</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">load_collection</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">dbfilename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">default_isolist</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">convert_unit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">where_kwargs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Loads a selection of models from a file.</p>
<p>If that file does not exist it will create the file from the specified models file. Only when doing this
is the <code>default_isolist</code> applied. If <code>filename</code> already exits the <strong>assumption</strong> is it has the correct isolist.</p>
<p><strong>*Notes</strong></p>
<p>The entire file will be read into memory. This might be an issue if reading very large files. The hdf5 are
compressed so will be significantly larger when stored in memory.</p>
<p>When reading the database file to create a subselection of the data using <code>default_isolist</code>, the subselection is
 made when each model is loaded which reduces the amount of memory used.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code>filename</code></b>
              (<code><span title="str">str</span></code>)
          –
          <div class="doc-md-description">
            <p>Name of the file to load or create.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>dbfilename</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Name of the _func models file</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>default_isolist</code></b>
          –
          <div class="doc-md-description">
            <p>Isolist applied to loaded models from <code>dbfilename</code>.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>convert_units</code></b>
              (<code><span title="bool">bool</span></code>)
          –
          <div class="doc-md-description">
            <p>If <code>True</code>  and data is stored in a mass unit all values will be divided by the
mass number of the isotope before summing values together. The final value is then multiplied by the
mass number of the output isotope.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>overwrite</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>If <code>True</code> a new file will be created even if <code>filename</code> already exists.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>where</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Used to select which models to load.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>**where_kwargs</code></b>
          –
          <div class="doc-md-description">
            <p>Keyword arguments used in combination with <code>where</code>.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          –
          <div class="doc-md-description">
            <p>A <a class="autorefs autorefs-internal" href="../models/#simple.models.ModelCollection">ModelCollection</a> object containing all the loaded models.</p>
          </div>
        </li>
    </ul>

            <details class="quote">
              <summary>Source code in <code>simple/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">load_collection</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">dbfilename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">default_isolist</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">convert_unit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">where</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">where_kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Loads a selection of models from a file.</span>

<span class="sd">    If that file does not exist it will create the file from the specified models file. Only when doing this</span>
<span class="sd">    is the ``default_isolist`` applied. If ``filename`` already exits the **assumption** is it has the correct isolist.</span>

<span class="sd">    ***Notes**</span>

<span class="sd">    The entire file will be read into memory. This might be an issue if reading very large files. The hdf5 are</span>
<span class="sd">    compressed so will be significantly larger when stored in memory.</span>

<span class="sd">    When reading the database file to create a subselection of the data using ``default_isolist``, the subselection is</span>
<span class="sd">     made when each model is loaded which reduces the amount of memory used.</span>

<span class="sd">    Args:</span>
<span class="sd">        filename (str): Name of the file to load or create.</span>
<span class="sd">        dbfilename (str): Name of the _func models file</span>
<span class="sd">        default_isolist (): Isolist applied to loaded models from ``dbfilename``.</span>
<span class="sd">        convert_units (bool): If ``True``  and data is stored in a mass unit all values will be divided by the</span>
<span class="sd">            mass number of the isotope before summing values together. The final value is then multiplied by the</span>
<span class="sd">            mass number of the output isotope.</span>
<span class="sd">        overwrite (bool): If ``True`` a new file will be created even if ``filename`` already exists.</span>
<span class="sd">        where (str): Used to select which models to load.</span>
<span class="sd">        **where_kwargs (): Keyword arguments used in combination with ``where``.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A [ModelCollection][simple.models.ModelCollection] object containing all the loaded models.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mc</span> <span class="o">=</span> <span class="n">ModelCollection</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">overwrite</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Loading existing file: </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">mc</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">where</span><span class="p">,</span> <span class="o">**</span><span class="n">where_kwargs</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">filename</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">:]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">!=</span> <span class="s1">&#39;.hdf5&#39;</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s1">.hdf5&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">overwrite</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Loading existing file: </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s1">.hdf5&#39;</span><span class="p">)</span>
        <span class="n">mc</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s1">.hdf5&#39;</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">where</span><span class="p">,</span> <span class="o">**</span><span class="n">where_kwargs</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">dbfilename</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;File </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s1"> does not exist&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">dbfilename</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Creating: &quot;</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s1">&quot; from database: &quot;</span><span class="si">{</span><span class="n">dbfilename</span><span class="si">}</span><span class="s1">&quot;&#39;</span><span class="p">)</span>
        <span class="n">mc</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="n">dbfilename</span><span class="p">,</span> <span class="n">isolist</span><span class="o">=</span><span class="n">default_isolist</span><span class="p">,</span> <span class="n">convert_unit</span><span class="o">=</span><span class="n">convert_unit</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">where</span><span class="p">,</span> <span class="o">**</span><span class="n">where_kwargs</span><span class="p">)</span>
        <span class="n">mc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Neither &quot;</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s1">&quot; or &quot;</span><span class="si">{</span><span class="n">dbfilename</span><span class="si">}</span><span class="s1">&quot; exist&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">mc</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="simple.load_defaults" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">load_defaults</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">load_defaults</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Loads default arguments for functions from a YAML formatted file.</p>
<p>To use a set of default values, unpack the arguments in the function call (See example).</p>
<p>You can still arguments and keyword arguments as normal as long as they are not included in the default dictionary.</p>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          –
          <div class="doc-md-description">
            <p>A named dictionary mapping the prefixes given in the yaml file to another dictionary mapping the arguments</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          –
          <div class="doc-md-description">
            <p>to the specified values.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <p>The file <code>default.yaml</code> is expected to look like this:</p>
<pre><code>somefunction:
    arg: value
    listarg:
        - first thing in list
        - second thing in list

anotherfunction:
    arg: value
</code></pre>
<p>It can be used like this</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">defaults</span> <span class="o">=</span> <span class="n">simple</span><span class="o">.</span><span class="n">load_defaults</span><span class="p">(</span><span class="s1">&#39;defaults.yaml&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">somefunction</span><span class="p">(</span><span class="o">**</span><span class="n">defaults</span><span class="p">[</span><span class="s1">&#39;somefunction&#39;</span><span class="p">])</span> <span class="c1"># Unpack arguments into function call</span>
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>simple/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">load_defaults</span><span class="p">(</span><span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Loads default arguments for functions from a YAML formatted file.</span>

<span class="sd">    To use a set of default values, unpack the arguments in the function call (See example).</span>

<span class="sd">    You can still arguments and keyword arguments as normal as long as they are not included in the default dictionary.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A named dictionary mapping the prefixes given in the yaml file to another dictionary mapping the arguments</span>
<span class="sd">        to the specified values.</span>

<span class="sd">    Examples:</span>
<span class="sd">        The file ``default.yaml`` is expected to look like this:</span>
<span class="sd">        ```</span>
<span class="sd">        somefunction:</span>
<span class="sd">            arg: value</span>
<span class="sd">            listarg:</span>
<span class="sd">                - first thing in list</span>
<span class="sd">                - second thing in list</span>

<span class="sd">        anotherfunction:</span>
<span class="sd">            arg: value</span>
<span class="sd">        ```</span>

<span class="sd">        It can be used like this</span>
<span class="sd">        &gt;&gt;&gt; defaults = simple.load_defaults(&#39;defaults.yaml&#39;)</span>
<span class="sd">        &gt;&gt;&gt; somefunction(**defaults[&#39;somefunction&#39;]) # Unpack arguments into function call</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">yaml</span><span class="o">.</span><span class="n">safe_load</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="simple.new_collection" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">new_collection</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">new_collection</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Return an empty <a class="autorefs autorefs-internal" href="../models/#simple.models.ModelCollection">ModelCollection</a> object.</p>

            <details class="quote">
              <summary>Source code in <code>simple/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">new_collection</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return an empty [ModelCollection][simple.models.ModelCollection] object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">ModelCollection</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="simple.plot" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">plot</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">plot</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">xkey</span><span class="p">,</span> <span class="n">ykey</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">default_attrname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mask_na</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">update_ax</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">update_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">hist</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">hist_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">hist_pad</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Plot <em>xkey</em> against <em>ykey</em> for each model in <em>models</em>.</p>
<p>This function retrieves data using <a class="autorefs autorefs-internal" href="#simple.get_data"><code>get_data</code></a> and plots it using matplotlib. It supports
optional filtering, masking, and per-model or per-dataset styling. Additional arguments can be passed using
keyword prefixes to control axes, figure appearance, legends, and more.</p>
<p>This function is split into two stages: <a class="autorefs autorefs-internal" href="../plotting/#simple.plotting.plot_get_data"><code>plot_get_data</code></a> and
<a class="autorefs autorefs-internal" href="../plotting/#simple.plotting.plot_draw"><code>plot_draw</code></a>, which can be used independently.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code>models</code></b>
              (<code><span title="ModelCollection">ModelCollection</span></code>)
          –
          <div class="doc-md-description">
            <p>A collection of models to plot. A subset can be selected using the <em>where</em> argument.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>xkey, ykey</code></b>
              (<code>str, int, or slice</code>)
          –
          <div class="doc-md-description">
            <p>Keys or indices used to retrieve the x and y data arrays. These may refer to
array indices (relative to <em>default_attrname</em>) or full attribute paths.
See <a class="autorefs autorefs-internal" href="#simple.get_data"><code>get_data</code></a> for more.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>default_attrname</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Name of the default attribute used when <em>xkey</em> or <em>ykey</em> is an index.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>unit</code></b>
              (<code><span title="str">str</span> or <span title="tuple">tuple</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Desired unit(s) for the x and y axes. Use a tuple <code>(xunit, yunit)</code> for different units.
where (str): Filter expression to select a subset of <em>models</em>. See
<a class="autorefs autorefs-internal" href="../models/#simple.models.ModelCollection.where"><code>ModelCollection.where</code></a>.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>mask</code></b>
              (<code>str, int, or slice</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Optional mask to apply to the data. See the <code>get_mask</code> method on model instances.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>mask_na</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>If True, masked values are replaced with <code>np.nan</code>. Only applies if <em>xkey</em> and <em>ykey</em> are
float-based.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>ax</code></b>
              (<code><span title="matplotlib.axes.Axes">Axes</span> or None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>The axes to plot on. If None, defaults to <code>plt.gca()</code>.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>legend</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to add a legend. If <code>None</code>, a legend is shown if at least one datapoint has a label.
Legend made using <a class="autorefs autorefs-internal" href="../plotting/#simple.plotting.create_legend"><code>create_legend</code></a>.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>update_ax, update_fig</code></b>
              (<code><span title="bool">bool</span></code>)
          –
          <div class="doc-md-description">
            <p>Whether to apply <code>ax_&lt;keyword&gt;</code> and <code>fig_&lt;keyword&gt;</code> arguments using
<a class="autorefs autorefs-internal" href="../plotting/#simple.plotting.update_axes"><code>update_axes</code></a>.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>hist</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to show marginal histograms along the axis.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>hist_size</code></b>
              (<code><span title="float">float</span></code>, default:
                  <code>0.3</code>
)
          –
          <div class="doc-md-description">
            <p>Relative size of the histogram axes.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>hist_pad</code></b>
              (<code><span title="float">float</span></code>, default:
                  <code>0.05</code>
)
          –
          <div class="doc-md-description">
            <p>Padding between the main plot and histogram axes.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>kwargs</code></b>
              (<code><span title="dict">dict</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Keyword arguments can be provided either explicitly via <code>kwargs</code> or implicitly via
<code>**kwargs</code>. If the same keyword is provided in both, the value in kwargs takes precedence. A description of
accepted keywords is provided below.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>Accepted keyword arguments</code></b>
          –
          <div class="doc-md-description">
            <p>Direct keywords:
    - Any keyword accepted by <a class="autorefs autorefs-internal" href="#simple.get_data"><code>simple.get_data</code></a>.
    - <code>color</code>: Can be a list of colours, <code>True</code> for defaults, or <code>False</code> to use black.
    - <code>linestyle</code>: Can be a list of styles, <code>True</code> for defaults, or <code>False</code> to disable lines.
    - <code>marker</code>: Can be a list of markers, <code>True</code> for defaults, or <code>False</code> to disable markers.
    - <code>color_by_model</code>, <code>linestyle_by_model</code>, <code>marker_by_model</code>: If <code>True</code> every dataset for each model will be
      plotted with the same colour/linestyle/maker value. If <code>False</code>, the corresponding datasets for each model
      will be plotted with the same value. If <code>None</code> the default behaviour is used.
    - <code>yhist</code>, <code>xhist</code>: If <code>True</code>, show a histogram along the specified axis. Takes precedence over `hist'.</p>
<p>Prefixed keywords:
    - <code>plt_&lt;keyword&gt;</code>: Keywords passed to the primary plotting function, <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.axline.html"><code>axline</code></a>.
    - <code>where_&lt;keyword&gt;</code>: Keywords passed to the model filtering function, <a class="autorefs autorefs-internal" href="../models/#simple.models.ModelCollection.where"><code>ModelCollection.where</code></a>.
    - <code>ax_&lt;keyword&gt;</code>: Keywords passed to <a class="autorefs autorefs-internal" href="../plotting/#simple.plotting.update_axes"><code>update_axes</code></a>.
    - <code>fig_&lt;keyword&gt;</code>: Keywords passed to [<code>update_fig</code>][simple.plotting.update_fig].
    - <code>legend_&lt;keyword&gt;</code>: Keywords passed to <a class="autorefs autorefs-internal" href="../plotting/#simple.plotting.create_legend"><code>create_legend</code></a>.
    - <code>hist_&lt;keyword&gt;</code>: Default keywords for <code>xhist_&lt;keyword&gt;</code> and <code>yhist_&lt;keyword&gt;</code>.
    - <code>xhist_&lt;keyword&gt;</code>: Keywords passed to [<code>axhist</code>][simple.plotting.axhist] for the x axis.
    - <code>yhist_&lt;keyword&gt;</code>: Keywords passed to [<code>axhist</code>][simple.plotting.axhist] for the y axis.</p>
          </div>
        </li>
    </ul>


<details class="axis-and-data-labels" open>
  <summary>Axis and data labels</summary>
  <p>Axis labels are automatically inferred based on shared and unique elements in the data. You can override them
using <code>ax_xlabel</code> and <code>ax_ylabel</code> in <em>kwargs</em>. Datapoint labels can be overridden with a list of labels
(one per line in the legend).</p>
</details>

<details class="shortcuts-and-default-values" open>
  <summary>Shortcuts and default values</summary>
  <p>This function includes shortcut variants with predefined argument:</p>
<ul>
<li><code>plot.intnorm</code>: sets <code>default_attrname="intnorm.eRi"</code> and <code>unit=None</code></li>
<li><code>plot.stdnorm</code>: sets <code>default_attrname="stdnorm.Ri"</code> and <code>unit=None</code></li>
<li><code>plot.abundance</code>: sets <code>default_attrname="abundance"</code> and <code>unit=None</code></li>
</ul>
<p>Default argument values can also be updated through <code>plot.update_kwargs()</code>. Values defined in the function
signature are used only if not overridden there. You can retrieve the default arguments using <code>plot.kwargs</code></p>
</details>

<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          –
          <div class="doc-md-description">
            <p>matplotlib.axes.Axes: The axes object used for plotting.</p>
          </div>
        </li>
    </ul>

            <details class="quote">
              <summary>Source code in <code>simple/plotting.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@utils</span><span class="o">.</span><span class="n">add_shortcut</span><span class="p">(</span><span class="s1">&#39;abundance&#39;</span><span class="p">,</span> <span class="n">default_attrname</span> <span class="o">=</span><span class="s1">&#39;abundance&#39;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="nd">@utils</span><span class="o">.</span><span class="n">add_shortcut</span><span class="p">(</span><span class="s1">&#39;stdnorm&#39;</span><span class="p">,</span> <span class="n">default_attrname</span> <span class="o">=</span><span class="s1">&#39;stdnorm.Ri&#39;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="nd">@utils</span><span class="o">.</span><span class="n">add_shortcut</span><span class="p">(</span><span class="s1">&#39;intnorm&#39;</span><span class="p">,</span> <span class="n">default_attrname</span><span class="o">=</span><span class="s1">&#39;intnorm.eRi&#39;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="nd">@utils</span><span class="o">.</span><span class="n">set_default_kwargs</span><span class="p">(</span>
    <span class="n">linestyle</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">linestyle_by_model</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">color_by_model</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">marker_by_model</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">ax_kw_xlabel_fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
    <span class="n">ax_kw_ylabel_fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
    <span class="n">plt_markersize</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">legend_outside</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">ax_tick_params</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="n">fig_size</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mf">6.5</span><span class="p">),</span>
    <span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">xkey</span><span class="p">,</span> <span class="n">ykey</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
         <span class="n">default_attrname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
         <span class="n">where</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mask</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">mask_na</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
         <span class="n">legend</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">update_ax</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">update_fig</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
         <span class="n">hist</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">hist_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">hist_pad</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot *xkey* against *ykey* for each model in *models*.</span>

<span class="sd">    This function retrieves data using [`get_data`][simple.get_data] and plots it using matplotlib. It supports</span>
<span class="sd">    optional filtering, masking, and per-model or per-dataset styling. Additional arguments can be passed using</span>
<span class="sd">    keyword prefixes to control axes, figure appearance, legends, and more.</span>

<span class="sd">    This function is split into two stages: [`plot_get_data`][simple.plotting.plot_get_data] and</span>
<span class="sd">    [`plot_draw`][simple.plotting.plot_draw], which can be used independently.</span>

<span class="sd">    Args:</span>
<span class="sd">        models (ModelCollection): A collection of models to plot. A subset can be selected using the *where* argument.</span>
<span class="sd">        xkey, ykey (str, int, or slice): Keys or indices used to retrieve the x and y data arrays. These may refer to</span>
<span class="sd">            array indices (relative to *default_attrname*) or full attribute paths.</span>
<span class="sd">            See [`get_data`][simple.get_data] for more.</span>
<span class="sd">        default_attrname (str): Name of the default attribute used when *xkey* or *ykey* is an index.</span>
<span class="sd">        unit (str or tuple): Desired unit(s) for the x and y axes. Use a tuple `(xunit, yunit)` for different units.</span>
<span class="sd">         where (str): Filter expression to select a subset of *models*. See</span>
<span class="sd">            [`ModelCollection.where`][simple.models.ModelCollection.where].</span>
<span class="sd">        mask (str, int, or slice): Optional mask to apply to the data. See the `get_mask` method on model instances.</span>
<span class="sd">        mask_na (bool): If True, masked values are replaced with `np.nan`. Only applies if *xkey* and *ykey* are</span>
<span class="sd">            float-based.</span>
<span class="sd">        ax (matplotlib.axes.Axes or None): The axes to plot on. If None, defaults to `plt.gca()`.</span>
<span class="sd">        legend (bool): Whether to add a legend. If `None`, a legend is shown if at least one datapoint has a label.</span>
<span class="sd">            Legend made using [`create_legend`][simple.plotting.create_legend].</span>
<span class="sd">        update_ax, update_fig (bool): Whether to apply `ax_&lt;keyword&gt;` and `fig_&lt;keyword&gt;` arguments using</span>
<span class="sd">            [`update_axes`][simple.plotting.update_axes].</span>
<span class="sd">        hist (bool): Whether to show marginal histograms along the axis.</span>
<span class="sd">        hist_size (float): Relative size of the histogram axes.</span>
<span class="sd">        hist_pad (float): Padding between the main plot and histogram axes.</span>
<span class="sd">        kwargs (dict, optional): Keyword arguments can be provided either explicitly via `kwargs` or implicitly via</span>
<span class="sd">            `**kwargs`. If the same keyword is provided in both, the value in kwargs takes precedence. A description of</span>
<span class="sd">            accepted keywords is provided below.</span>


<span class="sd">        Accepted keyword arguments:</span>
<span class="sd">            Direct keywords:</span>
<span class="sd">                - Any keyword accepted by [`simple.get_data`][simple.get_data].</span>
<span class="sd">                - `color`: Can be a list of colours, `True` for defaults, or `False` to use black.</span>
<span class="sd">                - `linestyle`: Can be a list of styles, `True` for defaults, or `False` to disable lines.</span>
<span class="sd">                - `marker`: Can be a list of markers, `True` for defaults, or `False` to disable markers.</span>
<span class="sd">                - `color_by_model`, `linestyle_by_model`, `marker_by_model`: If `True` every dataset for each model will be</span>
<span class="sd">                  plotted with the same colour/linestyle/maker value. If `False`, the corresponding datasets for each model</span>
<span class="sd">                  will be plotted with the same value. If `None` the default behaviour is used.</span>
<span class="sd">                - `yhist`, `xhist`: If `True`, show a histogram along the specified axis. Takes precedence over `hist&#39;.</span>


<span class="sd">            Prefixed keywords:</span>
<span class="sd">                - `plt_&lt;keyword&gt;`: Keywords passed to the primary plotting function, [`axline`](https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.axline.html).</span>
<span class="sd">                - `where_&lt;keyword&gt;`: Keywords passed to the model filtering function, [`ModelCollection.where`][simple.models.ModelCollection.where].</span>
<span class="sd">                - `ax_&lt;keyword&gt;`: Keywords passed to [`update_axes`][simple.plotting.update_axes].</span>
<span class="sd">                - `fig_&lt;keyword&gt;`: Keywords passed to [`update_fig`][simple.plotting.update_fig].</span>
<span class="sd">                - `legend_&lt;keyword&gt;`: Keywords passed to [`create_legend`][simple.plotting.create_legend].</span>
<span class="sd">                - `hist_&lt;keyword&gt;`: Default keywords for `xhist_&lt;keyword&gt;` and `yhist_&lt;keyword&gt;`.</span>
<span class="sd">                - `xhist_&lt;keyword&gt;`: Keywords passed to [`axhist`][simple.plotting.axhist] for the x axis.</span>
<span class="sd">                - `yhist_&lt;keyword&gt;`: Keywords passed to [`axhist`][simple.plotting.axhist] for the y axis.</span>

<span class="sd">    Axis and data labels:</span>
<span class="sd">        Axis labels are automatically inferred based on shared and unique elements in the data. You can override them</span>
<span class="sd">        using `ax_xlabel` and `ax_ylabel` in *kwargs*. Datapoint labels can be overridden with a list of labels</span>
<span class="sd">        (one per line in the legend).</span>


<span class="sd">    Shortcuts and default values:</span>
<span class="sd">        This function includes shortcut variants with predefined argument:</span>

<span class="sd">        - `plot.intnorm`: sets `default_attrname=&quot;intnorm.eRi&quot;` and `unit=None`</span>
<span class="sd">        - `plot.stdnorm`: sets `default_attrname=&quot;stdnorm.Ri&quot;` and `unit=None`</span>
<span class="sd">        - `plot.abundance`: sets `default_attrname=&quot;abundance&quot;` and `unit=None`</span>

<span class="sd">        Default argument values can also be updated through `plot.update_kwargs()`. Values defined in the function</span>
<span class="sd">        signature are used only if not overridden there. You can retrieve the default arguments using `plot.kwargs`</span>


<span class="sd">    Returns:</span>
<span class="sd">        matplotlib.axes.Axes: The axes object used for plotting.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">modeldata</span><span class="p">,</span> <span class="n">axis_labels</span> <span class="o">=</span> <span class="n">plot_get_data</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">xkey</span><span class="p">,</span> <span class="n">ykey</span><span class="p">,</span>
                                           <span class="n">default_attrname</span><span class="o">=</span><span class="n">default_attrname</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">unit</span><span class="p">,</span>
                                           <span class="n">where</span><span class="o">=</span><span class="n">where</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">,</span> <span class="n">mask_na</span><span class="o">=</span><span class="n">mask_na</span><span class="p">,</span> <span class="n">hist</span><span class="o">=</span><span class="n">hist</span><span class="p">,</span>
                                           <span class="n">kwargs</span><span class="o">=</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">plot_draw</span><span class="p">(</span><span class="n">modeldata</span><span class="p">,</span> <span class="n">axis_labels</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span>
                     <span class="n">update_ax</span><span class="o">=</span><span class="n">update_ax</span><span class="p">,</span> <span class="n">update_fig</span><span class="o">=</span><span class="n">update_fig</span><span class="p">,</span>
                     <span class="n">hist</span><span class="o">=</span><span class="n">hist</span><span class="p">,</span> <span class="n">hist_size</span><span class="o">=</span><span class="n">hist_size</span><span class="p">,</span> <span class="n">hist_pad</span><span class="o">=</span><span class="n">hist_pad</span><span class="p">,</span>
                     <span class="n">kwargs</span><span class="o">=</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="simple.plot_ccsne" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">plot_ccsne</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">plot_ccsne</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">ykey</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">semilog</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">onion</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>CCSNe implementation of the <a class="autorefs autorefs-internal" href="#simple.plot"><code>plot</code></a> function where you specify the data on the y-axis which is
automatically plotted against the mass coordinates on the x-axis. See this function for more details and a
description of the optional arguments.</p>
<p>If a single model is shown, then by default the onion shell structure is also drawn if
<code>onion=True</code> or if <code>onion=None</code>.</p>
<p>The y-axis is drawn on a logarithmic scale if <code>semilog=True</code>.</p>
<p><strong>Note</strong> Weights are calculated using <a class="autorefs autorefs-internal" href="../ccsne/#simple.ccsne.add_weights_ccsne"><code>add_weights_ccsne</code></a> where each
weight is multiplied by the mass associated with each mass coordinate in CCSNe models.</p>

            <details class="quote">
              <summary>Source code in <code>simple/ccsne.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@utils</span><span class="o">.</span><span class="n">set_default_kwargs</span><span class="p">(</span><span class="n">inherits_</span><span class="o">=</span><span class="n">plotting</span><span class="o">.</span><span class="n">plot</span><span class="p">,</span>
                                  <span class="n">linestyle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span>
                                  <span class="n">xhist</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">plot_ccsne</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">ykey</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
         <span class="n">semilog</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">onion</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
         <span class="n">kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    CCSNe implementation of the [`plot`][simple.plot] function where you specify the data on the y-axis which is</span>
<span class="sd">    automatically plotted against the mass coordinates on the x-axis. See this function for more details and a</span>
<span class="sd">    description of the optional arguments.</span>

<span class="sd">    If a single model is shown, then by default the onion shell structure is also drawn if</span>
<span class="sd">    `onion=True` or if `onion=None`.</span>

<span class="sd">    The y-axis is drawn on a logarithmic scale if `semilog=True`.</span>

<span class="sd">    **Note** Weights are calculated using [`add_weights_ccsne`][simple.ccsne.add_weights_ccsne] where each</span>
<span class="sd">    weight is multiplied by the mass associated with each mass coordinate in CCSNe models.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">onion_kwargs</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop_many</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;onion&#39;</span><span class="p">,</span> <span class="s1">&#39;zone&#39;</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">semilog</span><span class="p">:</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;ax_yscale&#39;</span><span class="p">,</span> <span class="s1">&#39;log&#39;</span><span class="p">)</span>
    <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;SIMPLE_add_weights&#39;</span><span class="p">,</span> <span class="n">add_weights_ccsne</span><span class="p">)</span>

    <span class="n">modeldata</span><span class="p">,</span> <span class="n">axis_labels</span> <span class="o">=</span> <span class="n">plotting</span><span class="o">.</span><span class="n">plot_get_data</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="s1">&#39;.masscoord&#39;</span><span class="p">,</span> <span class="n">ykey</span><span class="p">,</span>
                                           <span class="n">xunit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="n">ax</span> <span class="o">=</span> <span class="n">plotting</span><span class="o">.</span><span class="n">plot_draw</span><span class="p">(</span><span class="n">modeldata</span><span class="p">,</span> <span class="n">axis_labels</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">onion</span> <span class="ow">or</span> <span class="p">(</span><span class="n">onion</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">modeldata</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">modeldata</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Can only plot onion structure for a single model&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plot_zonal_structure</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">modeldata</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="o">**</span><span class="n">onion_kwargs</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">ax</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="simple.set_logging_level" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">set_logging_level</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">set_logging_level</span><span class="p">(</span><span class="n">level</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Set the level of messages to be displayed.</p>
<p>Options are: DEBUG, INFO, WARNING, ERROR.</p>

            <details class="quote">
              <summary>Source code in <code>simple/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">set_logging_level</span><span class="p">(</span><span class="n">level</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set the level of messages to be displayed.</span>

<span class="sd">    Options are: DEBUG, INFO, WARNING, ERROR.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">level</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;DEBUG&#39;</span><span class="p">:</span>
        <span class="n">level</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span>
    <span class="k">elif</span> <span class="n">level</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;INFO&#39;</span><span class="p">:</span>
        <span class="n">level</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">INFO</span>
    <span class="k">elif</span> <span class="n">level</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;WARNING&#39;</span><span class="p">:</span>
        <span class="n">level</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span>
    <span class="k">elif</span> <span class="n">level</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;ERROR&#39;</span><span class="p">:</span>
        <span class="n">level</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">ERROR</span>

    <span class="n">SimpleLogger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">level</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="simple.slope" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">slope</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">slope</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">xkey</span><span class="p">,</span> <span class="n">ykey</span><span class="p">,</span> <span class="n">xycoord</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="o">*</span><span class="p">,</span> <span class="n">arrow</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">arrow_position</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">default_attrname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mask_na</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">update_ax</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">update_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Plot the slope of <em>ykey</em>/<em>xkey</em> for each model in <em>models</em>.</p>
<p>This function retrieves data using <a class="autorefs autorefs-internal" href="#simple.get_data"><code>get_data</code></a> and plots it using matplotlib
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.axline.html"><code>axline</code></a>. It supports
optional filtering, masking, and per-model or per-dataset styling. Additional arguments can be passed using
keyword prefixes to control axes, figure appearance, legends, and more.</p>
<p>This function is split into two stages: <a class="autorefs autorefs-internal" href="../plotting/#simple.plotting.slope_get_data"><code>slope_get_data</code></a> and
<a class="autorefs autorefs-internal" href="../plotting/#simple.plotting.slope_draw"><code>slope_draw</code></a>, which can be used independently.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code>models</code></b>
              (<code><span title="ModelCollection">ModelCollection</span></code>)
          –
          <div class="doc-md-description">
            <p>A collection of models to plot. A subset can be selected using the <em>where</em> argument.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>xkey, ykey</code></b>
              (<code>str, int, or slice</code>)
          –
          <div class="doc-md-description">
            <p>Keys or indices used to retrieve the x and y data arrays. These may refer to
array indices (relative to <em>default_attrname</em>) or full attribute paths. See <a class="autorefs autorefs-internal" href="#simple.get_data"><code>get_data</code></a>
for more information.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>xycoord</code></b>
              (<code><span title="tuple">tuple</span></code>, default:
                  <code>(0, 0)</code>
)
          –
          <div class="doc-md-description">
            <p>Coordinates to a point the slope passes through. Defaults to <code>(0, 0)</code>.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>arrow</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to draw arrows indicating the direction of the endmember given by the x and y coordinates.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>arrow_position</code></b>
              (<code><span title="float">float</span></code>, default:
                  <code>0.9</code>
)
          –
          <div class="doc-md-description">
            <p>Relative position of the arrow on the line. Defaults to 0.9.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>default_attrname</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Name of the default attribute used when <em>xkey</em> or <em>ykey</em> is an index.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>unit</code></b>
              (<code><span title="str">str</span> or <span title="tuple">tuple</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Desired unit(s) for the x and y axes. Use a tuple <code>(xunit, yunit)</code> for different units.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>where</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Filter expression to select a subset of <em>models</em>. See
<a class="autorefs autorefs-internal" href="../models/#simple.models.ModelCollection.where"><code>ModelCollection.where</code></a>.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>mask</code></b>
              (<code>str, int, or slice</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Optional mask to apply to the data. See the <code>get_mask</code> method on model instances.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>mask_na</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>If True, masked values are replaced with <code>np.nan</code>. Only applies if <em>xkey</em> and <em>ykey</em> are
float-based.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>ax</code></b>
              (<code><span title="matplotlib.axes.Axes">Axes</span> or None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>The axes to plot on. If None, defaults to <code>plt.gca()</code>.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>legend</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to add a legend. If <code>None</code>, a legend is shown if at least one datapoint has a label.
Legend made using <a class="autorefs autorefs-internal" href="../plotting/#simple.plotting.create_legend"><code>create_legend</code></a>.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>update_ax, update_fig</code></b>
              (<code><span title="bool">bool</span></code>)
          –
          <div class="doc-md-description">
            <p>Whether to apply <code>ax_&lt;keyword&gt;</code> and <code>fig_&lt;keyword&gt;</code> arguments using
<a class="autorefs autorefs-internal" href="../plotting/#simple.plotting.update_axes"><code>update_axes</code></a>.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>kwargs</code></b>
              (<code><span title="dict">dict</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Keyword arguments can be provided either explicitly via <code>kwargs</code> or implicitly via
<code>**kwargs</code>. If the same keyword is provided in both, the value in kwargs takes precedence. A description of
accepted keywords is provided below.</p>
          </div>
        </li>
    </ul>


<details class="accepted-keyword-arguments" open>
  <summary>Accepted keyword arguments</summary>
  <p>Direct keywords:
    - Any keyword accepted by <a class="autorefs autorefs-internal" href="#simple.get_data"><code>simple.get_data</code></a>.
    - <code>color</code>: Can be a list of colours, <code>True</code> for defaults, or <code>False</code> to use black.
    - <code>linestyle</code>: Can be a list of styles, <code>True</code> for defaults, or <code>False</code> to disable lines.
     - <code>color_by_model</code>, <code>linestyle_by_model</code>: If <code>True</code> every dataset for each model will be
      plotted with the same colour/linestyle value. If <code>False</code>, the corresponding datasets for each model
      will be plotted with the same value. If <code>None</code> the default behaviour is used.</p>
<p>Prefixed keywords:
    - <code>plt_&lt;keyword&gt;</code>: Keywords passed to the primary plotting function, <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.axline.html"><code>axline</code></a>.
    - <code>where_&lt;keyword&gt;</code>: Keywords passed to the model filtering function, <a class="autorefs autorefs-internal" href="../models/#simple.models.ModelCollection.where"><code>ModelCollection.where</code></a>.
    - <code>ax_&lt;keyword&gt;</code>: Keywords passed to <a class="autorefs autorefs-internal" href="../plotting/#simple.plotting.update_axes"><code>update_axes</code></a>.
    - <code>fig_&lt;keyword&gt;</code>: Keywords passed to [<code>update_fig</code>][simple.plotting.update_fig].
    - <code>legend_&lt;keyword&gt;</code>: Keywords passed to <a class="autorefs autorefs-internal" href="../plotting/#simple.plotting.create_legend"><code>create_legend</code></a>.
    - <code>arrow_&lt;keyword&gt;</code>: Keywords passed to <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.arrow.html"><code>matplotlib.axes.Axes.arrow</code></a>.</p>
</details>

<details class="axis-and-data-labels" open>
  <summary>Axis and data labels</summary>
  <p>Axis labels are automatically inferred based on shared and unique elements in the data. You can override them
using <code>ax_xlabel</code> and <code>ax_ylabel</code> in <em>kwargs</em>. Datapoint labels can be overridden with a list of labels
(one per line in the legend).</p>
</details>

<details class="shortcuts-and-default-values" open>
  <summary>Shortcuts and default values</summary>
  <p>This function includes shortcut variants with predefined argument:</p>
<ul>
<li><code>slope.intnorm</code>: sets <code>default_attrname="intnorm.eRi"</code> and <code>unit=None</code></li>
<li><code>slope.stdnorm</code>: sets <code>default_attrname="stdnorm.Ri"</code> and <code>unit=None</code></li>
<li><code>slope.abundance</code>: sets <code>default_attrname="abundance"</code> and <code>unit=None</code></li>
</ul>
<p>Default argument values can also be updated through <code>slope.update_kwargs()</code>. Values defined in the function
signature are used only if not overridden there. You can retrieve the default arguments using <code>slope.kwargs</code>.</p>
</details>

<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          –
          <div class="doc-md-description">
            <p>matplotlib.axes.Axes: The axes object used for plotting.</p>
          </div>
        </li>
    </ul>

            <details class="quote">
              <summary>Source code in <code>simple/plotting.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span>
<span class="normal">1629</span>
<span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span>
<span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span>
<span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span>
<span class="normal">1647</span>
<span class="normal">1648</span>
<span class="normal">1649</span>
<span class="normal">1650</span>
<span class="normal">1651</span>
<span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span>
<span class="normal">1655</span>
<span class="normal">1656</span>
<span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span>
<span class="normal">1660</span>
<span class="normal">1661</span>
<span class="normal">1662</span>
<span class="normal">1663</span>
<span class="normal">1664</span>
<span class="normal">1665</span>
<span class="normal">1666</span>
<span class="normal">1667</span>
<span class="normal">1668</span>
<span class="normal">1669</span>
<span class="normal">1670</span>
<span class="normal">1671</span>
<span class="normal">1672</span>
<span class="normal">1673</span>
<span class="normal">1674</span>
<span class="normal">1675</span>
<span class="normal">1676</span>
<span class="normal">1677</span>
<span class="normal">1678</span>
<span class="normal">1679</span>
<span class="normal">1680</span>
<span class="normal">1681</span>
<span class="normal">1682</span>
<span class="normal">1683</span>
<span class="normal">1684</span>
<span class="normal">1685</span>
<span class="normal">1686</span>
<span class="normal">1687</span>
<span class="normal">1688</span>
<span class="normal">1689</span>
<span class="normal">1690</span>
<span class="normal">1691</span>
<span class="normal">1692</span>
<span class="normal">1693</span>
<span class="normal">1694</span>
<span class="normal">1695</span>
<span class="normal">1696</span>
<span class="normal">1697</span>
<span class="normal">1698</span>
<span class="normal">1699</span>
<span class="normal">1700</span>
<span class="normal">1701</span>
<span class="normal">1702</span>
<span class="normal">1703</span>
<span class="normal">1704</span>
<span class="normal">1705</span>
<span class="normal">1706</span>
<span class="normal">1707</span>
<span class="normal">1708</span>
<span class="normal">1709</span>
<span class="normal">1710</span>
<span class="normal">1711</span>
<span class="normal">1712</span>
<span class="normal">1713</span>
<span class="normal">1714</span>
<span class="normal">1715</span>
<span class="normal">1716</span>
<span class="normal">1717</span>
<span class="normal">1718</span>
<span class="normal">1719</span>
<span class="normal">1720</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@utils</span><span class="o">.</span><span class="n">add_shortcut</span><span class="p">(</span><span class="s1">&#39;abundance&#39;</span><span class="p">,</span> <span class="n">default_attrname</span> <span class="o">=</span><span class="s1">&#39;abundance&#39;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="nd">@utils</span><span class="o">.</span><span class="n">add_shortcut</span><span class="p">(</span><span class="s1">&#39;stdnorm&#39;</span><span class="p">,</span> <span class="n">default_attrname</span> <span class="o">=</span><span class="s1">&#39;stdnorm.Ri&#39;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="nd">@utils</span><span class="o">.</span><span class="n">add_shortcut</span><span class="p">(</span><span class="s1">&#39;intnorm&#39;</span><span class="p">,</span> <span class="n">default_attrname</span><span class="o">=</span><span class="s1">&#39;intnorm.eRi&#39;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="nd">@utils</span><span class="o">.</span><span class="n">set_default_kwargs</span><span class="p">(</span>
    <span class="n">linestyle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">linestyle_by_model</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">color_by_model</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">ax_kw_xlabel_fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
    <span class="n">ax_kw_ylabel_fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
    <span class="n">legend_outside</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">ax_tick_params</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="n">fig_size</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mf">6.5</span><span class="p">),</span>
    <span class="n">arrow_linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">arrow_length_includes_head</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">arrow_head_width</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
    <span class="n">arrow_zorder</span><span class="o">=</span><span class="mi">3</span>
    <span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">slope</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">xkey</span><span class="p">,</span> <span class="n">ykey</span><span class="p">,</span> <span class="n">xycoord</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="o">*</span><span class="p">,</span>
          <span class="n">arrow</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">arrow_position</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span>
          <span class="n">default_attrname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
          <span class="n">where</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mask</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">mask_na</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
          <span class="n">legend</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">update_ax</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">update_fig</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
          <span class="n">kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot the slope of *ykey*/*xkey* for each model in *models*.</span>

<span class="sd">    This function retrieves data using [`get_data`][simple.get_data] and plots it using matplotlib</span>
<span class="sd">    [`axline`](https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.axline.html). It supports</span>
<span class="sd">    optional filtering, masking, and per-model or per-dataset styling. Additional arguments can be passed using</span>
<span class="sd">    keyword prefixes to control axes, figure appearance, legends, and more.</span>

<span class="sd">    This function is split into two stages: [`slope_get_data`][simple.plotting.slope_get_data] and</span>
<span class="sd">    [`slope_draw`][simple.plotting.slope_draw], which can be used independently.</span>


<span class="sd">    Args:</span>
<span class="sd">        models (ModelCollection): A collection of models to plot. A subset can be selected using the *where* argument.</span>
<span class="sd">        xkey, ykey (str, int, or slice): Keys or indices used to retrieve the x and y data arrays. These may refer to</span>
<span class="sd">            array indices (relative to *default_attrname*) or full attribute paths. See [`get_data`][simple.get_data]</span>
<span class="sd">            for more information.</span>
<span class="sd">        xycoord (tuple): Coordinates to a point the slope passes through. Defaults to `(0, 0)`.</span>
<span class="sd">        arrow (bool): Whether to draw arrows indicating the direction of the endmember given by the x and y coordinates.</span>
<span class="sd">        arrow_position (float): Relative position of the arrow on the line. Defaults to 0.9.</span>
<span class="sd">        default_attrname (str): Name of the default attribute used when *xkey* or *ykey* is an index.</span>
<span class="sd">        unit (str or tuple): Desired unit(s) for the x and y axes. Use a tuple `(xunit, yunit)` for different units.</span>
<span class="sd">        where (str): Filter expression to select a subset of *models*. See</span>
<span class="sd">            [`ModelCollection.where`][simple.models.ModelCollection.where].</span>
<span class="sd">        mask (str, int, or slice): Optional mask to apply to the data. See the `get_mask` method on model instances.</span>
<span class="sd">        mask_na (bool): If True, masked values are replaced with `np.nan`. Only applies if *xkey* and *ykey* are</span>
<span class="sd">            float-based.</span>
<span class="sd">        ax (matplotlib.axes.Axes or None): The axes to plot on. If None, defaults to `plt.gca()`.</span>
<span class="sd">        legend (bool): Whether to add a legend. If `None`, a legend is shown if at least one datapoint has a label.</span>
<span class="sd">            Legend made using [`create_legend`][simple.plotting.create_legend].</span>
<span class="sd">        update_ax, update_fig (bool): Whether to apply `ax_&lt;keyword&gt;` and `fig_&lt;keyword&gt;` arguments using</span>
<span class="sd">            [`update_axes`][simple.plotting.update_axes].</span>
<span class="sd">        kwargs (dict, optional): Keyword arguments can be provided either explicitly via `kwargs` or implicitly via</span>
<span class="sd">            `**kwargs`. If the same keyword is provided in both, the value in kwargs takes precedence. A description of</span>
<span class="sd">            accepted keywords is provided below.</span>


<span class="sd">    Accepted keyword arguments:</span>
<span class="sd">        Direct keywords:</span>
<span class="sd">            - Any keyword accepted by [`simple.get_data`][simple.get_data].</span>
<span class="sd">            - `color`: Can be a list of colours, `True` for defaults, or `False` to use black.</span>
<span class="sd">            - `linestyle`: Can be a list of styles, `True` for defaults, or `False` to disable lines.</span>
<span class="sd">             - `color_by_model`, `linestyle_by_model`: If `True` every dataset for each model will be</span>
<span class="sd">              plotted with the same colour/linestyle value. If `False`, the corresponding datasets for each model</span>
<span class="sd">              will be plotted with the same value. If `None` the default behaviour is used.</span>


<span class="sd">        Prefixed keywords:</span>
<span class="sd">            - `plt_&lt;keyword&gt;`: Keywords passed to the primary plotting function, [`axline`](https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.axline.html).</span>
<span class="sd">            - `where_&lt;keyword&gt;`: Keywords passed to the model filtering function, [`ModelCollection.where`][simple.models.ModelCollection.where].</span>
<span class="sd">            - `ax_&lt;keyword&gt;`: Keywords passed to [`update_axes`][simple.plotting.update_axes].</span>
<span class="sd">            - `fig_&lt;keyword&gt;`: Keywords passed to [`update_fig`][simple.plotting.update_fig].</span>
<span class="sd">            - `legend_&lt;keyword&gt;`: Keywords passed to [`create_legend`][simple.plotting.create_legend].</span>
<span class="sd">            - `arrow_&lt;keyword&gt;`: Keywords passed to [`matplotlib.axes.Axes.arrow`](https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.arrow.html).</span>


<span class="sd">    Axis and data labels:</span>
<span class="sd">        Axis labels are automatically inferred based on shared and unique elements in the data. You can override them</span>
<span class="sd">        using `ax_xlabel` and `ax_ylabel` in *kwargs*. Datapoint labels can be overridden with a list of labels</span>
<span class="sd">        (one per line in the legend).</span>


<span class="sd">    Shortcuts and default values:</span>
<span class="sd">        This function includes shortcut variants with predefined argument:</span>

<span class="sd">        - `slope.intnorm`: sets `default_attrname=&quot;intnorm.eRi&quot;` and `unit=None`</span>
<span class="sd">        - `slope.stdnorm`: sets `default_attrname=&quot;stdnorm.Ri&quot;` and `unit=None`</span>
<span class="sd">        - `slope.abundance`: sets `default_attrname=&quot;abundance&quot;` and `unit=None`</span>

<span class="sd">        Default argument values can also be updated through `slope.update_kwargs()`. Values defined in the function</span>
<span class="sd">        signature are used only if not overridden there. You can retrieve the default arguments using `slope.kwargs`.</span>


<span class="sd">    Returns:</span>
<span class="sd">        matplotlib.axes.Axes: The axes object used for plotting.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">modeldata</span><span class="p">,</span> <span class="n">axis_labels</span> <span class="o">=</span> <span class="n">slope_get_data</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">xkey</span><span class="p">,</span> <span class="n">ykey</span><span class="p">,</span>
                                                <span class="n">default_attrname</span><span class="o">=</span><span class="n">default_attrname</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">unit</span><span class="p">,</span>
                                                <span class="n">where</span><span class="o">=</span><span class="n">where</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">,</span> <span class="n">mask_na</span><span class="o">=</span><span class="n">mask_na</span><span class="p">,</span>
                                                <span class="n">kwargs</span><span class="o">=</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">slope_draw</span><span class="p">(</span><span class="n">modeldata</span><span class="p">,</span> <span class="n">axis_labels</span><span class="p">,</span> <span class="n">xycoord</span><span class="o">=</span><span class="n">xycoord</span><span class="p">,</span>
                   <span class="n">arrow</span><span class="o">=</span><span class="n">arrow</span><span class="p">,</span> <span class="n">arrow_position</span><span class="o">=</span><span class="n">arrow_position</span><span class="p">,</span>
                   <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                   <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span> <span class="n">update_ax</span><span class="o">=</span><span class="n">update_ax</span><span class="p">,</span> <span class="n">update_fig</span><span class="o">=</span><span class="n">update_fig</span><span class="p">,</span>
                   <span class="n">kwargs</span><span class="o">=</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="simple.update_axes" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">update_axes</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">update_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">update_ax</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">update_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Updates the axes and figure objects.</p>
<p>Keywords beginning with <code>ax_&lt;name&gt;</code>, <code>xax_&lt;name&gt;</code>, <code>yax_&lt;name&gt;</code> and <code>fig_&lt;name&gt;</code> will be stripped
from kwargs. These will then be used to call the <code>set_&lt;name&gt;</code> or <code>&lt;name&gt;</code> method of the axes, axis or
figure object.</p>
<p>If the value mapped to the above arguments is:
- A <code>bool</code> it is used to determine whether to call the method. The boolean itself will not be passed to
    the method.
- A <code>tuple</code> then the contents of the tuple is unpacked and used as arguments for the method call.
- A <code>dict</code> then the contents of the dictionary is unpacked and used as keyword arguments for the method call.
- Any other type of value will be passed as the first argument to the method call. To pass one of the above types
 as a single argument use a tuple, e.g. <code>(True, )</code>.</p>
<p>Additional keyword arguments can be passed to methods by mapping e.g. <code>&lt;ax|xax|yax|fig&gt;_kw_&lt;name&gt;_&lt;keyword&gt;</code>
kwargs to the value. These additional keyword arguments are only used if the
<code>&lt;ax|xax|yax|fig&gt;_&lt;name&gt;</code> kwargs exists.</p>
<p>The figure will not be updated if <code>ax</code> is a subplot created by <a class="autorefs autorefs-internal" href="../plotting/#simple.plotting.create_subplots">simple.create_subplots</a>.</p>

            <details class="quote">
              <summary>Source code in <code>simple/plotting.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span>
<span class="normal">955</span>
<span class="normal">956</span>
<span class="normal">957</span>
<span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span>
<span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span>
<span class="normal">967</span>
<span class="normal">968</span>
<span class="normal">969</span>
<span class="normal">970</span>
<span class="normal">971</span>
<span class="normal">972</span>
<span class="normal">973</span>
<span class="normal">974</span>
<span class="normal">975</span>
<span class="normal">976</span>
<span class="normal">977</span>
<span class="normal">978</span>
<span class="normal">979</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">update_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">update_ax</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">update_fig</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Updates the axes and figure objects.</span>

<span class="sd">    Keywords beginning with ``ax_&lt;name&gt;``, ``xax_&lt;name&gt;``, ``yax_&lt;name&gt;`` and ``fig_&lt;name&gt;`` will be stripped</span>
<span class="sd">    from kwargs. These will then be used to call the ``set_&lt;name&gt;`` or ``&lt;name&gt;`` method of the axes, axis or</span>
<span class="sd">    figure object.</span>

<span class="sd">    If the value mapped to the above arguments is:</span>
<span class="sd">    - A `bool` it is used to determine whether to call the method. The boolean itself will not be passed to</span>
<span class="sd">        the method.</span>
<span class="sd">    - A `tuple` then the contents of the tuple is unpacked and used as arguments for the method call.</span>
<span class="sd">    - A `dict` then the contents of the dictionary is unpacked and used as keyword arguments for the method call.</span>
<span class="sd">    - Any other type of value will be passed as the first argument to the method call. To pass one of the above types</span>
<span class="sd">     as a single argument use a tuple, e.g. `(True, )`.</span>

<span class="sd">    Additional keyword arguments can be passed to methods by mapping e.g. ``&lt;ax|xax|yax|fig&gt;_kw_&lt;name&gt;_&lt;keyword&gt;``</span>
<span class="sd">    kwargs to the value. These additional keyword arguments are only used if the</span>
<span class="sd">    ``&lt;ax|xax|yax|fig&gt;_&lt;name&gt;`` kwargs exists.</span>

<span class="sd">    The figure will not be updated if ``ax`` is a subplot created by [simple.create_subplots][simple.plotting.create_subplots].</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">ax</span> <span class="o">=</span> <span class="n">get_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">axes_meth</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop_many</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;ax&#39;</span><span class="p">)</span>
    <span class="n">axes_kw</span> <span class="o">=</span> <span class="n">axes_meth</span><span class="o">.</span><span class="n">pop_many</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;kw&#39;</span><span class="p">)</span>

    <span class="n">xaxes_meth</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop_many</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;xax&#39;</span><span class="p">)</span>
    <span class="n">xaxes_kw</span> <span class="o">=</span> <span class="n">xaxes_meth</span><span class="o">.</span><span class="n">pop_many</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;kw&#39;</span><span class="p">)</span>

    <span class="n">yaxes_meth</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop_many</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;yax&#39;</span><span class="p">)</span>
    <span class="n">yaxes_kw</span> <span class="o">=</span> <span class="n">yaxes_meth</span><span class="o">.</span><span class="n">pop_many</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;kw&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">update_ax</span><span class="p">:</span>
        <span class="n">_update_fig_or_ax</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="s1">&#39;ax&#39;</span><span class="p">,</span> <span class="n">axes_meth</span><span class="p">,</span> <span class="n">axes_kw</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">xaxes_meth</span><span class="p">:</span>
            <span class="n">_update_fig_or_ax</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="p">,</span> <span class="s1">&#39;xax&#39;</span><span class="p">,</span> <span class="n">xaxes_meth</span><span class="p">,</span> <span class="n">xaxes_kw</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">yaxes_meth</span><span class="p">:</span>
            <span class="n">_update_fig_or_ax</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="p">,</span> <span class="s1">&#39;yax&#39;</span><span class="p">,</span> <span class="n">yaxes_meth</span><span class="p">,</span> <span class="n">yaxes_kw</span><span class="p">)</span>

    <span class="c1"># Dont update figure if subplot was created using create subplots.</span>
    <span class="c1"># Figure stuff should be done there instead</span>
    <span class="n">update_figure</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_figure</span><span class="p">(),</span> <span class="n">kwargs</span><span class="p">,</span> <span class="n">update_fig</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="s1">&#39;_SIMPLE_subplot_dict&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="n">update_fig</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>