
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../simple/">
      
      
        <link rel="next" href="../norm/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.11">
    
    
      
        <title>simple.plotting - SIMPLE</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.4af4bdda.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#simpleplot" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="SIMPLE" class="md-header__button md-logo" aria-label="SIMPLE" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            SIMPLE
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              simple.plotting
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="SIMPLE" class="md-nav__button md-logo" aria-label="SIMPLE" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    SIMPLE
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    User Guide
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Tutorials
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/ccsne_tutorial1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 1 - Getting Started
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/ccsne_tutorial2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 2 - Normalising abundances
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/ccsne_tutorial3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 3 - Plotting
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Examples
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/create_simple_db/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Create CCSNe database
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/simple_mattias_version/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CCSNe Example
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/rose_diagram/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction to rose diagrams
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../simple/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    User Reference
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    simple.plotting
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    simple.plotting
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#simple.plotting.default_colors" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;simple.plotting.default_colors
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.plotting.default_linestyles" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;simple.plotting.default_linestyles
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.plotting.default_markers" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;simple.plotting.default_markers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.plotting.RoseAxes" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;RoseAxes
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" RoseAxes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#simple.plotting.RoseAxes.name" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.plotting.RoseAxes.axmline" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;axmline
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.plotting.RoseAxes.axrline" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;axrline
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.plotting.RoseAxes.clear" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;clear
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.plotting.RoseAxes.get_rres" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_rres
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.plotting.RoseAxes.get_xyscale" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_xyscale
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.plotting.RoseAxes.mcontour" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;mcontour
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.plotting.RoseAxes.merrorbar" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;merrorbar
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.plotting.RoseAxes.mhist" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;mhist
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.plotting.RoseAxes.mline" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;mline
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.plotting.RoseAxes.rlabel" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;rlabel
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.plotting.RoseAxes.set_colorbar" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;set_colorbar
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.plotting.RoseAxes.set_rres" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;set_rres
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.plotting.RoseAxes.set_xyscale" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;set_xyscale
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.plotting.RoseAxes.set_xysegment" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;set_xysegment
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.plotting.as0darray" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;as0darray
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.plotting.as1darray" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;as1darray
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.plotting.create_legend" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;create_legend
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.plotting.create_rose_plot" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;create_rose_plot
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.plotting.deg2rad" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;deg2rad
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.plotting.get_axes" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_axes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.plotting.get_cmap" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_cmap
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.plotting.get_data" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.plotting.get_models" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_models
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.plotting.mcontour" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;mcontour
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.plotting.mhist" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;mhist
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.plotting.parse_lscm" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;parse_lscm
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.plotting.plot" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;plot
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.plotting.plot_intnorm" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;plot_intnorm
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.plotting.plot_simplenorm" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;plot_simplenorm
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.plotting.plotm" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;plotm
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.plotting.rad2deg" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;rad2deg
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.plotting.update_axes" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;update_axes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.plotting.xy2deg" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;xy2deg
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.plotting.xy2rad" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;xy2rad
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../norm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    simple.norm
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    simple.models
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    simple.utils
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ccsne/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    simple.ccsne
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    About
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../license/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    License
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#simple.plotting.default_colors" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;simple.plotting.default_colors
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.plotting.default_linestyles" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;simple.plotting.default_linestyles
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.plotting.default_markers" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;simple.plotting.default_markers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.plotting.RoseAxes" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;RoseAxes
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" RoseAxes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#simple.plotting.RoseAxes.name" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.plotting.RoseAxes.axmline" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;axmline
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.plotting.RoseAxes.axrline" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;axrline
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.plotting.RoseAxes.clear" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;clear
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.plotting.RoseAxes.get_rres" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_rres
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.plotting.RoseAxes.get_xyscale" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_xyscale
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.plotting.RoseAxes.mcontour" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;mcontour
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.plotting.RoseAxes.merrorbar" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;merrorbar
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.plotting.RoseAxes.mhist" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;mhist
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.plotting.RoseAxes.mline" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;mline
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.plotting.RoseAxes.rlabel" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;rlabel
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.plotting.RoseAxes.set_colorbar" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;set_colorbar
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.plotting.RoseAxes.set_rres" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;set_rres
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.plotting.RoseAxes.set_xyscale" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;set_xyscale
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.plotting.RoseAxes.set_xysegment" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;set_xysegment
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.plotting.as0darray" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;as0darray
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.plotting.as1darray" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;as1darray
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.plotting.create_legend" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;create_legend
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.plotting.create_rose_plot" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;create_rose_plot
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.plotting.deg2rad" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;deg2rad
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.plotting.get_axes" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_axes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.plotting.get_cmap" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_cmap
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.plotting.get_data" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.plotting.get_models" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_models
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.plotting.mcontour" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;mcontour
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.plotting.mhist" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;mhist
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.plotting.parse_lscm" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;parse_lscm
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.plotting.plot" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;plot
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.plotting.plot_intnorm" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;plot_intnorm
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.plotting.plot_simplenorm" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;plot_simplenorm
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.plotting.plotm" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;plotm
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.plotting.rad2deg" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;rad2deg
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.plotting.update_axes" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;update_axes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.plotting.xy2deg" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;xy2deg
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.plotting.xy2rad" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;xy2rad
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="simpleplot">simple.plot</h1>
<p>a</p>


<div class="doc doc-object doc-module">




    <div class="doc doc-contents first">









  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h2 id="simple.plotting.default_colors" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">simple.plotting.default_colors</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">default_colors</span> <span class="o">=</span> <span class="n">EndlessList</span><span class="p">([</span><span class="s1">&#39;#D55E00&#39;</span><span class="p">,</span> <span class="s1">&#39;#56B4E9&#39;</span><span class="p">,</span> <span class="s1">&#39;#009E73&#39;</span><span class="p">,</span> <span class="s1">&#39;#E69F00&#39;</span><span class="p">,</span> <span class="s1">&#39;#CC79A7&#39;</span><span class="p">,</span> <span class="s1">&#39;#0072B2&#39;</span><span class="p">,</span> <span class="s1">&#39;#F0E442&#39;</span><span class="p">])</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>[<code>Endlesslist</code>][simple.plot.EndlessList] containing the default colors used by simple plotting functions.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="simple.plotting.default_linestyles" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">simple.plotting.default_linestyles</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">default_linestyles</span> <span class="o">=</span> <span class="n">EndlessList</span><span class="p">([</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))])</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>[<code>Endlesslist</code>][simple.plot.EndlessList] default line styles used by simple plotting functions.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="simple.plotting.default_markers" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">simple.plotting.default_markers</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">default_markers</span> <span class="o">=</span> <span class="n">EndlessList</span><span class="p">([</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;&#39;</span><span class="p">,</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">])</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>[<code>Endlesslist</code>][simple.plot.EndlessList] default marker styles used by simple plotting functions.</p>

    </div>

</div>


<div class="doc doc-object doc-class">



<h2 id="simple.plotting.RoseAxes" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">simple.plotting.RoseAxes</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">RoseAxes</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="matplotlib.projections.polar.PolarAxes">PolarAxes</span></code></p>


        <p>A subclass of matplotlibs <a href="https://matplotlib.org/stable/api/projections/polar.html#matplotlib.projections.polar.PolarAxes">Polar Axes</a>.</p>
<p>Rose plots can be created using the <a href="simple.plot.create_rose_plot">create_rose_plot</a> function or by
specifying the projection <code>'rose'</code> using matplotlib functions.</p>
<p>Only custom and reimplemented methods are described here. See matplotlibs documentation for more methods. Note
however, that these method might not behave as the reimplemented version below. For example the matplotlib methods
will not take into account the <code>xscale</code> and <code>yscale</code>.</p>
<p><strong>Note</strong> that some features, like axlines, might require an updated version of matplotlib to work.</p>







                  <details class="quote">
                    <summary>Source code in <code>simple/plotting.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_xysegment</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_yscale</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_xscale</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_rres</span> <span class="o">=</span> <span class="mi">720</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_vrel</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vmin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vmax</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_norm</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_vmax</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_cmap</span> <span class="o">=</span> <span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;turbo&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_colorbar</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span>
                     <span class="n">theta_offset</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">theta_direction</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
                     <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">labelleft</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">labelright</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;out&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">margins</span><span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="simple.plotting.RoseAxes.name" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">name</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;rose&#39;</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="simple.plotting.RoseAxes.axmline" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">axmline</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">axmline</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">merr</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">eline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">elinestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">elinewidth</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ezorder</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">antipodal</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Draw a line along a slope.</p>
<p>Used matplotlibs <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.axvline.html">axvline</a> method
to draw the line(s).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>m</code></b>
              (<code>float, (float, float</code>)
          –
          <div class="doc-md-description">
            <p>Either a single slope or a tuple of <em>x</em> and <em>y</em>
coordinates from which a slope will be calculated.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>r</code></b>
              (<code>float, (float, float</code>, default:
                  <code>1</code>
)
          –
          <div class="doc-md-description">
            <p>If a single value is given a line will be drawn between the <code>0</code> and <code>r</code>.
if a tuple of two values are given the line will be drawn between <code>r[0]</code> and <code>r[1]</code>. Note these
are relative coordinates.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>merr</code></b>
          –
          <div class="doc-md-description">
            <p>The uncertainty of the slope.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>eline</code></b>
          –
          <div class="doc-md-description">
            <p>If <code>True</code> lines will also be drawn for the uncertainty of the slope.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>ecolor</code></b>
          –
          <div class="doc-md-description">
            <p>The color used for the uncertainty lines.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>elinestyle</code></b>
          –
          <div class="doc-md-description">
            <p>The line style used for the uncertainty lines.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>elinewidth</code></b>
          –
          <div class="doc-md-description">
            <p>The line width used for the uncertainty lines.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>ezorder</code></b>
          –
          <div class="doc-md-description">
            <p>The z order width used for the uncertainty lines.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>antipodal</code></b>
          –
          <div class="doc-md-description">
            <p>Whether the antipodal data points will be drawn. By default, <code>antipodal=True</code> when <code>m</code> is
a slope and <code>antipodal=False</code> when <code>m</code> is <em>x,y</em> coordinates.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>**kwargs</code></b>
          –
          <div class="doc-md-description">
            <p>Additional keyword arguments passed to matplotlibs
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.axvline.html">axvline</a> method.</p>
          </div>
        </li>
    </ul>


            <details class="quote">
              <summary>Source code in <code>simple/plotting.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">axmline</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">merr</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">eline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">ecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">elinestyle</span><span class="o">=</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="n">elinewidth</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ezorder</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">antipodal</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Draw a line along a slope.</span>

<span class="sd">    Used matplotlibs [axvline](https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.axvline.html) method</span>
<span class="sd">    to draw the line(s).</span>

<span class="sd">    Args:</span>
<span class="sd">        m (float, (float, float)): Either a single slope or a tuple of *x* and *y*</span>
<span class="sd">            coordinates from which a slope will be calculated.</span>
<span class="sd">        r (float, (float, float)): If a single value is given a line will be drawn between the ``0`` and ``r``.</span>
<span class="sd">            if a tuple of two values are given the line will be drawn between ``r[0]`` and ``r[1]``. Note these</span>
<span class="sd">            are relative coordinates.</span>
<span class="sd">        merr (): The uncertainty of the slope.</span>
<span class="sd">        eline (): If ``True`` lines will also be drawn for the uncertainty of the slope.</span>
<span class="sd">        ecolor (): The color used for the uncertainty lines.</span>
<span class="sd">        elinestyle (): The line style used for the uncertainty lines.</span>
<span class="sd">        elinewidth (): The line width used for the uncertainty lines.</span>
<span class="sd">        ezorder (): The z order width used for the uncertainty lines.</span>
<span class="sd">        antipodal (): Whether the antipodal data points will be drawn. By default, ``antipodal=True`` when ``m`` is</span>
<span class="sd">            a slope and ``antipodal=False`` when ``m`` is *x,y* coordinates.</span>
<span class="sd">        **kwargs (): Additional keyword arguments passed to matplotlibs</span>
<span class="sd">            [axvline](https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.axvline.html) method.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mline</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">merr</span><span class="p">,</span>
                       <span class="n">ecolor</span><span class="o">=</span><span class="n">ecolor</span><span class="p">,</span> <span class="n">elinestyle</span><span class="o">=</span><span class="n">elinestyle</span><span class="p">,</span> <span class="n">elinewidth</span><span class="o">=</span><span class="n">elinewidth</span><span class="p">,</span>
                       <span class="n">ezorder</span><span class="o">=</span><span class="n">ezorder</span><span class="p">,</span> <span class="n">ealpha</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">eline</span><span class="o">=</span><span class="n">eline</span><span class="p">,</span> <span class="n">efill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                       <span class="n">antipodal</span><span class="o">=</span><span class="n">antipodal</span><span class="p">,</span> <span class="n">axline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="simple.plotting.RoseAxes.axrline" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">axrline</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">axrline</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">tmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">tmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Plot a line along a given radius.</p>
<p>Used matplotlibs <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.axhline.html">axhline</a> method
to draw the line.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>r</code></b>
          –
          <div class="doc-md-description">
            <p>The radius at which to draw the line.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>tmin</code></b>
          –
          <div class="doc-md-description">
            <p>The starting angle of the line. In relative coordinates.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>tmax</code></b>
          –
          <div class="doc-md-description">
            <p>The stopping angle of the line. In relative coordinates.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>**kwargs</code></b>
          –
          <div class="doc-md-description">
            <p>Additional keyword arguments passed to matplotlibs
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.axhline.html">axhline</a> method.</p>
          </div>
        </li>
    </ul>
        <p>Returns:</p>


            <details class="quote">
              <summary>Source code in <code>simple/plotting.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">axrline</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">tmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">tmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot a line along a given radius.</span>

<span class="sd">    Used matplotlibs [axhline](https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.axhline.html) method</span>
<span class="sd">    to draw the line.</span>

<span class="sd">    Args:</span>
<span class="sd">        r (): The radius at which to draw the line.</span>
<span class="sd">        tmin (): The starting angle of the line. In relative coordinates.</span>
<span class="sd">        tmax (): The stopping angle of the line. In relative coordinates.</span>
<span class="sd">        **kwargs (): Additional keyword arguments passed to matplotlibs</span>
<span class="sd">            [axhline](https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.axhline.html) method.</span>

<span class="sd">    Returns:</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">tmin</span><span class="p">,</span> <span class="n">tmax</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="simple.plotting.RoseAxes.clear" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">clear</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">clear</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Clear the ax.</p>


            <details class="quote">
              <summary>Source code in <code>simple/plotting.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Clear the ax.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_last_hist_r</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># Grid stuff</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">set_rlim</span><span class="p">(</span><span class="n">rmin</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">set_rticks</span><span class="p">([],</span> <span class="n">minor</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">set_rticks</span><span class="p">([],</span> <span class="n">minor</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># Segment</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">set_xysegment</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_xysegment</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="simple.plotting.RoseAxes.get_rres" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">get_rres</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_rres</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Return the resolution of lines drawn along the radius <code>r</code>.</p>


            <details class="quote">
              <summary>Source code in <code>simple/plotting.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_rres</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the resolution of lines drawn along the radius ``r``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rres</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="simple.plotting.RoseAxes.get_xyscale" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">get_xyscale</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_xyscale</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Return a tuple of the scale of the <em>x</em> and <em>y</em> dimensions of the rose diagram.</p>


            <details class="quote">
              <summary>Source code in <code>simple/plotting.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_xyscale</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a tuple of the scale of the *x* and *y* dimensions of the rose diagram.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_xscale</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_yscale</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="simple.plotting.RoseAxes.mcontour" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">mcontour</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">mcontour</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">rwidth</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">rscale</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">rescale</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">antipodal</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">update_rticks</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">minor_rticks</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">72</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bar_outline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>simple/plotting.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">mcontour</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">rwidth</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">rscale</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
             <span class="n">rescale</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">antipodal</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">update_rticks</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">minor_rticks</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
             <span class="n">bins</span><span class="o">=</span><span class="mi">72</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bar_outline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
             <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">r</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_hist_r</span>
        <span class="k">if</span> <span class="n">r</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="n">r</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_last_hist_r</span> <span class="o">=</span> <span class="n">r</span>

    <span class="n">bin_weights</span><span class="p">,</span> <span class="n">bin_edges</span><span class="p">,</span> <span class="n">bin_heights</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mbins</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">rwidth</span><span class="p">,</span> <span class="n">rscale</span><span class="p">,</span> <span class="n">rescale</span><span class="p">,</span> <span class="n">antipodal</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span>
                                                      <span class="n">update_rticks</span><span class="p">,</span> <span class="n">minor_rticks</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">bar_outline</span><span class="p">:</span>
        <span class="n">theta_</span><span class="p">,</span> <span class="n">r_</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">bin_weights</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>
            <span class="n">theta_</span> <span class="o">+=</span> <span class="p">[</span><span class="n">bin_edges</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">bin_edges</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]]</span>
            <span class="n">r_</span> <span class="o">+=</span> <span class="p">[</span><span class="n">r</span> <span class="o">+</span> <span class="n">bin_heights</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">r</span> <span class="o">+</span> <span class="n">bin_heights</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
        <span class="n">theta_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">theta_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">r_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">theta_</span> <span class="o">=</span> <span class="p">[(</span><span class="n">bin_edges</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">bin_edges</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">bin_weights</span><span class="o">.</span><span class="n">size</span><span class="p">)]</span>
        <span class="n">r_</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span> <span class="o">+</span> <span class="n">bin_heights</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">bin_weights</span><span class="o">.</span><span class="n">size</span><span class="p">)]</span>
        <span class="n">theta_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">theta_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">r_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">theta_</span><span class="p">,</span> <span class="n">r_</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="simple.plotting.RoseAxes.merrorbar" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">merrorbar</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">merrorbar</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">merr</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">antipodal</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Plot data points with errorbars.</p>
<p>This is an adapted version of matplotlibs
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.errorbar.html">errorbar</a> method.</p>
<p><strong>Note</strong> it is currently not possible to add bar ends to the error bars.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>m</code></b>
              (<code>float, (float, float</code>)
          –
          <div class="doc-md-description">
            <p>Either a single array of floats representing a slope or a tuple of <em>x</em> and <em>y</em>
coordinates from which a slope will be calculated.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>r</code></b>
          –
          <div class="doc-md-description">
            <p>The radius at which the data points will be drawn.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>merr</code></b>
          –
          <div class="doc-md-description">
            <p>The uncertainty of the slope.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>antipodal</code></b>
          –
          <div class="doc-md-description">
            <p>Whether the antipodal data points will be drawn. By default, <code>antipodal=True</code> when <code>m</code> is
a slope and <code>antipodal=False</code> when <code>m</code> is <em>x,y</em> coordinates.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>**kwargs</code></b>
          –
          <div class="doc-md-description">
            <p>Additional keyword arguments passed to matplotlibs</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>[errorbar](https</code></b>
          –
          <div class="doc-md-description">
            <p>//matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.errorbar.html) method.</p>
          </div>
        </li>
    </ul>


            <details class="quote">
              <summary>Source code in <code>simple/plotting.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">merrorbar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">merr</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
              <span class="n">antipodal</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
              <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot data points with errorbars.</span>

<span class="sd">    This is an adapted version of matplotlibs</span>
<span class="sd">    [errorbar](https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.errorbar.html) method.</span>

<span class="sd">    **Note** it is currently not possible to add bar ends to the error bars.</span>

<span class="sd">    Args:</span>
<span class="sd">        m (float, (float, float)): Either a single array of floats representing a slope or a tuple of *x* and *y*</span>
<span class="sd">            coordinates from which a slope will be calculated.</span>
<span class="sd">        r (): The radius at which the data points will be drawn.</span>
<span class="sd">        merr (): The uncertainty of the slope.</span>
<span class="sd">        antipodal (): Whether the antipodal data points will be drawn. By default, ``antipodal=True`` when ``m`` is</span>
<span class="sd">            a slope and ``antipodal=False`` when ``m`` is *x,y* coordinates.</span>
<span class="sd">        **kwargs (): Additional keyword arguments passed to matplotlibs</span>
<span class="sd">        [errorbar](https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.errorbar.html) method.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;linestyle&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;marker&#39;</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">tuple</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">m</span>
        <span class="k">if</span> <span class="n">antipodal</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">antipodal</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">m</span>
        <span class="k">if</span> <span class="n">antipodal</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">antipodal</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">merr</span> <span class="o">=</span> <span class="n">as1darray</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">merr</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">merr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Makes errorbar show up in legend</span>
        <span class="n">yerr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">yerr</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;capsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Because we cannot show these</span>
    <span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
        <span class="c1"># Supresses warning that comes from having yerr as nan</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s1">&#39;All-NaN axis encountered&#39;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">RuntimeWarning</span><span class="p">)</span>
        <span class="n">data_line</span><span class="p">,</span> <span class="n">caplines</span><span class="p">,</span> <span class="n">barlinecols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_xy2rad</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">r</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">yerr</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="c1"># print(len(barlinecols), barlinecols, barlinecols[0].get_colors(), barlinecols[0].get_linewidth())</span>
    <span class="k">if</span> <span class="n">merr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="n">barlinecols</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_colors</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">colors</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">*</span> <span class="n">x</span><span class="o">.</span><span class="n">size</span>

        <span class="n">linestyles</span> <span class="o">=</span> <span class="n">barlinecols</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_linestyles</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">linestyles</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="n">linestyles</span> <span class="o">=</span> <span class="p">[</span><span class="n">linestyles</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">*</span> <span class="n">x</span><span class="o">.</span><span class="n">size</span>

        <span class="n">linewidths</span> <span class="o">=</span> <span class="n">barlinecols</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_linewidths</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">linewidths</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="n">linewidths</span> <span class="o">=</span> <span class="p">[</span><span class="n">linewidths</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">*</span> <span class="n">x</span><span class="o">.</span><span class="n">size</span>

        <span class="n">zorder</span> <span class="o">=</span> <span class="n">barlinecols</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_zorder</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_rplot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_xy2rad</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="p">(</span><span class="n">m</span> <span class="o">+</span> <span class="n">merr</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xy2rad</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="p">(</span><span class="n">m</span> <span class="o">-</span> <span class="n">merr</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                        <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">linestyle</span><span class="o">=</span><span class="n">linestyles</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidths</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                        <span class="n">zorder</span><span class="o">=</span><span class="n">zorder</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">antipodal</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;color&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">merrorbar</span><span class="p">((</span><span class="n">x</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">y</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">r</span><span class="p">,</span> <span class="n">merr</span><span class="o">=</span><span class="n">merr</span><span class="p">,</span> <span class="n">antipodal</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">data_line</span><span class="o">.</span><span class="n">get_color</span><span class="p">(),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="simple.plotting.RoseAxes.mhist" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">mhist</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">mhist</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">rwidth</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">rscale</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">rescale</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">antipodal</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">update_rticks</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">minor_rticks</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">72</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Create a histogram of the given slopes.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>m</code></b>
              (<code>float, (float, float</code>)
          –
          <div class="doc-md-description">
            <p>Either a single array of floats representing a slope or a tuple of <em>x</em> and <em>y</em>
coordinates from which a slope will be calculated.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>r</code></b>
          –
          <div class="doc-md-description">
            <p>The radius at which the histogram will be drawn. If 'None' it will be plotted <code>1</code> above the
previous histogram, or at 1 if no histogram have been drawn.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>weights</code></b>
          –
          <div class="doc-md-description">
            <p>The weight assigned to each slope.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>rwidth</code></b>
          –
          <div class="doc-md-description">
            <p>The width of the histogram.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>rscale</code></b>
          –
          <div class="doc-md-description">
            <p>If <code>True</code> width of the individual bins will be scaled to their weight. Otherwise all bins
will have the same width.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>rescale</code></b>
          –
          <div class="doc-md-description">
            <p>If <code>True</code> all bin widths will be scaled relative to the heaviest bin. Otherwise, they will
be scaled to the color map.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>antipodal</code></b>
          –
          <div class="doc-md-description">
            <p>Whether the antipodal data points will be included in the histogram. By default,</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>bins</code></b>
          –
          <div class="doc-md-description">
            <p>The number of even sized bin in the histogram.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>label</code></b>
          –
          <div class="doc-md-description">
            <p>A label for the histogram.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>label_pos</code></b>
          –
          <div class="doc-md-description">
            <p>The position of the label in the histogram. In degrees.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>label_roffset</code></b>
          –
          <div class="doc-md-description">
            <p>The offset from <code>r</code> where the label will be shown. By default, <code>rwidth/2</code>.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>label_kwargs</code></b>
          –
          <div class="doc-md-description">
            <p>A dictionary with additional keyword arguments passed to matplotlibs
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Annotate.html">annotate</a> method which is
used to draw the label.</p>
          </div>
        </li>
    </ul>


            <details class="quote">
              <summary>Source code in <code>simple/plotting.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">mhist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">rwidth</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">rscale</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
          <span class="n">rescale</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">antipodal</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">update_rticks</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">minor_rticks</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
          <span class="n">bins</span><span class="o">=</span><span class="mi">72</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a histogram of the given slopes.</span>

<span class="sd">    Args:</span>
<span class="sd">        m (float, (float, float)): Either a single array of floats representing a slope or a tuple of *x* and *y*</span>
<span class="sd">            coordinates from which a slope will be calculated.</span>
<span class="sd">        r (): The radius at which the histogram will be drawn. If &#39;None&#39; it will be plotted ``1`` above the</span>
<span class="sd">            previous histogram, or at 1 if no histogram have been drawn.</span>
<span class="sd">        weights (): The weight assigned to each slope.</span>
<span class="sd">        rwidth (): The width of the histogram.</span>
<span class="sd">        rscale (): If ``True`` width of the individual bins will be scaled to their weight. Otherwise all bins</span>
<span class="sd">            will have the same width.</span>
<span class="sd">        rescale (): If ``True`` all bin widths will be scaled relative to the heaviest bin. Otherwise, they will</span>
<span class="sd">            be scaled to the color map.</span>
<span class="sd">        antipodal (): Whether the antipodal data points will be included in the histogram. By default,</span>
<span class="sd">        ``antipodal=True`` when ``m`` is a slope and ``antipodal=False`` when ``m`` is *x,y* coordinates.</span>
<span class="sd">        bins (): The number of even sized bin in the histogram.</span>
<span class="sd">        label (): A label for the histogram.</span>
<span class="sd">        label_pos (): The position of the label in the histogram. In degrees.</span>
<span class="sd">        label_roffset (): The offset from ``r`` where the label will be shown. By default, ``rwidth/2``.</span>
<span class="sd">        label_kwargs (): A dictionary with additional keyword arguments passed to matplotlibs</span>
<span class="sd">            [annotate](https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Annotate.html) method which is</span>
<span class="sd">            used to draw the label.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">r</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_hist_r</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_last_hist_r</span> <span class="o">=</span> <span class="n">r</span>

    <span class="n">rlabel_kwargs</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">extract_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;rlabel&#39;</span><span class="p">)</span>

    <span class="n">bin_weights</span><span class="p">,</span> <span class="n">bin_edges</span><span class="p">,</span> <span class="n">bin_heights</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mbins</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">rwidth</span><span class="p">,</span> <span class="n">rscale</span><span class="p">,</span> <span class="n">rescale</span><span class="p">,</span> <span class="n">antipodal</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span>
                                                      <span class="n">update_rticks</span><span class="p">,</span> <span class="n">minor_rticks</span><span class="p">)</span>

    <span class="n">bin_colors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_cmap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_norm</span><span class="p">(</span><span class="n">bw</span><span class="p">))</span> <span class="k">for</span> <span class="n">bw</span> <span class="ow">in</span> <span class="n">bin_weights</span><span class="p">])</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">bin_weights</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rfill</span><span class="p">(</span><span class="n">bin_edges</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">bin_edges</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="n">r</span><span class="p">,</span> <span class="n">r</span> <span class="o">+</span> <span class="n">bin_heights</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="n">bin_colors</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">label</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rlabel</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">r</span><span class="o">+</span><span class="n">rwidth</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="o">**</span><span class="n">rlabel_kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="simple.plotting.RoseAxes.mline" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">mline</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">mline</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">merr</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">antipodal</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">eline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">efill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">elinestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">elinewidth</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ezorder</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ealpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Draw a line along a slope.</p>
<p>Used matplotlibs <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.plot.html">plot</a> method to
draw the line(s).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>m</code></b>
              (<code>float, (float, float</code>)
          –
          <div class="doc-md-description">
            <p>Either a single slope or a tuple of <em>x</em> and <em>y</em>
coordinates from which a slope will be calculated.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>r</code></b>
              (<code>float, (float, float</code>, default:
                  <code>1</code>
)
          –
          <div class="doc-md-description">
            <p>If a single value is given a line will be drawn between the <code>0</code> and <code>r</code>.
if a tuple of two values are given the line will be drawn between <code>r[0]</code> and <code>r[1]</code>. Note these
are absolute coordinates.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>merr</code></b>
          –
          <div class="doc-md-description">
            <p>The uncertainty of the slope.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>eline</code></b>
          –
          <div class="doc-md-description">
            <p>If <code>True</code> lines will also be drawn for the uncertainty of the slope.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>efill</code></b>
          –
          <div class="doc-md-description">
            <p>If <code>True</code> the area defined by the uncertainty of the slope will be shaded.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>ecolor</code></b>
          –
          <div class="doc-md-description">
            <p>The color used for the uncertainty lines and/or the shaded area.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>elinestyle</code></b>
          –
          <div class="doc-md-description">
            <p>The line style used for the uncertainty lines.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>elinewidth</code></b>
          –
          <div class="doc-md-description">
            <p>The line width used for the uncertainty lines.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>ezorder</code></b>
          –
          <div class="doc-md-description">
            <p>The z order width used for the uncertainty lines.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>ealpha</code></b>
          –
          <div class="doc-md-description">
            <p>The alpha value for the shaded area.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>antipodal</code></b>
          –
          <div class="doc-md-description">
            <p>Whether the antipodal data points will be drawn. By default, <code>antipodal=True</code> when <code>m</code> is
a slope and <code>antipodal=False</code> when <code>m</code> is <em>x,y</em> coordinates.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>**kwargs</code></b>
          –
          <div class="doc-md-description">
            <p>Additional keyword arguments passed to matplotlibs
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.plot.html">plot</a> method.</p>
          </div>
        </li>
    </ul>


            <details class="quote">
              <summary>Source code in <code>simple/plotting.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">mline</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">merr</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">antipodal</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">eline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">efill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
          <span class="n">ecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">elinestyle</span><span class="o">=</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="n">elinewidth</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ezorder</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ealpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
          <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Draw a line along a slope.</span>

<span class="sd">    Used matplotlibs [plot](https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.plot.html) method to</span>
<span class="sd">    draw the line(s).</span>

<span class="sd">    Args:</span>
<span class="sd">        m (float, (float, float)): Either a single slope or a tuple of *x* and *y*</span>
<span class="sd">            coordinates from which a slope will be calculated.</span>
<span class="sd">        r (float, (float, float)): If a single value is given a line will be drawn between the ``0`` and ``r``.</span>
<span class="sd">            if a tuple of two values are given the line will be drawn between ``r[0]`` and ``r[1]``. Note these</span>
<span class="sd">            are absolute coordinates.</span>
<span class="sd">        merr (): The uncertainty of the slope.</span>
<span class="sd">        eline (): If ``True`` lines will also be drawn for the uncertainty of the slope.</span>
<span class="sd">        efill (): If ``True`` the area defined by the uncertainty of the slope will be shaded.</span>
<span class="sd">        ecolor (): The color used for the uncertainty lines and/or the shaded area.</span>
<span class="sd">        elinestyle (): The line style used for the uncertainty lines.</span>
<span class="sd">        elinewidth (): The line width used for the uncertainty lines.</span>
<span class="sd">        ezorder (): The z order width used for the uncertainty lines.</span>
<span class="sd">        ealpha (): The alpha value for the shaded area.</span>
<span class="sd">        antipodal (): Whether the antipodal data points will be drawn. By default, ``antipodal=True`` when ``m`` is</span>
<span class="sd">            a slope and ``antipodal=False`` when ``m`` is *x,y* coordinates.</span>
<span class="sd">        **kwargs (): Additional keyword arguments passed to matplotlibs</span>
<span class="sd">            [plot](https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.plot.html) method.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;linestyle&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mline</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">merr</span><span class="p">,</span>
                       <span class="n">ecolor</span><span class="o">=</span><span class="n">ecolor</span><span class="p">,</span> <span class="n">elinestyle</span><span class="o">=</span><span class="n">elinestyle</span><span class="p">,</span> <span class="n">elinewidth</span><span class="o">=</span><span class="n">elinewidth</span><span class="p">,</span>
                       <span class="n">ezorder</span><span class="o">=</span><span class="n">ezorder</span><span class="p">,</span> <span class="n">ealpha</span><span class="o">=</span><span class="n">ealpha</span><span class="p">,</span> <span class="n">efill</span><span class="o">=</span><span class="n">efill</span><span class="p">,</span> <span class="n">eline</span><span class="o">=</span><span class="n">eline</span><span class="p">,</span>
                       <span class="n">antipodal</span><span class="o">=</span><span class="n">antipodal</span><span class="p">,</span> <span class="n">axline</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="simple.plotting.RoseAxes.rlabel" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">rlabel</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">rlabel</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">deg</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>simple/plotting.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">rlabel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">deg</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">rotation</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">deg</span> <span class="o">=</span> <span class="n">deg</span> <span class="o">%</span> <span class="mi">360</span>

    <span class="k">if</span> <span class="n">rotation</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rotation</span> <span class="o">=</span> <span class="n">deg</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">if</span> <span class="n">deg</span> <span class="o">&gt;</span> <span class="mi">90</span> <span class="ow">and</span> <span class="n">deg</span> <span class="o">&lt;</span> <span class="mi">270</span><span class="p">:</span>
            <span class="n">rotation</span> <span class="o">=</span> <span class="p">(</span><span class="n">rotation</span> <span class="o">+</span> <span class="mi">180</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span>

    <span class="n">label_kw</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="n">text</span><span class="p">,</span> <span class="s1">&#39;xy&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">deg</span><span class="p">),</span> <span class="n">r</span><span class="p">),</span>
                <span class="s1">&#39;ha&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="s1">&#39;va&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="s1">&#39;rotation&#39;</span><span class="p">:</span> <span class="n">rotation</span><span class="p">}</span>
    <span class="n">label_kw</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="o">**</span><span class="n">label_kw</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="simple.plotting.RoseAxes.set_colorbar" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">set_colorbar</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">set_colorbar</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;turbo&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">clear</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Define the colorbar used for histograms.</p>
<p>Currently, there is no way to delete any existing colorbars. Thus, everytime this function is called a new
colorbar is created. Therefore, It's advisable to only call this method once. Note that it is always called
by the <a href="simple.plot.create_rose_plot">create_rose_plot</a> function.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>vmin</code></b>
              (<code><span title="float">float</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>The lower limit of the colour map. If no value is given the minimum value is <code>0</code> (or <code>1E-10</code> if
<code>log=True</code>)</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>vmax</code></b>
              (<code><span title="float">float</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>The upper limit of the colour map. If no value is given then <code>vmax</code> is set to <code>1</code> and all bin
default_weight are divided by the heaviest bin weight in each histogram.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>log</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>Whether the color map scale is logarithmic or not.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>cmap</code></b>
          –
          <div class="doc-md-description">
            <p>The prefixes of the colormap to use. See,
[matplotlib documentation][https://matplotlib.org/stable/users/explain/colors/colormaps.html]
for a list of available colormaps.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>label</code></b>
          –
          <div class="doc-md-description">
            <p>The label given to the colorbar.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>fontsize</code></b>
          –
          <div class="doc-md-description">
            <p>The fontsize of the colorbar label.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>show</code></b>
          –
          <div class="doc-md-description">
            <p>Whether to add a colorbar to the figure.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>ax</code></b>
          –
          <div class="doc-md-description">
            <p>The axis where the colorbar is drawn. If <code>None</code> it will be drawn on the right of the current axes.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>clear</code></b>
          –
          <div class="doc-md-description">
            <p>If <code>True</code> the current axes will be cleared.</p>
          </div>
        </li>
    </ul>


            <details class="quote">
              <summary>Source code in <code>simple/plotting.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">set_colorbar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;turbo&#39;</span><span class="p">,</span>
                 <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">clear</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Define the colorbar used for histograms.</span>

<span class="sd">    Currently, there is no way to delete any existing colorbars. Thus, everytime this function is called a new</span>
<span class="sd">    colorbar is created. Therefore, It&#39;s advisable to only call this method once. Note that it is always called</span>
<span class="sd">    by the [create_rose_plot](simple.plot.create_rose_plot) function.</span>

<span class="sd">    Args:</span>
<span class="sd">        vmin (float): The lower limit of the colour map. If no value is given the minimum value is ``0`` (or ``1E-10`` if</span>
<span class="sd">            ``log=True``)</span>
<span class="sd">        vmax (float): The upper limit of the colour map. If no value is given then ``vmax`` is set to ``1`` and all bin</span>
<span class="sd">            default_weight are divided by the heaviest bin weight in each histogram.</span>
<span class="sd">        log (bool): Whether the color map scale is logarithmic or not.</span>
<span class="sd">        cmap (): The prefixes of the colormap to use. See,</span>
<span class="sd">            [matplotlib documentation][https://matplotlib.org/stable/users/explain/colors/colormaps.html]</span>
<span class="sd">            for a list of available colormaps.</span>
<span class="sd">        label (): The label given to the colorbar.</span>
<span class="sd">        fontsize (): The fontsize of the colorbar label.</span>
<span class="sd">        show (): Whether to add a colorbar to the figure.</span>
<span class="sd">        ax (): The axis where the colorbar is drawn. If ``None`` it will be drawn on the right of the current axes.</span>
<span class="sd">        clear (): If ``True`` the current axes will be cleared.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_vrel</span> <span class="o">=</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">vmax</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="n">log</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vmin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vmax</span> <span class="o">=</span> <span class="n">vmin</span> <span class="ow">or</span> <span class="mf">1E-10</span><span class="p">,</span> <span class="n">vmax</span> <span class="ow">or</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_norm</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">LogNorm</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_vmax</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vmin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vmax</span> <span class="o">=</span> <span class="n">vmin</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span> <span class="ow">or</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_norm</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_vmax</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_cmap</span> <span class="o">=</span> <span class="n">get_cmap</span><span class="p">(</span><span class="n">cmap</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_colorbar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_figure</span><span class="p">()</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="p">(</span><span class="n">norm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_norm</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_cmap</span><span class="p">),</span>
                                                    <span class="n">ax</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">cax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_colorbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">clear</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="simple.plotting.RoseAxes.set_rres" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">set_rres</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">set_rres</span><span class="p">(</span><span class="n">rres</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Set the resolution of lines drawn along the radius <code>r</code>. The number of points in a line is calculated as
<code>r*rres+1</code> (Min. 2).</p>


            <details class="quote">
              <summary>Source code in <code>simple/plotting.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">set_rres</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rres</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set the resolution of lines drawn along the radius ``r``. The number of points in a line is calculated as</span>
<span class="sd">    ``r*rres+1`` (Min. 2).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_rres</span> <span class="o">=</span> <span class="n">rres</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="simple.plotting.RoseAxes.set_xyscale" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">set_xyscale</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">set_xyscale</span><span class="p">(</span><span class="n">xscale</span><span class="p">,</span> <span class="n">yscale</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Set the scale of the <em>x</em> and <em>y</em> dimensions of the rose diagram.</p>
<p>This can be used to distort the diagram to e.g. better show large or small slopes.</p>
<p><strong>Note</strong> Should not be confused with matplotlibs <code>set_xscale</code> and the <code>set_yscale</code> methods. They have
are used to set the type of scale, e.g. log, linear etc., used for the different axis.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>xscale</code></b>
              (<code><span title="float">float</span></code>)
          –
          <div class="doc-md-description">
            <p>The scale of the <em>x</em> dimension of the rose diagram.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>yscale</code></b>
              (<code><span title="float">float</span></code>)
          –
          <div class="doc-md-description">
            <p>The scale of the <em>y</em> dimension of the rose diagram.</p>
          </div>
        </li>
    </ul>


            <details class="quote">
              <summary>Source code in <code>simple/plotting.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">set_xyscale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xscale</span><span class="p">,</span> <span class="n">yscale</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set the scale of the *x* and *y* dimensions of the rose diagram.</span>

<span class="sd">    This can be used to distort the diagram to e.g. better show large or small slopes.</span>

<span class="sd">    **Note** Should not be confused with matplotlibs ``set_xscale`` and the ``set_yscale`` methods. They have</span>
<span class="sd">    are used to set the type of scale, e.g. log, linear etc., used for the different axis.</span>

<span class="sd">    Args:</span>
<span class="sd">        xscale (float): The scale of the *x* dimension of the rose diagram.</span>
<span class="sd">        yscale (float): The scale of the *y* dimension of the rose diagram.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Not to be confused with set_xscale. This does something different.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_xscale</span> <span class="o">=</span> <span class="n">xscale</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_yscale</span> <span class="o">=</span> <span class="n">yscale</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="simple.plotting.RoseAxes.set_xysegment" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">set_xysegment</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">set_xysegment</span><span class="p">(</span><span class="n">segment</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Define which segment of the rose diagram to show.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>segment</code></b>
          –
          <div class="doc-md-description">
            <p>Options are <code>N</code>, <code>E</code>, <code>S</code>, <code>W</code>, <code>None</code>.
If <code>None</code> the entire circle is shown.</p>
          </div>
        </li>
    </ul>


            <details class="quote">
              <summary>Source code in <code>simple/plotting.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">set_xysegment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">segment</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Define which segment of the rose diagram to show.</span>

<span class="sd">    Args:</span>
<span class="sd">        segment (): Options are ``N``, ``E``, ``S``, ``W``, ``None``.</span>
<span class="sd">            If ``None`` the entire circle is shown.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">segment</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">set_thetagrids</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">270</span><span class="p">),</span>
                                 <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_yscale</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xscale</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_yscale</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xscale</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">segment</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;segment must be a string&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">segment</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;N&#39;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">set_thetalim</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">set_thetagrids</span><span class="p">((</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">_xscale</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_yscale</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xscale</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">segment</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;S&#39;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">set_thetalim</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mf">1.5</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">set_thetagrids</span><span class="p">((</span><span class="mi">90</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">270</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">_xscale</span><span class="p">,</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">_yscale</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xscale</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">segment</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;E&#39;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">set_thetalim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">set_thetagrids</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">180</span><span class="p">),</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_yscale</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xscale</span><span class="p">,</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">_yscale</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">segment</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;W&#39;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">set_thetalim</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">set_thetagrids</span><span class="p">((</span><span class="mi">180</span><span class="p">,</span> <span class="mi">270</span><span class="p">,</span> <span class="mi">360</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">_yscale</span><span class="p">,</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">_xscale</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_yscale</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Unknown segment: </span><span class="si">{</span><span class="n">segment</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_xysegment</span> <span class="o">=</span> <span class="n">segment</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="simple.plotting.as0darray" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">simple.plotting.as0darray</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">as0darray</span><span class="p">(</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>simple/plotting.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">as0darray</span><span class="p">(</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">):</span>
    <span class="n">out</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">a</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">out</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">o</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">o</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">o</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Size of arrays must be 1&#39;</span><span class="p">)</span>

    <span class="n">out</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">o</span> <span class="k">if</span> <span class="p">(</span><span class="n">o</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">o</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">else</span> <span class="n">o</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">tuple</span><span class="p">())</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">out</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">out</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="simple.plotting.as1darray" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">simple.plotting.as1darray</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">as1darray</span><span class="p">(</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>simple/plotting.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">as1darray</span><span class="p">(</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">):</span>
    <span class="n">size</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">out</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">a</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">out</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">o</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">o</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">o</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">size</span> <span class="o">=</span> <span class="n">o</span><span class="o">.</span><span class="n">size</span>
            <span class="k">elif</span> <span class="n">o</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">size</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Size of arrays do not match&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">o</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;array cannot have more than 1 dimension&#39;</span><span class="p">)</span>

    <span class="n">out</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">o</span> <span class="k">if</span> <span class="p">(</span><span class="n">o</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="p">(</span><span class="n">o</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">o</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">))</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">size</span> <span class="ow">or</span> <span class="mi">1</span><span class="p">,</span> <span class="n">o</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">out</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">out</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="simple.plotting.create_legend" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">simple.plotting.create_legend</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">create_legend</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">outside</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">outside_margin</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Add a legend to a plot.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>ax</code></b>
          –
          <div class="doc-md-description">
            <p>The working axes. Accepted values are any matplotlib Axes object or plt instance.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>outside</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>If <code>True</code> the legend will be drawn just outside the upper left corner of the plot. This will
overwrite any <code>loc</code> and <code>bbox_to_anchor</code> arguments in <code>kwargs</code>.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>outside_margin</code></b>
          –
          <div class="doc-md-description">
            <p>Margin between the plot and the legend. Relative to the width of the plot.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>**kwargs</code></b>
          –
          <div class="doc-md-description">
            <p>Any valid argument for matplotlibs
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.legend.html"><code>legend</code></a> function.</p>
          </div>
        </li>
    </ul>


            <details class="quote">
              <summary>Source code in <code>simple/plotting.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@utils</span><span class="o">.</span><span class="n">set_default_kwargs</span><span class="p">()</span>
<span class="k">def</span><span class="w"> </span><span class="nf">create_legend</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">outside</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">outside_margin</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Add a legend to a plot.</span>

<span class="sd">    Args:</span>
<span class="sd">        ax (): The working axes. Accepted values are any matplotlib Axes object or plt instance.</span>
<span class="sd">        outside (bool): If ``True`` the legend will be drawn just outside the upper left corner of the plot. This will</span>
<span class="sd">            overwrite any ``loc`` and ``bbox_to_anchor`` arguments in ``kwargs``.</span>
<span class="sd">        outside_margin (): Margin between the plot and the legend. Relative to the width of the plot.</span>
<span class="sd">        **kwargs (): Any valid argument for matplotlibs</span>
<span class="sd">            [``legend``](https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.legend.html) function.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">get_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">outside</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;loc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;upper left&#39;</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;bbox_to_anchor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">outside_margin</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="simple.plotting.create_rose_plot" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">simple.plotting.create_rose_plot</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">create_rose_plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;turbo&#39;</span><span class="p">,</span> <span class="n">colorbar_show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">colorbar_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">colorbar_fontsize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xscale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">yscale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">segment</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rres</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">fig_kw</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Create a plot with a <a href="simple.plot.RoseAxes">rose projection</a>.</p>
<p>The rose ax is a subclass of matplotlibs
<a href="https://matplotlib.org/stable/api/projections/polar.html#matplotlib.projections.polar.PolarAxes">polar ax</a>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>ax</code></b>
          –
          <div class="doc-md-description">
            <p>If no preexisting ax is given then a new figure with a single rose ax is created. If an existing</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>vmin</code></b>
              (<code><span title="float">float</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>The lower limit of the colour map. If no value is given the minimum value is <code>0</code> (or <code>1E-10</code> if</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>vmax</code></b>
              (<code><span title="float">float</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>The upper limit of the colour map. If no value is given then <code>vmax</code> is set to <code>1</code> and all bin
default_weight are divided by the heaviest bin weight in each histogram.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>log</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>Whether the color map scale is logarithmic or not.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>cmap</code></b>
          –
          <div class="doc-md-description">
            <p>The prefixes of the colormap to use. See,
    [matplotlib documentation][https://matplotlib.org/stable/users/explain/colors/colormaps.html]
     for a list of available colormaps.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>colorbar_show</code></b>
          –
          <div class="doc-md-description">
            <p>Whether to add a colorbar to the right of the ax.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>colorbar_label</code></b>
          –
          <div class="doc-md-description">
            <p>The label given to the colorbar.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>colorbar_fontsize</code></b>
          –
          <div class="doc-md-description">
            <p>The fontsize of the colorbar label.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>xscale</code></b>
          –
          <div class="doc-md-description">
            <p>The scale of the x axis.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>yscale</code></b>
          –
          <div class="doc-md-description">
            <p>The scale of the y axis.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>segment</code></b>
          –
          <div class="doc-md-description">
            <p>Which segment of the rose diagram to show. Options are <code>N</code>, <code>E</code>, <code>S</code>, <code>W</code>, <code>None</code>.
If <code>None</code> the entire circle is shown.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>rres</code></b>
          –
          <div class="doc-md-description">
            <p>The resolution of lines drawn along the radius <code>r</code>. The number of points in a line is calculated as</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>**fig_kw</code></b>
          –
          <div class="doc-md-description">
            <p>Additional figure keyword arguments passed to the <code>pyplot.figure</code> call. Only used when <code>ax</code>
is not given.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>RoseAxes</code></b>          –
          <div class="doc-md-description">
            <p>The new rose ax.</p>
          </div>
        </li>
    </ul>


            <details class="quote">
              <summary>Source code in <code>simple/plotting.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_rose_plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">log</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;turbo&#39;</span><span class="p">,</span>
                     <span class="n">colorbar_show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">colorbar_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">colorbar_fontsize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">xscale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">yscale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                     <span class="n">segment</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">rres</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="o">**</span><span class="n">fig_kw</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a plot with a [rose projection](simple.plot.RoseAxes).</span>

<span class="sd">    The rose ax is a subclass of matplotlibs</span>
<span class="sd">    [polar ax](https://matplotlib.org/stable/api/projections/polar.html#matplotlib.projections.polar.PolarAxes).</span>

<span class="sd">    Args:</span>
<span class="sd">        ax (): If no preexisting ax is given then a new figure with a single rose ax is created. If an existing</span>
<span class="sd">        ax is passed this ax will be deleted and replaced with a [RoseAxes][#RoseAxes].</span>
<span class="sd">        vmin (float): The lower limit of the colour map. If no value is given the minimum value is ``0`` (or ``1E-10`` if</span>
<span class="sd">        ``log=True``)</span>
<span class="sd">        vmax (float): The upper limit of the colour map. If no value is given then ``vmax`` is set to ``1`` and all bin</span>
<span class="sd">            default_weight are divided by the heaviest bin weight in each histogram.</span>
<span class="sd">        log (bool): Whether the color map scale is logarithmic or not.</span>
<span class="sd">        cmap (): The prefixes of the colormap to use. See,</span>
<span class="sd">                [matplotlib documentation][https://matplotlib.org/stable/users/explain/colors/colormaps.html]</span>
<span class="sd">                 for a list of available colormaps.</span>
<span class="sd">        colorbar_show (): Whether to add a colorbar to the right of the ax.</span>
<span class="sd">        colorbar_label (): The label given to the colorbar.</span>
<span class="sd">        colorbar_fontsize (): The fontsize of the colorbar label.</span>
<span class="sd">        xscale (): The scale of the x axis.</span>
<span class="sd">        yscale (): The scale of the y axis.</span>
<span class="sd">        segment (): Which segment of the rose diagram to show. Options are ``N``, ``E``, ``S``, ``W``, ``None``.</span>
<span class="sd">            If ``None`` the entire circle is shown.</span>
<span class="sd">        rres (): The resolution of lines drawn along the radius ``r``. The number of points in a line is calculated as</span>
<span class="sd">        ``r*rres+1`` (Min. 2).</span>
<span class="sd">        **fig_kw (): Additional figure keyword arguments passed to the ``pyplot.figure`` call. Only used when ``ax``</span>
<span class="sd">            is not given.</span>

<span class="sd">    Returns:</span>
<span class="sd">        RoseAxes : The new rose ax.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">figure_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;layout&#39;</span><span class="p">:</span> <span class="s1">&#39;constrained&#39;</span><span class="p">}</span>
        <span class="n">figure_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">fig_kw</span><span class="p">)</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="s1">&#39;rose&#39;</span><span class="p">},</span> <span class="o">**</span><span class="n">figure_kwargs</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">get_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_figure</span><span class="p">()</span>
        <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">stop</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_subplotspec</span><span class="p">()</span><span class="o">.</span><span class="n">get_geometry</span><span class="p">()</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">start</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;rose&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">colorbar_label</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">vmax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">colorbar_label</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Bin weight normalised to largest bin&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">colorbar_label</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Bin weight&#39;</span>
    <span class="k">elif</span> <span class="n">colorbar_label</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
        <span class="n">colorbar_label</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_colorbar</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="n">log</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
                    <span class="n">label</span><span class="o">=</span><span class="n">colorbar_label</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="n">colorbar_show</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">colorbar_fontsize</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xyscale</span><span class="p">(</span><span class="n">xscale</span><span class="p">,</span> <span class="n">yscale</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">segment</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_segment</span><span class="p">(</span><span class="n">segment</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">rres</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_rres</span><span class="p">(</span><span class="n">rres</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">ax</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="simple.plotting.deg2rad" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">simple.plotting.deg2rad</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">deg2rad</span><span class="p">(</span><span class="n">deg</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Convert a degree angle into a radian angle`value</p>


            <details class="quote">
              <summary>Source code in <code>simple/plotting.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">deg2rad</span><span class="p">(</span><span class="n">deg</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert a degree angle into a radian angle`value&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">deg</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="simple.plotting.get_axes" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">simple.plotting.get_axes</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_axes</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Return the ax that should be used for plotting.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>axes</code></b>
          –
          <div class="doc-md-description">
            <p>Must either be <code>None</code>, in which case <code>plt.gca()</code> will be returned, a matplotlib ax instance, or
any object that has a <code>.gca()</code> method.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>projection</code></b>
          –
          <div class="doc-md-description">
            <p>If given, an exception is raised if <code>ax</code> does not have this projection.</p>
          </div>
        </li>
    </ul>


            <details class="quote">
              <summary>Source code in <code>simple/plotting.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_axes</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the ax that should be used for plotting.</span>

<span class="sd">    Args:</span>
<span class="sd">        axes (): Must either be ``None``, in which case ``plt.gca()`` will be returned, a matplotlib ax instance, or</span>
<span class="sd">            any object that has a ``.gca()`` method.</span>
<span class="sd">        projection (): If given, an exception is raised if ``ax`` does not have this projection.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">axes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">Axes</span><span class="p">):</span>
        <span class="k">pass</span>
    <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="s1">&#39;gca&#39;</span><span class="p">):</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span> <span class="c1"># if ax = plt</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;ax must be an Axes, Axes instance or have a gca() method that return an Axes&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">projection</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">axes</span><span class="o">.</span><span class="n">name</span> <span class="o">!=</span> <span class="n">projection</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The selected ax has the wrong projection. Expected </span><span class="si">{</span><span class="n">projection</span><span class="si">}</span><span class="s1"> got </span><span class="si">{</span><span class="n">axes</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">.&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">axes</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="simple.plotting.get_cmap" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">simple.plotting.get_cmap</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_cmap</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Return the matplotlib colormap with the given name.</p>


            <details class="quote">
              <summary>Source code in <code>simple/plotting.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_cmap</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the matplotlib colormap with the given name.&quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colormaps</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">mpl</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="simple.plotting.get_data" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">simple.plotting.get_data</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_data</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">axis_names</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">latex_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_attrname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_value</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">key_in_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">numer_in_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">denom_in_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">model_in_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">unit_in_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">attrname_in_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">axis_name_in_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">prefix_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">suffix_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mask_na</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Get one or more datasets from a group of models together with suitable labels.</p>
<p>Each data point is a dictionary that contains a value for each of the axis given in <em>axis_names</em> plus a label
describing the data point. The value for each axis is determined by the <em>key</em> argument. This argument has two
possible components; the name of the attribute and the index, or key, to be applied this, or the
<em>default_attrname</em>, attribute.</p>
<p>The name of the attribute must start with a <code>.</code> followed by the path to the attribute relative to the Model
object using successive <code>.</code> for nested attributes, e.g. <code>.intnorm.eRi</code>.</p>
<p>The index, or key, part of the <em>key</em> can either be an integer, a slice or a sequence of keys seperated by <code>,</code>.
The keys will be parsed into either <a href="simple.utils.Isotope">Isotope</a>, <a href="simple.utils.Ratio">Ratio</a>, or
<a href="simple.utils.Element">Element</a> strings. If a key is given it is assumed that the attribute contains an isotope
key array. Therefore, Element strings will be replaced with all the isotopes of that element
present in the attribute (Across all models) and Ratio strings will return the numerator value divided by the
denominator value.</p>
<p>If the attribute name is given in <em>key</em> then the index, or key, part must be enclosed in square brackets, e.g.
<code>.intnorm.eRi[105Pd]</code>. If the <em>default_attrname</em> should be used then <em>key</em> should only contain the index, or key.</p>
<p>By the default the label for each data point only contains the information is not shared with all other data points.
Information that is shared between all data points is instead included in the axis labels.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>models</code></b>
          –
          <div class="doc-md-description">
            <p>A collection of models to plot. A subselection of these models can be made using the <em>where</em>
argument.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>axis_names</code></b>
          –
          <div class="doc-md-description">
            
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>where</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>If given will be used to create a subselection of <em>models</em>. Any <em>kwargs</em> prefixed
with <code>where_</code> will be supplied as keyword arguments. See
 <a href="simple.models.ModelCollection.where"><code>ModelCollection.where</code></a> for more details.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>latex_labels</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to use the latex formatting in the labels, when available.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>key</code></b>
              (<code>(<span title="str">str</span>, <span title="int">int</span>, <span title="slice">slice</span>)</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>This can either be a valid index to the <em>default_attrname</em> array or the path, with
or without a valid index, of a different attribute. Accepts either single universal value
or a list of values, one for each axis (See below for details).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>default_attrname</code></b>
          –
          <div class="doc-md-description">
            <p>The name of the default attribute to use if <em>xkey</em> and <em>ykey</em> are indexes. By default,
the default key array is used. Accepts either single universal value or a list of values, one for each
axis (See below for details).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>unit</code></b>
          –
          <div class="doc-md-description">
            <p>The desired unit for the <em>xkey</em> and <em>ykey</em>. Different units for <em>xkey</em> and <em>ykey</em> can be specified
by supplying a <code>(&lt;xkey_unit&gt;, &lt;ykey_unit&gt;)</code> sequence. Accepts either single universal value
or a list of values, one for each axis (See below for details).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>default_value</code></b>
          –
          <div class="doc-md-description">
            <p>The value given to invalid indexes of arrays. Must have a shape compatible with the size
of the indexed array. Accepts either single universal value
or a list of values, one for each axis (See below for details).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>key_in_label</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to include the key index in the label. Accepts either single universal value
or a list of values, one for each axis (See below for details).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>numer_in_label</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to include the numerator of a key index in the label. Accepts either single
universal value or a list of values, one for each axis (See below for details).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>denom_in_label</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to include the denominator of a key index in the label. Accepts either single
universal value or a list of values, one for each axis (See below for details).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>model_in_label</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to include the model name in the label. Accepts either single universal value
or a list of values, one for each axis (See below for details).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>unit_in_label</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to include the unit in the label. Accepts either single universal value
or a list of values, one for each axis (See below for details).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>attrname_in_label</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to include the attribute name in the label. By default
the name is only included if it is different from the <em>default_attrname</em>. Accepts a single universal
value or a list of values, one for each axis (See below for details).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>axis_name_in_label</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to include the axis name in the label. Accepts either single universal value
or a value for each axis (See below for details).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>label</code></b>
              (<code>(<span title="str">str</span>, <span title="bool">bool</span>, None)</code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>The label for individual datapoints. Accepts either a single universal value or
a list of values, one per data point (See below for details).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>prefix_label</code></b>
          –
          <div class="doc-md-description">
            <p>Text to be added to the beginning of each data point label. Accepts either a single universal
value or a list of values, one per data point (See below for details).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>suffix_label</code></b>
          –
          <div class="doc-md-description">
            <p>Text to be added at the end of each data point label. Accepts either a single universal
value or a list of values, one per data point (See below for details).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>mask</code></b>
              (<code>(<span title="str">str</span>, <span title="int">int</span>, <span title="slice">slice</span>)</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Can be used to apply a mask to the data which is plotted. See the
<code>get_mask</code> function of the Model object. Accepts either a single universal
value or a list of values, one per model (See below for details).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>mask_na</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>If <code>True</code> masked values will be replaced by <code>np.nan</code> values. Only works if all arrays
in a dataset have a float based datatype. Accepts either a single universal
value or a list of values, one per model (See below for details).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>**kwargs</code></b>
          –
          <div class="doc-md-description">
            
          </div>
        </li>
    </ul>


<details class="one-per-axis-arguments" open>
  <summary>One per axis arguments</summary>
  <p>These arguments allow you to set a different value for each axis in <em>axis_names</em>. This can be
either a single value used for all the axis or a sequence of values, one per axis.</p>
<p>It is also possible to define the value for a specific axis by  including a keyword argument consiting
of the axis name followed directly by the argument name. The value specified this way will take presidence over
the value given by the argument itself. For example <code>xkey=102Pd</code> will set the <em>key</em> argument for
the <em>x</em> axis to <code>102Pd</code>.</p>
</details>

<details class="one-per-data-point-arguments" open>
  <summary>One per data point arguments</summary>
  <p>These arguments allow you to set a different value for each data point. The number of data points is
equal to the number of models multiplied by the number of datasets generated. This can be
either a single value used for all the axis or a sequence of values, one per data point.</p>
</details>

<details class="one-per-model-arguments" open>
  <summary>One per model arguments</summary>
  <p>These arguments allow you to set a different value for each model in <em>models</em>. This can be
either a single value used for all the axis or a sequence of values, one per model.</p>
</details>

<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          –
          <div class="doc-md-description">
            <p>Tuple[dict, dict]: Two dictionaries containing:</p>
<ul>
<li>
<p>A dictionary with the data points for each model, mapped to the model name</p>
</li>
<li>
<p>A dictionary containing labels for each axis, mapped to the axis name.</p>
</li>
</ul>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Here is an example of how the return data can be used.</p>
<pre><code>model_datapoints, axis_labels = simple.get_data(models, 'x, y', xkey=..., ykey=...)

# Set the axis labels
plt.set_xlabel(axis_labels['x'])
plt.set_ylabel(axis_labels['y'])

# Iterate though the data and plot it
for model_name, datapoints in model_datapoints.items():
    for dp in datapoints:
        plt.plot(dp['x'], dp['y'], label=dp['label'])
</code></pre>


            <details class="quote">
              <summary>Source code in <code>simple/plotting.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 836</span>
<span class="normal"> 837</span>
<span class="normal"> 838</span>
<span class="normal"> 839</span>
<span class="normal"> 840</span>
<span class="normal"> 841</span>
<span class="normal"> 842</span>
<span class="normal"> 843</span>
<span class="normal"> 844</span>
<span class="normal"> 845</span>
<span class="normal"> 846</span>
<span class="normal"> 847</span>
<span class="normal"> 848</span>
<span class="normal"> 849</span>
<span class="normal"> 850</span>
<span class="normal"> 851</span>
<span class="normal"> 852</span>
<span class="normal"> 853</span>
<span class="normal"> 854</span>
<span class="normal"> 855</span>
<span class="normal"> 856</span>
<span class="normal"> 857</span>
<span class="normal"> 858</span>
<span class="normal"> 859</span>
<span class="normal"> 860</span>
<span class="normal"> 861</span>
<span class="normal"> 862</span>
<span class="normal"> 863</span>
<span class="normal"> 864</span>
<span class="normal"> 865</span>
<span class="normal"> 866</span>
<span class="normal"> 867</span>
<span class="normal"> 868</span>
<span class="normal"> 869</span>
<span class="normal"> 870</span>
<span class="normal"> 871</span>
<span class="normal"> 872</span>
<span class="normal"> 873</span>
<span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@utils</span><span class="o">.</span><span class="n">set_default_kwargs</span><span class="p">()</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_data</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">axis_names</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">latex_labels</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
             <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_attrname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span>
             <span class="n">key_in_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">numer_in_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">denom_in_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">model_in_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">unit_in_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">attrname_in_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">axis_name_in_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">label</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">prefix_label</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">suffix_label</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">mask</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">mask_na</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
             <span class="n">_kwargs</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get one or more datasets from a group of models together with suitable labels.</span>

<span class="sd">    Each data point is a dictionary that contains a value for each of the axis given in *axis_names* plus a label</span>
<span class="sd">    describing the data point. The value for each axis is determined by the *key* argument. This argument has two</span>
<span class="sd">    possible components; the name of the attribute and the index, or key, to be applied this, or the</span>
<span class="sd">    *default_attrname*, attribute.</span>

<span class="sd">    The name of the attribute must start with a ``.`` followed by the path to the attribute relative to the Model</span>
<span class="sd">    object using successive ``.`` for nested attributes, e.g. ``.intnorm.eRi``.</span>

<span class="sd">    The index, or key, part of the *key* can either be an integer, a slice or a sequence of keys seperated by ``,``.</span>
<span class="sd">    The keys will be parsed into either [Isotope](simple.utils.Isotope), [Ratio](simple.utils.Ratio), or</span>
<span class="sd">    [Element](simple.utils.Element) strings. If a key is given it is assumed that the attribute contains an isotope</span>
<span class="sd">    key array. Therefore, Element strings will be replaced with all the isotopes of that element</span>
<span class="sd">    present in the attribute (Across all models) and Ratio strings will return the numerator value divided by the</span>
<span class="sd">    denominator value.</span>

<span class="sd">    If the attribute name is given in *key* then the index, or key, part must be enclosed in square brackets, e.g.</span>
<span class="sd">    ``.intnorm.eRi[105Pd]``. If the *default_attrname* should be used then *key* should only contain the index, or key.</span>

<span class="sd">    By the default the label for each data point only contains the information is not shared with all other data points.</span>
<span class="sd">    Information that is shared between all data points is instead included in the axis labels.</span>

<span class="sd">    Args:</span>
<span class="sd">        models (): A collection of models to plot. A subselection of these models can be made using the *where*</span>
<span class="sd">            argument.</span>
<span class="sd">        axis_names ():</span>
<span class="sd">        where (str): If given will be used to create a subselection of *models*. Any *kwargs* prefixed</span>
<span class="sd">            with ``where_`` will be supplied as keyword arguments. See</span>
<span class="sd">             [``ModelCollection.where``](simple.models.ModelCollection.where) for more details.</span>
<span class="sd">        latex_labels (bool): Whether to use the latex formatting in the labels, when available.</span>
<span class="sd">        key (str, int, slice): This can either be a valid index to the *default_attrname* array or the path, with</span>
<span class="sd">            or without a valid index, of a different attribute. Accepts either single universal value</span>
<span class="sd">            or a list of values, one for each axis (See below for details).</span>
<span class="sd">        default_attrname (): The name of the default attribute to use if *xkey* and *ykey* are indexes. By default,</span>
<span class="sd">            the default key array is used. Accepts either single universal value or a list of values, one for each</span>
<span class="sd">            axis (See below for details).</span>
<span class="sd">        unit (): The desired unit for the *xkey* and *ykey*. Different units for *xkey* and *ykey* can be specified</span>
<span class="sd">            by supplying a ``(&lt;xkey_unit&gt;, &lt;ykey_unit&gt;)`` sequence. Accepts either single universal value</span>
<span class="sd">            or a list of values, one for each axis (See below for details).</span>
<span class="sd">        default_value (): The value given to invalid indexes of arrays. Must have a shape compatible with the size</span>
<span class="sd">            of the indexed array. Accepts either single universal value</span>
<span class="sd">            or a list of values, one for each axis (See below for details).</span>
<span class="sd">        key_in_label (bool): Whether to include the key index in the label. Accepts either single universal value</span>
<span class="sd">            or a list of values, one for each axis (See below for details).</span>
<span class="sd">        numer_in_label (bool): Whether to include the numerator of a key index in the label. Accepts either single</span>
<span class="sd">            universal value or a list of values, one for each axis (See below for details).</span>
<span class="sd">        denom_in_label (bool): Whether to include the denominator of a key index in the label. Accepts either single</span>
<span class="sd">            universal value or a list of values, one for each axis (See below for details).</span>
<span class="sd">        model_in_label (bool): Whether to include the model name in the label. Accepts either single universal value</span>
<span class="sd">            or a list of values, one for each axis (See below for details).</span>
<span class="sd">        unit_in_label (bool): Whether to include the unit in the label. Accepts either single universal value</span>
<span class="sd">            or a list of values, one for each axis (See below for details).</span>
<span class="sd">        attrname_in_label (bool): Whether to include the attribute name in the label. By default</span>
<span class="sd">            the name is only included if it is different from the *default_attrname*. Accepts a single universal</span>
<span class="sd">            value or a list of values, one for each axis (See below for details).</span>
<span class="sd">        axis_name_in_label (bool): Whether to include the axis name in the label. Accepts either single universal value</span>
<span class="sd">            or a value for each axis (See below for details).</span>
<span class="sd">        label (str, bool, None): The label for individual datapoints. Accepts either a single universal value or</span>
<span class="sd">            a list of values, one per data point (See below for details).</span>
<span class="sd">        prefix_label (): Text to be added to the beginning of each data point label. Accepts either a single universal</span>
<span class="sd">            value or a list of values, one per data point (See below for details).</span>
<span class="sd">        suffix_label (): Text to be added at the end of each data point label. Accepts either a single universal</span>
<span class="sd">            value or a list of values, one per data point (See below for details).</span>
<span class="sd">        mask (str, int, slice): Can be used to apply a mask to the data which is plotted. See the</span>
<span class="sd">            ``get_mask`` function of the Model object. Accepts either a single universal</span>
<span class="sd">            value or a list of values, one per model (See below for details).</span>
<span class="sd">        mask_na (bool): If ``True`` masked values will be replaced by ``np.nan`` values. Only works if all arrays</span>
<span class="sd">            in a dataset have a float based datatype. Accepts either a single universal</span>
<span class="sd">            value or a list of values, one per model (See below for details).</span>
<span class="sd">        **kwargs:</span>

<span class="sd">    One per axis arguments:</span>
<span class="sd">        These arguments allow you to set a different value for each axis in *axis_names*. This can be</span>
<span class="sd">        either a single value used for all the axis or a sequence of values, one per axis.</span>

<span class="sd">        It is also possible to define the value for a specific axis by  including a keyword argument consiting</span>
<span class="sd">        of the axis name followed directly by the argument name. The value specified this way will take presidence over</span>
<span class="sd">        the value given by the argument itself. For example ``xkey=102Pd`` will set the *key* argument for</span>
<span class="sd">        the *x* axis to ``102Pd``.</span>


<span class="sd">    One per data point arguments:</span>
<span class="sd">        These arguments allow you to set a different value for each data point. The number of data points is</span>
<span class="sd">        equal to the number of models multiplied by the number of datasets generated. This can be</span>
<span class="sd">        either a single value used for all the axis or a sequence of values, one per data point.</span>


<span class="sd">    One per model arguments:</span>
<span class="sd">        These arguments allow you to set a different value for each model in *models*. This can be</span>
<span class="sd">        either a single value used for all the axis or a sequence of values, one per model.</span>


<span class="sd">    Returns:</span>
<span class="sd">        Tuple[dict, dict]: Two dictionaries containing:</span>

<span class="sd">            - A dictionary with the data points for each model, mapped to the model name</span>

<span class="sd">            - A dictionary containing labels for each axis, mapped to the axis name.</span>

<span class="sd">    Examples:</span>
<span class="sd">        Here is an example of how the return data can be used.</span>
<span class="sd">        ```</span>
<span class="sd">        model_datapoints, axis_labels = simple.get_data(models, &#39;x, y&#39;, xkey=..., ykey=...)</span>

<span class="sd">        # Set the axis labels</span>
<span class="sd">        plt.set_xlabel(axis_labels[&#39;x&#39;])</span>
<span class="sd">        plt.set_ylabel(axis_labels[&#39;y&#39;])</span>

<span class="sd">        # Iterate though the data and plot it</span>
<span class="sd">        for model_name, datapoints in model_datapoints.items():</span>
<span class="sd">            for dp in datapoints:</span>
<span class="sd">                plt.plot(dp[&#39;x&#39;], dp[&#39;y&#39;], label=dp[&#39;label&#39;])</span>
<span class="sd">        ```</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">_kwargs</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Only one of `kwargs` or `kwargs_` can be specified.&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="n">_kwargs</span> <span class="ow">or</span> <span class="n">kwargs</span>

    <span class="n">where_kwargs</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">extract_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;where&#39;</span><span class="p">)</span>
    <span class="n">models</span> <span class="o">=</span> <span class="n">get_models</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">where</span><span class="p">,</span> <span class="n">where_kwargs</span><span class="o">=</span><span class="n">where_kwargs</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">axis_names</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="n">axis_name_args</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">axis_names</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">axis_key_args</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">axis_names</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
    <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">axis_names</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;,&#39;</span> <span class="ow">in</span> <span class="n">axis_names</span><span class="p">:</span>
            <span class="n">axis_name_args</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">axis_names</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">axis_name_args</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">axis_names</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
        <span class="n">axis_key_args</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;``axis_name`` must be a string or a dict&#39;</span><span class="p">)</span>

    <span class="n">lenargs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">axis_name_args</span><span class="p">)</span>
    <span class="n">lenmodels</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">models</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">one_per_n</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n_name</span><span class="p">,</span> <span class="n">arg_name</span><span class="p">,</span> <span class="n">arg_value</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg_value</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg_value</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">arg_value</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">arg_value</span><span class="p">)</span> <span class="o">==</span> <span class="n">n</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">arg_value</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">arg_value</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">arg_value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Length of ``</span><span class="si">{</span><span class="n">arg_name</span><span class="si">}</span><span class="s1">`` (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">arg_value</span><span class="p">)</span><span class="si">}</span><span class="s1">) must be equal to number of </span><span class="si">{</span><span class="n">n_name</span><span class="si">}</span><span class="s1"> (</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">one_per_arg</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="n">args</span> <span class="o">=</span> <span class="n">one_per_n</span><span class="p">(</span><span class="n">lenargs</span><span class="p">,</span> <span class="s1">&#39;axis&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">axis</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axis_name_args</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">k</span><span class="o">:=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">axis</span><span class="si">}{</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="n">args</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">k</span><span class="o">:=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">axis</span><span class="si">}{</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="n">args</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">args</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">parse_key_string</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">data_arrays</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">utils</span><span class="o">.</span><span class="n">asisotopes</span><span class="p">(</span><span class="n">key</span><span class="p">),</span> <span class="s1">&#39;iso&#39;</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">utils</span><span class="o">.</span><span class="n">asratios</span><span class="p">(</span><span class="n">key</span><span class="p">),</span> <span class="s1">&#39;rat&#39;</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">elements</span> <span class="o">=</span>  <span class="n">utils</span><span class="o">.</span><span class="n">aselements</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Unable to parse &quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s1">&quot; into a sequence of valid Element, Isotope or Ratio string.&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Because the key list should be the same for all models we need to go through them all here</span>
            <span class="c1"># incase some have more or less isotopes in the specified data array</span>
            <span class="n">all_isotopes</span> <span class="o">=</span> <span class="p">()</span>
            <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">:</span>
                <span class="n">element_isotopes</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">data_arrays</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">))</span> <span class="ow">or</span> <span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">fields</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Data array &quot;</span><span class="si">{</span><span class="n">attrname</span><span class="si">}</span><span class="s1">&quot; of model </span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1"> is not a key array. &#39;</span>
                                         <span class="sa">f</span><span class="s1">&#39;Cannot extract isotope keys.&#39;</span><span class="p">)</span>

                    <span class="k">for</span> <span class="n">iso</span> <span class="ow">in</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_isotopes_of_element</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">fields</span><span class="p">,</span> <span class="n">element</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">iso</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">element_isotopes</span><span class="p">:</span>
                            <span class="n">element_isotopes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iso</span><span class="p">)</span>
                <span class="n">all_isotopes</span> <span class="o">+=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">element_isotopes</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">iso</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">iso</span><span class="o">.</span><span class="n">mass</span><span class="p">)))</span>
            <span class="k">return</span> <span class="n">all_isotopes</span><span class="p">,</span> <span class="s1">&#39;iso&#39;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_data_label</span><span class="p">(</span><span class="n">keylabels</span><span class="p">,</span> <span class="n">keys</span><span class="p">,</span> <span class="n">key_in_label</span><span class="p">,</span> <span class="n">numer_in_label</span><span class="p">,</span> <span class="n">denom_in_label</span><span class="p">):</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="ow">is</span> <span class="n">utils</span><span class="o">.</span><span class="n">Isotope</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">key_in_label</span><span class="p">:</span>
                    <span class="n">label</span> <span class="o">=</span> <span class="n">keylabels</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;!</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="k">elif</span> <span class="n">key_in_label</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">numer_in_label</span> <span class="ow">and</span> <span class="n">denom_in_label</span><span class="p">:</span>
                    <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">keylabels</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="o">.</span><span class="n">numer</span><span class="p">,</span><span class="w"> </span><span class="sa">f</span><span class="s2">&quot;!</span><span class="si">{</span><span class="n">key</span><span class="o">.</span><span class="n">numer</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">keylabels</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="o">.</span><span class="n">denom</span><span class="p">,</span><span class="w"> </span><span class="sa">f</span><span class="s2">&quot;!</span><span class="si">{</span><span class="n">key</span><span class="o">.</span><span class="n">denom</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1"> &#39;</span>
                <span class="k">elif</span> <span class="n">numer_in_label</span><span class="p">:</span>
                    <span class="n">label</span> <span class="o">=</span> <span class="n">keylabels</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="o">.</span><span class="n">numer</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;!</span><span class="si">{</span><span class="n">key</span><span class="o">.</span><span class="n">numer</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">denom_in_label</span><span class="p">:</span>
                    <span class="n">label</span> <span class="o">=</span> <span class="n">keylabels</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="o">.</span><span class="n">denom</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;!</span><span class="si">{</span><span class="n">key</span><span class="o">.</span><span class="n">denom</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">labels</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_data_index</span><span class="p">(</span><span class="n">data_array</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">mi</span><span class="p">,</span> <span class="n">ai</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">data_array</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">models</span><span class="p">[</span><span class="n">mi</span><span class="p">]</span><span class="si">}</span><span class="s1">.</span><span class="si">{</span><span class="n">attrname_a</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span><span class="si">}</span><span class="s1">: Missing field &quot;</span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s1">&quot; replaced by the default value (</span><span class="si">{</span><span class="n">default_value</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data_array</span><span class="p">),</span> <span class="n">default_value_args</span><span class="p">[</span><span class="n">ai</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">error</span>

    <span class="k">if</span> <span class="n">axis_key_args</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">axis_key_args</span> <span class="o">=</span> <span class="n">one_per_arg</span><span class="p">(</span><span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>

    <span class="n">default_attrname_args</span> <span class="o">=</span> <span class="n">one_per_arg</span><span class="p">(</span><span class="s1">&#39;default_attrname&#39;</span><span class="p">,</span> <span class="n">default_attrname</span><span class="p">)</span>
    <span class="n">desired_unit_args</span> <span class="o">=</span> <span class="n">one_per_arg</span><span class="p">(</span><span class="s1">&#39;unit&#39;</span><span class="p">,</span> <span class="n">unit</span><span class="p">)</span>
    <span class="n">default_value_args</span> <span class="o">=</span> <span class="n">one_per_arg</span><span class="p">(</span><span class="s1">&#39;default_value&#39;</span><span class="p">,</span> <span class="n">default_value</span><span class="p">)</span>
    <span class="n">key_in_label_args</span> <span class="o">=</span> <span class="n">one_per_arg</span><span class="p">(</span><span class="s1">&#39;key_in_label&#39;</span><span class="p">,</span> <span class="n">key_in_label</span><span class="p">)</span>
    <span class="n">numer_in_label_args</span> <span class="o">=</span> <span class="n">one_per_arg</span><span class="p">(</span><span class="s1">&#39;numer_in_label&#39;</span><span class="p">,</span> <span class="n">numer_in_label</span><span class="p">)</span>
    <span class="n">denom_in_label_args</span> <span class="o">=</span> <span class="n">one_per_arg</span><span class="p">(</span><span class="s1">&#39;denom_in_label&#39;</span><span class="p">,</span> <span class="n">denom_in_label</span><span class="p">)</span>
    <span class="n">model_in_label_args</span> <span class="o">=</span> <span class="n">one_per_arg</span><span class="p">(</span><span class="s1">&#39;model_in_label&#39;</span><span class="p">,</span> <span class="n">model_in_label</span><span class="p">)</span>
    <span class="n">unit_in_label_args</span> <span class="o">=</span> <span class="n">one_per_arg</span><span class="p">(</span><span class="s1">&#39;unit_in_label&#39;</span><span class="p">,</span> <span class="n">unit_in_label</span><span class="p">)</span>
    <span class="n">attrname_in_label_args</span> <span class="o">=</span> <span class="n">one_per_arg</span><span class="p">(</span><span class="s1">&#39;attrname_in_label&#39;</span><span class="p">,</span> <span class="n">attrname_in_label</span><span class="p">)</span>
    <span class="n">axis_name_in_label_args</span> <span class="o">=</span> <span class="n">one_per_arg</span><span class="p">(</span><span class="s1">&#39;axis_name_in_label&#39;</span><span class="p">,</span> <span class="n">axis_name_in_label</span><span class="p">)</span>

    <span class="n">mask_args</span> <span class="o">=</span> <span class="n">one_per_n</span><span class="p">(</span><span class="n">lenmodels</span><span class="p">,</span> <span class="s1">&#39;models&#39;</span><span class="p">,</span> <span class="s1">&#39;mask&#39;</span><span class="p">,</span> <span class="n">mask</span><span class="p">)</span>
    <span class="n">mask_na_args</span> <span class="o">=</span> <span class="n">one_per_n</span><span class="p">(</span><span class="n">lenmodels</span><span class="p">,</span> <span class="s1">&#39;models&#39;</span><span class="p">,</span> <span class="s1">&#39;mask_na&#39;</span><span class="p">,</span> <span class="n">mask_na</span><span class="p">)</span>

    <span class="c1"># _a -   [arg1, arg2, ...]</span>
    <span class="c1"># _am -  [(arg1_model1, arg1_model2, ...), (arg2_model1, arg2_model2, ...)]</span>
    <span class="c1"># _amk - [({arg1_model1_key1, arg1_model1_key2, ...}, {arg1_model2_key1, arg1_model2_key2, ...}), ...]</span>
    <span class="n">attrname_a</span><span class="p">,</span> <span class="n">keys_ak</span><span class="p">,</span> <span class="n">keytype_a</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">data_arrays_am</span><span class="p">,</span> <span class="n">data_units_am</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">data_label_am</span><span class="p">,</span> <span class="n">data_keylabels_am</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">ai</span><span class="p">,</span> <span class="n">arg</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axis_key_args</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">str</span><span class="p">:</span>
            <span class="n">attrname</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">parse_attrname</span><span class="p">(</span><span class="n">default_attrname_args</span><span class="p">[</span><span class="n">ai</span><span class="p">])</span>
            <span class="n">key</span> <span class="o">=</span> <span class="n">arg</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">arg</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">):</span>
                <span class="n">m</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^([A-Za-z0-9_.]+)(?:\[(.*?)\])?$&#39;</span><span class="p">,</span> <span class="n">arg</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">m</span><span class="p">:</span>
                    <span class="n">attrname</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">parse_attrname</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
                    <span class="n">key</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">attrname_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">attrname_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Invalid arg: </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">attrname</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">parse_attrname</span><span class="p">(</span><span class="n">default_attrname_args</span><span class="p">[</span><span class="n">ai</span><span class="p">])</span>
                <span class="n">key</span> <span class="o">=</span> <span class="n">arg</span>

        <span class="k">if</span> <span class="n">attrname_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">attrname</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">attrname_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="n">attrname_a</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">attrname</span><span class="p">)</span>

        <span class="c1"># Here we get all the data arrays</span>
        <span class="c1"># For this we only need the attrname</span>
        <span class="n">data_arrays_am</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
        <span class="n">data_units_am</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
        <span class="n">data_label_am</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
        <span class="n">data_keylabels_am</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
        <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span><span class="p">:</span>
            <span class="n">data</span><span class="p">,</span> <span class="n">data_unit</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_array</span><span class="p">(</span><span class="n">attrname</span><span class="p">,</span> <span class="n">desired_unit_args</span><span class="p">[</span><span class="n">ai</span><span class="p">])</span>
            <span class="n">data_arrays_am</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">data_units_am</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data_unit</span><span class="p">)</span>

            <span class="n">attr_label</span><span class="p">,</span> <span class="n">key_labels</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_array_labels</span><span class="p">(</span><span class="n">attrname</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="n">latex_labels</span><span class="p">)</span>
            <span class="n">data_label_am</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">attr_label</span><span class="p">)</span>
            <span class="n">data_keylabels_am</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key_labels</span><span class="p">)</span>


        <span class="c1"># Parse the key</span>
        <span class="c1"># Is the key is an element symbol it will extract all isotopes of that element from the data</span>
        <span class="c1"># Hence why we need to get the data arrays before this step</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
            <span class="c1"># Check if key is an integer index or slice</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^\s*(-?\d+)\s*$|^\s*(-?\d*)\s*:\s*(-?\d*)\s*(?::\s*(-?\d*))?\s*$&#39;</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">m</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span>
                    <span class="n">key</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>  <span class="c1"># Slice</span>
                    <span class="n">key</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                                <span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                                <span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span> <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
                <span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">key</span><span class="p">,)</span>
                <span class="n">keytype</span> <span class="o">=</span> <span class="s1">&#39;index&#39;</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">key</span><span class="p">,</span> <span class="n">keytype</span> <span class="o">=</span> <span class="n">parse_key_string</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">data_arrays_am</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">int</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">slice</span><span class="p">:</span>
            <span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">key</span><span class="p">,)</span>
            <span class="n">keytype</span> <span class="o">=</span> <span class="s1">&#39;index&#39;</span>
        <span class="k">elif</span> <span class="n">key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="p">)</span>
            <span class="n">keytype</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">key</span><span class="p">,</span> <span class="n">keytype</span> <span class="o">=</span> <span class="n">parse_key_string</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">data_arrays_am</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

        <span class="n">keys_ak</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="n">keytype_a</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">keytype</span><span class="p">)</span>

    <span class="c1"># Make sure the size of the keys is the same for all args</span>
    <span class="n">size</span> <span class="o">=</span> <span class="p">{</span><span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">keys_ak</span><span class="p">}</span>
    <span class="n">size</span><span class="o">.</span><span class="n">discard</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">size</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Length of indexes for not compatible </span><span class="si">{</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">attrname_a</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">size</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">lenkeys</span> <span class="o">=</span> <span class="n">size</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">lenkeys</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">for</span> <span class="n">ai</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">lenargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">keys_ak</span><span class="p">[</span><span class="n">ai</span><span class="p">])</span> <span class="o">!=</span> <span class="n">lenkeys</span><span class="p">:</span>
            <span class="c1"># current size can only be 1. Repeat until it is the correct length</span>
            <span class="n">keys_ak</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">keys_ak</span><span class="p">[</span><span class="n">ai</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">lenkeys</span><span class="p">)]</span>

    <span class="n">axis_label_args</span> <span class="o">=</span> <span class="p">[</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">label&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">axis_name_args</span><span class="p">]</span>
    <span class="n">axis_prefix_label_args</span> <span class="o">=</span> <span class="p">[</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">prefix_label&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">axis_name_args</span><span class="p">]</span>
    <span class="n">axis_suffix_label_args</span> <span class="o">=</span> <span class="p">[</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">suffix_label&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">axis_name_args</span><span class="p">]</span>
    <span class="n">label_args</span> <span class="o">=</span> <span class="n">one_per_n</span><span class="p">(</span><span class="n">lenmodels</span> <span class="o">*</span> <span class="n">lenkeys</span><span class="p">,</span> <span class="s1">&#39;datapoints&#39;</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>
    <span class="n">prefix_label_args</span> <span class="o">=</span> <span class="n">one_per_n</span><span class="p">(</span><span class="n">lenmodels</span> <span class="o">*</span> <span class="n">lenkeys</span><span class="p">,</span> <span class="s1">&#39;datapoints&#39;</span><span class="p">,</span> <span class="s1">&#39;prefix_label&#39;</span><span class="p">,</span> <span class="n">prefix_label</span><span class="p">)</span>
    <span class="n">suffix_label_args</span> <span class="o">=</span> <span class="n">one_per_n</span><span class="p">(</span><span class="n">lenmodels</span> <span class="o">*</span> <span class="n">lenkeys</span><span class="p">,</span> <span class="s1">&#39;datapoints&#39;</span><span class="p">,</span> <span class="s1">&#39;suffix_label&#39;</span><span class="p">,</span> <span class="n">suffix_label</span><span class="p">)</span>

    <span class="n">result_data</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">result_axis_label</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">data_labels_amk</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Get the arg label which can be used as an axis label</span>
    <span class="c1"># Get the data point label for each arg. These are all combined later</span>
    <span class="c1"># Model name is not added. It will be added once the individual arg labels have been joined</span>
    <span class="k">for</span> <span class="n">ai</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">lenargs</span><span class="p">):</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="n">keys_ak</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span>
        <span class="n">keytype</span> <span class="o">=</span> <span class="n">keytype_a</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span>

        <span class="c1"># Find common keys that can go into the arg label</span>
        <span class="k">if</span> <span class="n">keytype</span> <span class="o">==</span> <span class="s1">&#39;iso&#39;</span><span class="p">:</span>
            <span class="n">unique_keylabels</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">mi</span><span class="p">,</span> <span class="n">keylabels</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data_keylabels_am</span><span class="p">[</span><span class="n">ai</span><span class="p">]):</span>
                <span class="k">if</span> <span class="n">keylabels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data array &#39;</span><span class="si">{</span><span class="n">attrname_a</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39; of model &#39;</span><span class="si">{</span><span class="n">models</span><span class="p">[</span><span class="n">mi</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; is not a key array.&quot;</span><span class="p">)</span>
                <span class="n">unique_keylabels</span> <span class="o">=</span> <span class="p">{</span><span class="o">*</span><span class="n">unique_keylabels</span><span class="p">,</span> <span class="o">*</span><span class="p">(</span><span class="n">keylabels</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">)}</span>

            <span class="n">unique_keylabels</span><span class="o">.</span><span class="n">discard</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_keylabels</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="c1"># Same label for all data points</span>
                <span class="n">arg_label</span> <span class="o">=</span> <span class="n">unique_keylabels</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">key_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">key_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">if</span> <span class="n">axis_name_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">axis_name_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">arg_label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&lt;</span><span class="si">{</span><span class="n">axis_name_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span><span class="si">}</span><span class="s2">&gt;&quot;</span>
                <span class="k">if</span> <span class="n">key_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">key_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">if</span> <span class="n">axis_name_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">axis_name_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">elif</span> <span class="n">keytype</span> <span class="o">==</span> <span class="s1">&#39;rat&#39;</span><span class="p">:</span>
            <span class="n">unique_n_keylabels</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">unique_d_keylabels</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">keylabels</span> <span class="ow">in</span> <span class="n">data_keylabels_am</span><span class="p">[</span><span class="n">ai</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">keylabels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data array &#39;</span><span class="si">{</span><span class="n">attrname</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39; of model &#39;</span><span class="si">{</span><span class="n">models</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; is not a key array.&quot;</span><span class="p">)</span>

                <span class="n">unique_n_keylabels</span> <span class="o">=</span> <span class="p">{</span><span class="o">*</span><span class="n">unique_n_keylabels</span><span class="p">,</span> <span class="o">*</span><span class="p">(</span><span class="n">keylabels</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">k</span><span class="o">.</span><span class="n">numer</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">)}</span>
                <span class="n">unique_d_keylabels</span> <span class="o">=</span> <span class="p">{</span><span class="o">*</span><span class="n">unique_d_keylabels</span><span class="p">,</span> <span class="o">*</span><span class="p">(</span><span class="n">keylabels</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">k</span><span class="o">.</span><span class="n">denom</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">)}</span>

            <span class="n">unique_n_keylabels</span><span class="o">.</span><span class="n">discard</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="n">unique_d_keylabels</span><span class="o">.</span><span class="n">discard</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">key_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">numer_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">numer_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="o">=</span> <span class="n">key_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">denom_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">denom_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="o">=</span> <span class="n">key_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_n_keylabels</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_d_keylabels</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">arg_label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">unique_n_keylabels</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span><span class="si">}</span><span class="s2"> / </span><span class="si">{</span><span class="n">unique_d_keylabels</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="k">if</span> <span class="n">key_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">key_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">if</span> <span class="n">numer_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">numer_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">if</span> <span class="n">denom_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">denom_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">if</span> <span class="n">axis_name_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">axis_name_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_n_keylabels</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">arg_label</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">unique_n_keylabels</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span><span class="si">}</span><span class="s1"> / &lt;</span><span class="si">{</span><span class="n">axis_name_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span><span class="si">}</span><span class="s1">&gt;&#39;</span>
                <span class="k">if</span> <span class="n">key_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">key_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">if</span> <span class="n">numer_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">numer_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">if</span> <span class="n">denom_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">denom_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">if</span> <span class="n">axis_name_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">axis_name_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_d_keylabels</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">arg_label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&lt;</span><span class="si">{</span><span class="n">axis_name_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span><span class="si">}</span><span class="s2">&gt; / </span><span class="si">{</span><span class="n">unique_d_keylabels</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="k">if</span> <span class="n">key_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">key_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">if</span> <span class="n">numer_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">numer_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">if</span> <span class="n">denom_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">denom_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">if</span> <span class="n">axis_name_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">axis_name_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">arg_label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&lt;</span><span class="si">{</span><span class="n">axis_name_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span><span class="si">}</span><span class="s2">&gt;&quot;</span>
                <span class="k">if</span> <span class="n">key_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">key_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">if</span> <span class="n">numer_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">numer_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">if</span> <span class="n">denom_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">denom_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">if</span> <span class="n">axis_name_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">axis_name_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">arg_label</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

            <span class="c1"># Neither are possible so just set to False</span>
            <span class="n">key_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">axis_name_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># Create labels for each key</span>
        <span class="n">data_labels_amk</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
        <span class="k">if</span> <span class="n">keytype</span> <span class="o">==</span> <span class="s1">&#39;iso&#39;</span> <span class="ow">or</span> <span class="n">keytype</span> <span class="o">==</span> <span class="s1">&#39;rat&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">keylabels</span> <span class="ow">in</span> <span class="n">data_keylabels_am</span><span class="p">[</span><span class="n">ai</span><span class="p">]:</span>
                <span class="n">data_labels_amk</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_data_label</span><span class="p">(</span><span class="n">keylabels</span><span class="p">,</span> <span class="n">keys</span><span class="p">,</span>
                                                          <span class="n">key_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">],</span> <span class="n">numer_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">],</span> <span class="n">denom_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]))</span>
                <span class="k">if</span> <span class="n">attrname_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">attrname_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># No keys so just creates an empty label</span>
            <span class="n">data_labels_amk</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">([[</span><span class="s1">&#39;&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">lenkeys</span><span class="p">)]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">lenmodels</span><span class="p">)])</span>
            <span class="k">if</span> <span class="n">attrname_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">attrname_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="c1"># Add the unit either to arg label if common across all models or to each key label</span>
        <span class="c1"># [unit] added to the end of the string</span>
        <span class="k">if</span> <span class="n">unit_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">unique_data_units</span> <span class="o">=</span> <span class="p">{</span><span class="o">*</span><span class="n">data_units_am</span><span class="p">[</span><span class="n">ai</span><span class="p">]}</span>
            <span class="n">unique_data_units</span><span class="o">.</span><span class="n">discard</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_data_units</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">arg_label</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">arg_label</span><span class="si">}</span><span class="s1"> [</span><span class="si">{</span><span class="n">unique_data_units</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span><span class="si">}</span><span class="s1">]&#39;</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_data_units</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">mi</span><span class="p">,</span> <span class="n">arg_data_labels_k</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data_labels_amk</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
                    <span class="k">for</span> <span class="n">ki</span><span class="p">,</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">arg_data_labels_k</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">data_units_am</span><span class="p">[</span><span class="n">ai</span><span class="p">][</span><span class="n">mi</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="n">data_labels_amk</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">mi</span><span class="p">][</span><span class="n">ki</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s1"> [</span><span class="si">{</span><span class="n">data_units_am</span><span class="p">[</span><span class="n">ai</span><span class="p">][</span><span class="n">mi</span><span class="p">]</span><span class="si">}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

        <span class="c1"># Add the attrname either to arg label if common across all models or to each key label</span>
        <span class="c1"># arrname added to the start of the string</span>
        <span class="k">if</span> <span class="n">attrname_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]:</span>
            <span class="n">unique_data_label</span> <span class="o">=</span> <span class="p">{</span><span class="o">*</span><span class="n">data_label_am</span><span class="p">[</span><span class="n">ai</span><span class="p">]}</span>
            <span class="n">unique_data_label</span><span class="o">.</span><span class="n">discard</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_data_label</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">arg_label</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                    <span class="n">arg_label</span> <span class="o">=</span> <span class="n">unique_data_label</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">arg_label</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">unique_data_label</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span><span class="si">}</span><span class="s1"> | </span><span class="si">{</span><span class="n">arg_label</span><span class="si">}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_data_label</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">mi</span><span class="p">,</span> <span class="n">arg_data_labels_k</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data_labels_amk</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
                    <span class="k">for</span> <span class="n">ki</span><span class="p">,</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">arg_data_labels_k</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">data_label_am</span><span class="p">[</span><span class="n">ai</span><span class="p">][</span><span class="n">mi</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                                <span class="n">data_labels_amk</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">mi</span><span class="p">][</span><span class="n">ki</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_label_am</span><span class="p">[</span><span class="n">ai</span><span class="p">][</span><span class="n">mi</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">data_labels_amk</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">mi</span><span class="p">][</span><span class="n">ki</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">data_label_am</span><span class="p">[</span><span class="n">ai</span><span class="p">][</span><span class="n">mi</span><span class="p">]</span><span class="si">}</span><span class="s1"> | </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

        <span class="n">axis_label_arg</span> <span class="o">=</span> <span class="n">axis_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">axis_label_arg</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">prefix</span> <span class="o">=</span> <span class="n">axis_prefix_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span>
            <span class="n">suffix</span> <span class="o">=</span> <span class="n">axis_suffix_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">prefix</span><span class="p">:</span>
                <span class="n">arg_label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}{</span><span class="n">arg_label</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">if</span> <span class="n">suffix</span><span class="p">:</span>
                <span class="n">arg_label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">arg_label</span><span class="si">}{</span><span class="n">suffix</span><span class="si">}</span><span class="s2">&quot;</span>

            <span class="n">result_axis_label</span><span class="p">[</span><span class="n">axis_name_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]]</span> <span class="o">=</span> <span class="n">arg_label</span> <span class="ow">or</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result_axis_label</span><span class="p">[</span><span class="n">axis_name_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]]</span> <span class="o">=</span> <span class="n">axis_label_arg</span> <span class="ow">or</span> <span class="kc">None</span>

    <span class="k">for</span> <span class="n">mi</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">lenmodels</span><span class="p">):</span>
        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ki</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">lenkeys</span><span class="p">):</span>
            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">({})</span>

            <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="k">for</span> <span class="n">ai</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">lenargs</span><span class="p">):</span>
                <span class="n">data_array</span> <span class="o">=</span> <span class="n">data_arrays_am</span><span class="p">[</span><span class="n">ai</span><span class="p">][</span><span class="n">mi</span><span class="p">]</span>
                <span class="n">keytype</span> <span class="o">=</span> <span class="n">keytype_a</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span>

                <span class="k">if</span> <span class="n">keytype</span> <span class="o">==</span> <span class="s1">&#39;rat&#39;</span><span class="p">:</span>
                    <span class="n">key</span> <span class="o">=</span> <span class="n">keys_ak</span><span class="p">[</span><span class="n">ai</span><span class="p">][</span><span class="n">ki</span><span class="p">]</span>
                    <span class="n">n</span> <span class="o">=</span> <span class="n">get_data_index</span><span class="p">(</span><span class="n">data_array</span><span class="p">,</span> <span class="n">key</span><span class="o">.</span><span class="n">numer</span><span class="p">,</span> <span class="n">mi</span><span class="p">,</span> <span class="n">ai</span><span class="p">)</span>
                    <span class="n">d</span> <span class="o">=</span> <span class="n">get_data_index</span><span class="p">(</span><span class="n">data_array</span><span class="p">,</span> <span class="n">key</span><span class="o">.</span><span class="n">denom</span><span class="p">,</span> <span class="n">mi</span><span class="p">,</span> <span class="n">ai</span><span class="p">)</span>
                    <span class="n">data</span> <span class="o">=</span> <span class="n">n</span><span class="o">/</span><span class="n">d</span>

                <span class="k">elif</span> <span class="n">keytype</span> <span class="o">==</span> <span class="s1">&#39;iso&#39;</span> <span class="ow">or</span> <span class="n">keytype</span> <span class="o">==</span> <span class="s1">&#39;index&#39;</span><span class="p">:</span>
                    <span class="n">key</span> <span class="o">=</span> <span class="n">keys_ak</span><span class="p">[</span><span class="n">ai</span><span class="p">][</span><span class="n">ki</span><span class="p">]</span>
                    <span class="n">data</span> <span class="o">=</span> <span class="n">get_data_index</span><span class="p">(</span><span class="n">data_array</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">mi</span><span class="p">,</span> <span class="n">ai</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span> <span class="c1"># keytype == &#39;none&#39;</span>
                    <span class="n">data</span> <span class="o">=</span> <span class="n">data_array</span>

                <span class="n">results</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">axis_name_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]]</span> <span class="o">=</span> <span class="n">data</span>

                <span class="n">data_label</span> <span class="o">=</span> <span class="n">data_labels_amk</span><span class="p">[</span><span class="n">ai</span><span class="p">][</span><span class="n">mi</span><span class="p">][</span><span class="n">ki</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">data_label</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">axis_name_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]:</span>
                        <span class="n">label</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;&lt;</span><span class="si">{</span><span class="n">axis_name_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">data_label</span><span class="si">}</span><span class="s2">&gt;&quot;</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">label</span> <span class="o">+=</span> <span class="n">data_label</span>

            <span class="k">if</span> <span class="n">mask_args</span><span class="p">[</span><span class="n">mi</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">imask</span> <span class="o">=</span> <span class="n">models</span><span class="p">[</span><span class="n">mi</span><span class="p">]</span><span class="o">.</span><span class="n">get_mask</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="o">**</span><span class="n">results</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">mask_na_args</span><span class="p">[</span><span class="n">mi</span><span class="p">]</span> <span class="ow">and</span> <span class="kc">False</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">results</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
                    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">results</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                        <span class="n">v</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                        <span class="n">v</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">logical_not</span><span class="p">(</span><span class="n">imask</span><span class="p">)]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
                        <span class="n">results</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">results</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                        <span class="n">results</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">imask</span><span class="p">]</span>

            <span class="n">label_arg</span> <span class="o">=</span> <span class="n">label_args</span><span class="p">[(</span><span class="n">mi</span> <span class="o">*</span> <span class="n">lenkeys</span><span class="p">)</span> <span class="o">+</span> <span class="n">ki</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">label_arg</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">prefix</span> <span class="o">=</span> <span class="n">prefix_label_args</span><span class="p">[</span><span class="n">mi</span> <span class="o">*</span> <span class="n">lenkeys</span> <span class="o">+</span> <span class="n">ki</span><span class="p">]</span>
                <span class="n">suffix</span> <span class="o">=</span> <span class="n">suffix_label_args</span><span class="p">[</span><span class="n">mi</span> <span class="o">*</span> <span class="n">lenkeys</span> <span class="o">+</span> <span class="n">ki</span><span class="p">]</span>

                <span class="k">if</span> <span class="n">model_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="ow">or</span> <span class="p">(</span><span class="n">model_in_label_args</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">lenmodels</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">label</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                        <span class="n">label</span> <span class="o">=</span> <span class="n">models</span><span class="p">[</span><span class="n">mi</span><span class="p">]</span><span class="o">.</span><span class="n">name</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s1"> (</span><span class="si">{</span><span class="n">models</span><span class="p">[</span><span class="n">mi</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
                    <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}{</span><span class="n">label</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">suffix</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
                    <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">label</span><span class="si">}{</span><span class="n">suffix</span><span class="si">}</span><span class="s2">&quot;</span>

                <span class="n">results</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">label</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="ow">or</span> <span class="kc">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">results</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">label_arg</span> <span class="ow">or</span> <span class="kc">None</span>

        <span class="n">result_data</span><span class="p">[</span><span class="n">models</span><span class="p">[</span><span class="n">mi</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">result_data</span><span class="p">,</span> <span class="n">result_axis_label</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="simple.plotting.get_models" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">simple.plotting.get_models</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_models</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">where_kwargs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Return a selection of models.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>models</code></b>
              (<code><span title="ModelCollection">ModelCollection</span></code>)
          –
          <div class="doc-md-description">
            <p>A collection of models.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>where</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Only models fitting this criteria will be selected. If not given all models are selected.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>**where_kwargs</code></b>
          –
          <div class="doc-md-description">
            <p>Keyword arguments to go with the <code>where</code> string.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>ModelCollection</code></b>          –
          <div class="doc-md-description">
            <p>The selected models</p>
          </div>
        </li>
    </ul>


            <details class="quote">
              <summary>Source code in <code>simple/plotting.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_models</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">where_kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a selection of models.</span>

<span class="sd">    Args:</span>
<span class="sd">        models (ModelCollection): A collection of models.</span>
<span class="sd">        where (str): Only models fitting this criteria will be selected. If not given all models are selected.</span>
<span class="sd">        **where_kwargs (): Keyword arguments to go with the ``where`` string.</span>

<span class="sd">    Returns:</span>
<span class="sd">        ModelCollection: The selected models</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">simple</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">ModelCollection</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;models must be a ModelCollection object not </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">models</span><span class="p">)</span><span class="si">}</span><span class="s1">.&#39;</span><span class="p">)</span>

    <span class="c1"># select models</span>
    <span class="k">if</span> <span class="n">where</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">models</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">where</span><span class="p">,</span> <span class="o">**</span><span class="n">where_kwargs</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">models</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="simple.plotting.mcontour" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">simple.plotting.mcontour</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">mcontour</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">xkey</span><span class="p">,</span> <span class="n">ykey</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">default_attrname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">weights_default_attrname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">weights_unit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">weights_default_value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">where_kwargs</span><span class="o">=</span><span class="p">{},</span> <span class="n">legend</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">update_ax</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">update_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Contour plot on a rose diagram.</p>


            <details class="quote">
              <summary>Source code in <code>simple/plotting.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2044</span>
<span class="normal">2045</span>
<span class="normal">2046</span>
<span class="normal">2047</span>
<span class="normal">2048</span>
<span class="normal">2049</span>
<span class="normal">2050</span>
<span class="normal">2051</span>
<span class="normal">2052</span>
<span class="normal">2053</span>
<span class="normal">2054</span>
<span class="normal">2055</span>
<span class="normal">2056</span>
<span class="normal">2057</span>
<span class="normal">2058</span>
<span class="normal">2059</span>
<span class="normal">2060</span>
<span class="normal">2061</span>
<span class="normal">2062</span>
<span class="normal">2063</span>
<span class="normal">2064</span>
<span class="normal">2065</span>
<span class="normal">2066</span>
<span class="normal">2067</span>
<span class="normal">2068</span>
<span class="normal">2069</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@utils</span><span class="o">.</span><span class="n">add_shortcut</span><span class="p">(</span><span class="s1">&#39;stdnorm&#39;</span><span class="p">,</span> <span class="n">default_attrname</span> <span class="o">=</span><span class="s1">&#39;stdnorm.Ri&#39;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="nd">@utils</span><span class="o">.</span><span class="n">add_shortcut</span><span class="p">(</span><span class="s1">&#39;intnorm&#39;</span><span class="p">,</span> <span class="n">default_attrname</span><span class="o">=</span><span class="s1">&#39;intnorm.eRi&#39;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="nd">@utils</span><span class="o">.</span><span class="n">set_default_kwargs</span><span class="p">(</span>
    <span class="n">ax_kw_ylabel_labelpad</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">legend_outside</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">rose_colorbar_show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bar_outline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">linestyle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">fixed_model_linestyle</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">fixed_model_color</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">fixed_model_marker</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">mcontour</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">xkey</span><span class="p">,</span> <span class="n">ykey</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
             <span class="n">default_attrname</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">weights_default_attrname</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">weights_unit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">weights_default_value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
             <span class="n">mask</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">where_kwargs</span><span class="o">=</span><span class="p">{},</span>
             <span class="n">legend</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">update_ax</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">update_fig</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
             <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Contour plot on a rose diagram.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ax</span><span class="p">,</span> <span class="n">models</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">modeldata_xy</span><span class="p">,</span> <span class="n">modeldata_w</span><span class="p">,</span> <span class="n">kwargs</span> <span class="o">=</span> <span class="n">_mprep</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">xkey</span><span class="p">,</span> <span class="n">ykey</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span>
                                                            <span class="n">default_attrname</span><span class="o">=</span><span class="n">default_attrname</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">unit</span><span class="p">,</span>
                                                            <span class="n">weights_default_attrname</span><span class="o">=</span><span class="n">weights_default_attrname</span><span class="p">,</span>
                                                            <span class="n">weights_unit</span><span class="o">=</span><span class="n">weights_unit</span><span class="p">,</span> <span class="n">weights_default_value</span><span class="o">=</span><span class="n">weights_default_value</span><span class="p">,</span>
                                                            <span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">where</span><span class="p">,</span> <span class="n">where_kwargs</span><span class="o">=</span><span class="n">where_kwargs</span><span class="p">,</span>
                                                            <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">_mcontour</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">modeldata_xy</span><span class="p">,</span> <span class="n">modeldata_w</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span> <span class="n">update_ax</span><span class="o">=</span><span class="n">update_ax</span><span class="p">,</span> <span class="n">update_fig</span><span class="o">=</span><span class="n">update_fig</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="simple.plotting.mhist" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">simple.plotting.mhist</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">mhist</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">xkey</span><span class="p">,</span> <span class="n">ykey</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">default_attrname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">weights_default_attrname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">weights_unit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">weights_default_value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">where_kwargs</span><span class="o">=</span><span class="p">{},</span> <span class="n">legend</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">update_ax</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">update_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Histogram plot on a rose diagram.</p>


            <details class="quote">
              <summary>Source code in <code>simple/plotting.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2019</span>
<span class="normal">2020</span>
<span class="normal">2021</span>
<span class="normal">2022</span>
<span class="normal">2023</span>
<span class="normal">2024</span>
<span class="normal">2025</span>
<span class="normal">2026</span>
<span class="normal">2027</span>
<span class="normal">2028</span>
<span class="normal">2029</span>
<span class="normal">2030</span>
<span class="normal">2031</span>
<span class="normal">2032</span>
<span class="normal">2033</span>
<span class="normal">2034</span>
<span class="normal">2035</span>
<span class="normal">2036</span>
<span class="normal">2037</span>
<span class="normal">2038</span>
<span class="normal">2039</span>
<span class="normal">2040</span>
<span class="normal">2041</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@utils</span><span class="o">.</span><span class="n">add_shortcut</span><span class="p">(</span><span class="s1">&#39;stdnorm&#39;</span><span class="p">,</span> <span class="n">default_attrname</span> <span class="o">=</span><span class="s1">&#39;stdnorm.Ri&#39;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="nd">@utils</span><span class="o">.</span><span class="n">add_shortcut</span><span class="p">(</span><span class="s1">&#39;intnorm&#39;</span><span class="p">,</span> <span class="n">default_attrname</span><span class="o">=</span><span class="s1">&#39;intnorm.eRi&#39;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="nd">@utils</span><span class="o">.</span><span class="n">set_default_kwargs</span><span class="p">(</span>
    <span class="n">ax_kw_ylabel_labelpad</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">rose_colorbar_show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">legend_outside</span><span class="o">=</span><span class="kc">True</span><span class="p">,)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">mhist</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">xkey</span><span class="p">,</span> <span class="n">ykey</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
          <span class="n">default_attrname</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
          <span class="n">weights_default_attrname</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">weights_unit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">weights_default_value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
          <span class="n">mask</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">where_kwargs</span><span class="o">=</span><span class="p">{},</span>
          <span class="n">legend</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">update_ax</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">update_fig</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
          <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Histogram plot on a rose diagram.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ax</span><span class="p">,</span> <span class="n">models</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">modeldata_xy</span><span class="p">,</span> <span class="n">modeldata_w</span><span class="p">,</span> <span class="n">kwargs</span> <span class="o">=</span> <span class="n">_mprep</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">xkey</span><span class="p">,</span> <span class="n">ykey</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span>
                                                      <span class="n">default_attrname</span><span class="o">=</span><span class="n">default_attrname</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">unit</span><span class="p">,</span>
                                                      <span class="n">weights_default_attrname</span><span class="o">=</span><span class="n">weights_default_attrname</span><span class="p">,</span>
                                                      <span class="n">weights_unit</span><span class="o">=</span><span class="n">weights_unit</span><span class="p">,</span> <span class="n">weights_default_value</span><span class="o">=</span><span class="n">weights_default_value</span><span class="p">,</span>
                                                      <span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">where</span><span class="p">,</span> <span class="n">where_kwargs</span><span class="o">=</span><span class="n">where_kwargs</span><span class="p">,</span>
                                                      <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">_mhist</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">modeldata_xy</span><span class="p">,</span> <span class="n">modeldata_w</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span> <span class="n">update_ax</span><span class="o">=</span><span class="n">update_ax</span><span class="p">,</span> <span class="n">update_fig</span><span class="o">=</span><span class="n">update_fig</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="simple.plotting.parse_lscm" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">simple.plotting.parse_lscm</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">parse_lscm</span><span class="p">(</span><span class="n">linestyle</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Convert the <code>linestyle</code>, <code>color</code> and <code>marker</code> arguments into [EndlessList][simple.plot.EndlessList]
objects for plotting.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>linestyle</code></b>
          –
          <div class="doc-md-description">
            <p>Either a single line style or a list of line styles. If <code>True</code> then the
[default line styles][simple.plot.default_linestyles] is returned. If <code>False</code> or <code>None</code> a list
containing only the no line sentinel is returned.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>color</code></b>
          –
          <div class="doc-md-description">
            <p>Single colour or a list of colours. If <code>True</code> then the
[default colors][simple.plot.default_colors] is returned. If <code>False</code> or <code>None</code> a list
containing only the color black is returned.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>marker</code></b>
          –
          <div class="doc-md-description">
            <p>Either a marker shape or a list of marker shapes. If <code>True</code> then the
[default marker shapes][simple.plot.default_markers] shapes is returned. If <code>False</code> or <code>None</code> a
list containing only the no marker sentinel is returned.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code>(<span title="EndlessList">EndlessList</span>, <span title="EndlessList">EndlessList</span>, <span title="EndlessList">EndlessList</span>)</code>
          –
          <div class="doc-md-description">
            <p>linestyles, colors, markers</p>
          </div>
        </li>
    </ul>


            <details class="quote">
              <summary>Source code in <code>simple/plotting.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">parse_lscm</span><span class="p">(</span><span class="n">linestyle</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert the ``linestyle``, ``color`` and ``marker`` arguments into [EndlessList][simple.plot.EndlessList]</span>
<span class="sd">    objects for plotting.</span>

<span class="sd">    Args:</span>
<span class="sd">        linestyle (): Either a single line style or a list of line styles. If ``True`` then the</span>
<span class="sd">            [default line styles][simple.plot.default_linestyles] is returned. If ``False`` or ``None`` a list</span>
<span class="sd">            containing only the no line sentinel is returned.</span>
<span class="sd">        color (): Single colour or a list of colours. If ``True`` then the</span>
<span class="sd">            [default colors][simple.plot.default_colors] is returned. If ``False`` or ``None`` a list</span>
<span class="sd">            containing only the color black is returned.</span>
<span class="sd">        marker (): Either a marker shape or a list of marker shapes. If ``True`` then the</span>
<span class="sd">            [default marker shapes][simple.plot.default_markers] shapes is returned. If ``False`` or ``None`` a</span>
<span class="sd">            list containing only the no marker sentinel is returned.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (EndlessList, EndlessList, EndlessList): linestyles, colors, markers</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="kc">False</span> <span class="ow">or</span> <span class="n">color</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">EndlessList</span><span class="p">([</span><span class="s2">&quot;#000000&quot;</span><span class="p">])</span>
    <span class="k">elif</span> <span class="n">color</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="n">default_colors</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">EndlessList</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">linestyle</span> <span class="ow">is</span> <span class="kc">False</span> <span class="ow">or</span> <span class="n">linestyle</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">linestyles</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">EndlessList</span><span class="p">([</span><span class="s2">&quot;&quot;</span><span class="p">])</span>
    <span class="k">elif</span> <span class="n">linestyle</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">linestyles</span> <span class="o">=</span> <span class="n">default_linestyles</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">linestyles</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">EndlessList</span><span class="p">(</span><span class="n">linestyle</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">marker</span> <span class="ow">is</span> <span class="kc">False</span> <span class="ow">or</span> <span class="n">marker</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">markers</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">EndlessList</span><span class="p">([</span><span class="s2">&quot;&quot;</span><span class="p">])</span>
    <span class="k">elif</span> <span class="n">marker</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">markers</span> <span class="o">=</span> <span class="n">default_markers</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">markers</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">EndlessList</span><span class="p">(</span><span class="n">marker</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">linestyles</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">markers</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="simple.plotting.plot" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">simple.plotting.plot</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">plot</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">xkey</span><span class="p">,</span> <span class="n">ykey</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">default_attrname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mask_na</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">update_ax</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">update_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Plot <em>xkey</em> against <em>ykey</em> for each model in `<em>models</em>.</p>
<p>It is possible to plot multiple datasets if <em>xkey</em> and/or <em>ykey</em> is a list of multiple keys for a isotope key
array. If only one of the arguments is a list then the second argument will be reused for each dataset. If a key
is not present in an array then a default value is used. See <a href="simple.get_data"><code>get_data</code></a> for more details.</p>
<p>The data to be plotted is retrieved using the <a href="simple.get_data"><code>get_data</code></a> function. All arguments available
for that function not included in the argument list here can be given as one of the <em>kwargs</em> to this function.</p>
<p>The data will be plotted using matplotlib's <code>plot</code> function. Additional arguments to this function can be
passed as one of the <em>kwargs</em> to this function. Some  <code>plot</code> arguments have enhanced behaviour detailed in a
section below.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>models</code></b>
          –
          <div class="doc-md-description">
            <p>A collection of models to plot. A subselection of these models can be made using the <em>where</em>
argument.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>xkey,</code></b>
              (<code>ykey (str, int, slice</code>)
          –
          <div class="doc-md-description">
            <p>This can either be a valid index to the <em>default_attrname</em> array or the path, with
or without a valid index, of a different attribute. See <a href="simple.get_data"><code>get_data</code></a> for more details.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>default_attrname</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>The name of the default attribute to use if <em>xkey</em> and <em>ykey</em> are indexes.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>unit</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>The desired unit for the <em>xkey</em> and <em>ykey</em>. Different units for <em>xkey</em> and <em>ykey</em> can be specified
by supplying a <code>(&lt;xkey_unit&gt;, &lt;ykey_unit&gt;)</code> sequence.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>where</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>If given will be used to create a subselection of <em>models</em>. Any <em>kwargs</em> prefixed
with <code>where_</code> will be supplied as keyword arguments. See
 <a href="simple.models.ModelCollection.where"><code>ModelCollection.where</code></a> for more details.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>mask</code></b>
              (<code>(<span title="str">str</span>, <span title="int">int</span>, <span title="slice">slice</span>)</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Can be used to apply a mask to the data which is plotted. See the <code>get_mask</code> function of the Model
object.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>mask_na</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>If <code>True</code> masked values will be replaced by <code>np.nan</code> values. Only works if both <em>xkey</em> and
<em>ykey</em> have a float based datatype.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>ax</code></b>
          –
          <div class="doc-md-description">
            <p>The axes where the data is plotted. Accepted values are any matplotlib Axes object or plt instance.
Defaults to <code>plt.gca()</code>.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>legend</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to create a legend. By default, a legend will be created if one or more datapoints have
a valid label.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>update_ax,</code></b>
              (<code>update_fig (bool</code>)
          –
          <div class="doc-md-description">
            <p>Whether to update the axes and figure objects using kwargs that have the prefix
<code>ax_</code> and <code>fig_</code>. See <a href="simple.plotting.update_axes"><code>simple.plotting.update_axes</code></a> for more details.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>**kwargs</code></b>
          –
          <div class="doc-md-description">
            <p>Valid keyword arguments are those using one of the prefixes define by other arguments, any argument
for the <a href="simple.get_data"><code>simple.get_data</code></a> function, or any valid keyword argument for
matplotlib's <code>plot</code> function.</p>
          </div>
        </li>
    </ul>


<details class="data-and-axis-labels" open>
  <summary>Data and axis labels</summary>
  <p>Labels for each axis and individual datapoints will be automatically generated. By default, the axis labels
will contain the information common to all datasets while the label for the individual datapoints will contain
only the unique information. You can override the axis labels by passing <code>ax_xlabel</code> and <code>ax_ylabel</code> as
one of the <em>kwargs</em>. You can also override the datapoint labels by passing a list of labels, one each
for each datapoint in the legend. See <a href="simple.get_data"><code>get_data</code></a> for more details on customising the
labels.</p>
</details>

<details class="iterable-plot-arguments" open>
  <summary>Iterable plot arguments</summary>
  <p>The following arguments for matplotlibs <code>plot</code> function have enhanced behaviour that allows them to be
iterated through when plotting different models and/or datasets.</p>
<ul>
<li>
<p><code>linestyle</code> Can be a list of linestyles that will be iterated through. If <code>True</code> simple's predefined
list of linestyles is used. If <code>False</code> no lines will be shown.</p>
</li>
<li>
<p><code>color</code> Can be a list of colors that will be iterated through. If <code>True</code> simple's predefined
list of colors is used. If <code>False</code> the colour defaults to black.</p>
</li>
<li>
<p><code>marker</code> Can be a list of markers that will be iterated through. If <code>True</code> simple's predefined
list of markers is used. If <code>False</code> no markers will be shown.</p>
</li>
</ul>
<p>There are two ways these values can be iterated through. Either all the datapoints of a given model gets the
same value or each set of datapoints across the different models gets the same value. By default, if there are
multiple models then all the datasets for each model will have the same <em>color</em>. If there is only one model
then the color will be different for the different datasets. If there are multiple datasets then each dataset
across the different models will have the same <em>linestyle</em> and <em>marker</em>. If there is only one dataset then
<em>linestyle</em> and <em>marker</em> will be different for each model.</p>
<p>This behaviour can be changed by passing <code>fixed_model_linestyle</code>, <code>fixed_model_color</code>
and <code>fixed_model_marker</code> keyword arguments set to either <code>True</code> or <code>False</code> If <code>True</code> each model will
have the same value. If <code>False</code> each dataset across the different models will have the same value.</p>
</details>

<details class="default-kwargs-and-shortcuts" open>
  <summary>Default kwargs and shortcuts</summary>
  <p>The default values for arguments can be updated by changing the  <code>plot.default_kwargs</code> dictionary. Any
argument not defined in the function description will be included in <em>kwargs</em>. Default values given in the
function definition will be used only if a default value does not exist in <code>plot.default_kwargs</code>.
Additionally, one or more shortcuts with additional/different default values are attached to this function.
The following shortcuts exist for this function:</p>
<ul>
<li>
<p><code>plot.intnorm</code> Default values to plot internally normalised data. This sets <em>default_attrname</em> to
    <code>intnorm</code> and the <code>default_unit</code> to <code>None</code>.</p>
</li>
<li>
<p><code>plot.stdnorm</code> Default values to plot the basic ratio normalised data. This sets
        <em>default_attrname</em> to <code>stdnorm</code> and the <code>default_unit</code> to <code>None</code>.</p>
</li>
</ul>
</details>

<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          –
          <div class="doc-md-description">
            <p>The axes where the data was plotted.</p>
          </div>
        </li>
    </ul>


            <details class="quote">
              <summary>Source code in <code>simple/plotting.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1531</span>
<span class="normal">1532</span>
<span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span>
<span class="normal">1554</span>
<span class="normal">1555</span>
<span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span>
<span class="normal">1602</span>
<span class="normal">1603</span>
<span class="normal">1604</span>
<span class="normal">1605</span>
<span class="normal">1606</span>
<span class="normal">1607</span>
<span class="normal">1608</span>
<span class="normal">1609</span>
<span class="normal">1610</span>
<span class="normal">1611</span>
<span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span>
<span class="normal">1629</span>
<span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span>
<span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span>
<span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span>
<span class="normal">1647</span>
<span class="normal">1648</span>
<span class="normal">1649</span>
<span class="normal">1650</span>
<span class="normal">1651</span>
<span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span>
<span class="normal">1655</span>
<span class="normal">1656</span>
<span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span>
<span class="normal">1660</span>
<span class="normal">1661</span>
<span class="normal">1662</span>
<span class="normal">1663</span>
<span class="normal">1664</span>
<span class="normal">1665</span>
<span class="normal">1666</span>
<span class="normal">1667</span>
<span class="normal">1668</span>
<span class="normal">1669</span>
<span class="normal">1670</span>
<span class="normal">1671</span>
<span class="normal">1672</span>
<span class="normal">1673</span>
<span class="normal">1674</span>
<span class="normal">1675</span>
<span class="normal">1676</span>
<span class="normal">1677</span>
<span class="normal">1678</span>
<span class="normal">1679</span>
<span class="normal">1680</span>
<span class="normal">1681</span>
<span class="normal">1682</span>
<span class="normal">1683</span>
<span class="normal">1684</span>
<span class="normal">1685</span>
<span class="normal">1686</span>
<span class="normal">1687</span>
<span class="normal">1688</span>
<span class="normal">1689</span>
<span class="normal">1690</span>
<span class="normal">1691</span>
<span class="normal">1692</span>
<span class="normal">1693</span>
<span class="normal">1694</span>
<span class="normal">1695</span>
<span class="normal">1696</span>
<span class="normal">1697</span>
<span class="normal">1698</span>
<span class="normal">1699</span>
<span class="normal">1700</span>
<span class="normal">1701</span>
<span class="normal">1702</span>
<span class="normal">1703</span>
<span class="normal">1704</span>
<span class="normal">1705</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@utils</span><span class="o">.</span><span class="n">add_shortcut</span><span class="p">(</span><span class="s1">&#39;abundance&#39;</span><span class="p">,</span> <span class="n">default_attrname</span> <span class="o">=</span><span class="s1">&#39;abundance&#39;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="nd">@utils</span><span class="o">.</span><span class="n">add_shortcut</span><span class="p">(</span><span class="s1">&#39;stdnorm&#39;</span><span class="p">,</span> <span class="n">default_attrname</span> <span class="o">=</span><span class="s1">&#39;stdnorm.Ri&#39;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="nd">@utils</span><span class="o">.</span><span class="n">add_shortcut</span><span class="p">(</span><span class="s1">&#39;intnorm&#39;</span><span class="p">,</span> <span class="n">default_attrname</span><span class="o">=</span><span class="s1">&#39;intnorm.eRi&#39;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="nd">@utils</span><span class="o">.</span><span class="n">set_default_kwargs</span><span class="p">(</span>
    <span class="n">linestyle</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">fixed_model_linestyle</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">fixed_model_color</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">fixed_model_marker</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">ax_kw_xlabel_fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
    <span class="n">ax_kw_ylabel_fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
    <span class="n">markersize</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">legend_outside</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">ax_tick_params</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="n">fig_size</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mf">6.5</span><span class="p">),</span>
    <span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">xkey</span><span class="p">,</span> <span class="n">ykey</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
         <span class="n">default_attrname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
         <span class="n">where</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mask</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">mask_na</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
         <span class="n">legend</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">update_ax</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">update_fig</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
         <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot *xkey* against *ykey* for each model in `*models*.</span>

<span class="sd">    It is possible to plot multiple datasets if *xkey* and/or *ykey* is a list of multiple keys for a isotope key</span>
<span class="sd">    array. If only one of the arguments is a list then the second argument will be reused for each dataset. If a key</span>
<span class="sd">    is not present in an array then a default value is used. See [``get_data``](simple.get_data) for more details.</span>

<span class="sd">    The data to be plotted is retrieved using the [``get_data``](simple.get_data) function. All arguments available</span>
<span class="sd">    for that function not included in the argument list here can be given as one of the *kwargs* to this function.</span>

<span class="sd">    The data will be plotted using matplotlib&#39;s ``plot`` function. Additional arguments to this function can be</span>
<span class="sd">    passed as one of the *kwargs* to this function. Some  ``plot`` arguments have enhanced behaviour detailed in a</span>
<span class="sd">    section below.</span>

<span class="sd">    Args:</span>
<span class="sd">        models (): A collection of models to plot. A subselection of these models can be made using the *where*</span>
<span class="sd">            argument.</span>
<span class="sd">        xkey, ykey (str, int, slice): This can either be a valid index to the *default_attrname* array or the path, with</span>
<span class="sd">            or without a valid index, of a different attribute. See [``get_data``](simple.get_data) for more details.</span>
<span class="sd">        default_attrname (str): The name of the default attribute to use if *xkey* and *ykey* are indexes.</span>
<span class="sd">        unit (str): The desired unit for the *xkey* and *ykey*. Different units for *xkey* and *ykey* can be specified</span>
<span class="sd">            by supplying a ``(&lt;xkey_unit&gt;, &lt;ykey_unit&gt;)`` sequence.</span>
<span class="sd">        where (str): If given will be used to create a subselection of *models*. Any *kwargs* prefixed</span>
<span class="sd">            with ``where_`` will be supplied as keyword arguments. See</span>
<span class="sd">             [``ModelCollection.where``](simple.models.ModelCollection.where) for more details.</span>
<span class="sd">        mask (str, int, slice): Can be used to apply a mask to the data which is plotted. See the ``get_mask`` function of the Model</span>
<span class="sd">            object.</span>
<span class="sd">        mask_na (bool): If ``True`` masked values will be replaced by ``np.nan`` values. Only works if both *xkey* and</span>
<span class="sd">            *ykey* have a float based datatype.</span>
<span class="sd">        ax (): The axes where the data is plotted. Accepted values are any matplotlib Axes object or plt instance.</span>
<span class="sd">            Defaults to ``plt.gca()``.</span>
<span class="sd">        legend (bool): Whether to create a legend. By default, a legend will be created if one or more datapoints have</span>
<span class="sd">            a valid label.</span>
<span class="sd">        update_ax, update_fig (bool): Whether to update the axes and figure objects using kwargs that have the prefix</span>
<span class="sd">            ``ax_`` and ``fig_``. See [``simple.plotting.update_axes``](simple.plotting.update_axes) for more details.</span>
<span class="sd">        **kwargs ():</span>
<span class="sd">            Valid keyword arguments are those using one of the prefixes define by other arguments, any argument</span>
<span class="sd">            for the [``simple.get_data``](simple.get_data) function, or any valid keyword argument for</span>
<span class="sd">            matplotlib&#39;s ``plot`` function.</span>

<span class="sd">    Data and axis labels:</span>
<span class="sd">        Labels for each axis and individual datapoints will be automatically generated. By default, the axis labels</span>
<span class="sd">        will contain the information common to all datasets while the label for the individual datapoints will contain</span>
<span class="sd">        only the unique information. You can override the axis labels by passing ``ax_xlabel`` and ``ax_ylabel`` as</span>
<span class="sd">        one of the *kwargs*. You can also override the datapoint labels by passing a list of labels, one each</span>
<span class="sd">        for each datapoint in the legend. See [``get_data``](simple.get_data) for more details on customising the</span>
<span class="sd">        labels.</span>


<span class="sd">    Iterable plot arguments:</span>
<span class="sd">        The following arguments for matplotlibs ``plot`` function have enhanced behaviour that allows them to be</span>
<span class="sd">        iterated through when plotting different models and/or datasets.</span>

<span class="sd">        - ``linestyle`` Can be a list of linestyles that will be iterated through. If ``True`` simple&#39;s predefined</span>
<span class="sd">        list of linestyles is used. If ``False`` no lines will be shown.</span>

<span class="sd">        - ``color`` Can be a list of colors that will be iterated through. If ``True`` simple&#39;s predefined</span>
<span class="sd">        list of colors is used. If ``False`` the colour defaults to black.</span>

<span class="sd">        - ``marker`` Can be a list of markers that will be iterated through. If ``True`` simple&#39;s predefined</span>
<span class="sd">        list of markers is used. If ``False`` no markers will be shown.</span>

<span class="sd">        There are two ways these values can be iterated through. Either all the datapoints of a given model gets the</span>
<span class="sd">        same value or each set of datapoints across the different models gets the same value. By default, if there are</span>
<span class="sd">        multiple models then all the datasets for each model will have the same *color*. If there is only one model</span>
<span class="sd">        then the color will be different for the different datasets. If there are multiple datasets then each dataset</span>
<span class="sd">        across the different models will have the same *linestyle* and *marker*. If there is only one dataset then</span>
<span class="sd">        *linestyle* and *marker* will be different for each model.</span>

<span class="sd">        This behaviour can be changed by passing ``fixed_model_linestyle``, ``fixed_model_color``</span>
<span class="sd">        and ``fixed_model_marker`` keyword arguments set to either ``True`` or ``False`` If ``True`` each model will</span>
<span class="sd">        have the same value. If ``False`` each dataset across the different models will have the same value.</span>

<span class="sd">    Default kwargs and shortcuts:</span>
<span class="sd">        The default values for arguments can be updated by changing the  ``plot.default_kwargs`` dictionary. Any</span>
<span class="sd">        argument not defined in the function description will be included in *kwargs*. Default values given in the</span>
<span class="sd">        function definition will be used only if a default value does not exist in ``plot.default_kwargs``.</span>
<span class="sd">        Additionally, one or more shortcuts with additional/different default values are attached to this function.</span>
<span class="sd">        The following shortcuts exist for this function:</span>

<span class="sd">        - ``plot.intnorm`` Default values to plot internally normalised data. This sets *default_attrname* to</span>
<span class="sd">            ``intnorm`` and the ``default_unit`` to ``None``.</span>

<span class="sd">        - ``plot.stdnorm`` Default values to plot the basic ratio normalised data. This sets</span>
<span class="sd">                *default_attrname* to ``stdnorm`` and the ``default_unit`` to ``None``.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The axes where the data was plotted.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">get_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>  <span class="c1"># We are working on the axes object proper</span>

    <span class="n">where_kwargs</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">extract_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;where&#39;</span><span class="p">)</span>
    <span class="n">models</span> <span class="o">=</span> <span class="n">get_models</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">where</span><span class="p">,</span> <span class="n">where_kwargs</span><span class="o">=</span><span class="n">where_kwargs</span><span class="p">)</span>

    <span class="c1"># Get the linestyle, color and marker for each thing to be plotted.</span>
    <span class="n">linestyles</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">markers</span> <span class="o">=</span> <span class="n">parse_lscm</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;linestyle&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">),</span>
                                             <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;color&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">),</span>
                                             <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;marker&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">))</span>
    <span class="n">fixed_model_linestyle</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;fixed_model_linestyle&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">fixed_model_color</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;fixed_model_color&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">fixed_model_marker</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;fixed_model_marker&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="n">legend_kwargs</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">extract_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;legend&#39;</span><span class="p">)</span>

    <span class="n">label_kwargs</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">extract_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="s1">&#39;prefix_label&#39;</span><span class="p">,</span> <span class="s1">&#39;suffix_label&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;key_in_label&#39;</span><span class="p">,</span> <span class="s1">&#39;numer_in_label&#39;</span><span class="p">,</span> <span class="s1">&#39;denom_in_label&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;model_in_label&#39;</span><span class="p">,</span> <span class="s1">&#39;unit_in_label&#39;</span><span class="p">,</span> <span class="s1">&#39;attrname_in_label&#39;</span><span class="p">)</span>

    <span class="c1"># If there is only one model it is set as the title to make the legend shorter</span>
    <span class="n">model_in_label</span> <span class="o">=</span> <span class="n">label_kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;model_in_label&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">models</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">model_in_label</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">label_kwargs</span><span class="p">[</span><span class="s1">&#39;model_in_label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">legend_kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="n">models</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">label_kwargs</span><span class="p">[</span><span class="s1">&#39;model_in_label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">model_in_label</span>


    <span class="n">modeldata</span><span class="p">,</span> <span class="n">axis_labels</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="n">xkey</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">ykey</span><span class="p">},</span>
                                      <span class="n">default_attrname</span><span class="o">=</span><span class="n">default_attrname</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">unit</span><span class="p">,</span>
                                      <span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">,</span> <span class="n">mask_na</span><span class="o">=</span><span class="n">mask_na</span><span class="p">,</span> <span class="n">_kwargs</span><span class="o">=</span><span class="n">kwargs</span><span class="p">,</span> <span class="o">**</span><span class="n">label_kwargs</span><span class="p">)</span>

    <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;ax_xlabel&#39;</span><span class="p">,</span> <span class="n">axis_labels</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">])</span>
    <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;ax_ylabel&#39;</span><span class="p">,</span> <span class="n">axis_labels</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">])</span>
    <span class="n">delayed_kwargs</span> <span class="o">=</span> <span class="n">update_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="s1">&#39;ax_legend&#39;</span><span class="p">,</span> <span class="n">update_ax</span><span class="o">=</span><span class="n">update_ax</span><span class="p">,</span> <span class="n">update_fig</span><span class="o">=</span><span class="n">update_fig</span><span class="p">)</span>

    <span class="n">mfc</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;markerfacecolor&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="n">has_labels</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">for</span> <span class="n">mi</span><span class="p">,</span> <span class="p">(</span><span class="n">model_name</span><span class="p">,</span> <span class="n">model_dataset</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">modeldata</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
        <span class="k">for</span> <span class="n">ki</span><span class="p">,</span> <span class="n">key_data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">model_dataset</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">fixed_model_linestyle</span> <span class="ow">or</span> <span class="p">(</span><span class="n">fixed_model_linestyle</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">model_dataset</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
                <span class="n">ls</span> <span class="o">=</span> <span class="n">linestyles</span><span class="p">[</span><span class="n">mi</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ls</span> <span class="o">=</span> <span class="n">linestyles</span><span class="p">[</span><span class="n">ki</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">fixed_model_color</span> <span class="ow">is</span> <span class="kc">True</span> <span class="ow">or</span> <span class="p">(</span><span class="n">fixed_model_color</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">modeldata</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">):</span>
                <span class="n">c</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="n">mi</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">c</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="n">ki</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">fixed_model_marker</span> <span class="ow">is</span> <span class="kc">True</span> <span class="ow">or</span> <span class="p">(</span><span class="n">fixed_model_marker</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">model_dataset</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
                <span class="n">m</span> <span class="o">=</span> <span class="n">markers</span><span class="p">[</span><span class="n">mi</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">m</span> <span class="o">=</span> <span class="n">markers</span><span class="p">[</span><span class="n">ki</span><span class="p">]</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">has_labels</span> <span class="ow">and</span> <span class="n">key_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
                <span class="n">has_labels</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">key_data</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">key_data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span>
                    <span class="n">label</span> <span class="o">=</span> <span class="n">key_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                    <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="n">ls</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">m</span><span class="p">,</span>
                    <span class="n">markerfacecolor</span><span class="o">=</span><span class="n">mfc</span> <span class="ow">or</span> <span class="n">c</span><span class="p">,</span>
                    <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="n">update_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">delayed_kwargs</span><span class="p">,</span> <span class="n">update_ax</span><span class="o">=</span><span class="n">update_ax</span><span class="p">,</span> <span class="n">update_fig</span><span class="o">=</span><span class="n">update_fig</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">legend</span> <span class="ow">or</span> <span class="p">(</span><span class="n">legend</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">has_labels</span><span class="p">):</span>
        <span class="n">create_legend</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="o">**</span><span class="n">legend_kwargs</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">ax</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="simple.plotting.plot_intnorm" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">simple.plotting.plot_intnorm</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">plot_intnorm</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>simple/plotting.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2075</span>
<span class="normal">2076</span>
<span class="normal">2077</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@utils</span><span class="o">.</span><span class="n">deprecation_warning</span><span class="p">(</span><span class="s1">&#39;``plot_intnorm`` has been deprecated: Use ``plot.intnorm`` instead&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">plot_intnorm</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">plot</span><span class="o">.</span><span class="n">intnorm</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="simple.plotting.plot_simplenorm" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">simple.plotting.plot_simplenorm</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">plot_simplenorm</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>simple/plotting.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2079</span>
<span class="normal">2080</span>
<span class="normal">2081</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@utils</span><span class="o">.</span><span class="n">deprecation_warning</span><span class="p">(</span><span class="s1">&#39;``plot_abundance`` has been deprecated: Use ``plot.stdnorm`` instead&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">plot_simplenorm</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">plot</span><span class="o">.</span><span class="n">stdnorm</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="simple.plotting.plotm" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">simple.plotting.plotm</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">plotm</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">xkey</span><span class="p">,</span> <span class="n">ykey</span><span class="p">,</span> <span class="n">xycoord</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="o">*</span><span class="p">,</span> <span class="n">arrow</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">arrow_position</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">default_attrname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mask_na</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">update_ax</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">update_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Plot the slope of <em>ykey</em> / <em>xkey</em> for each model in `<em>models</em>.</p>
<p>It is possible to plot multiple datasets if <em>xkey</em> and/or <em>ykey</em> is a list of multiple keys for a isotope key
array. If only one of the arguments is a list then the second argument will be reused for each dataset. If a key
is not present in an array then a default value is used. See <a href="simple.get_data"><code>get_data</code></a> for more details.</p>
<p>The data to be plotted is retrieved using the <a href="simple.get_data"><code>get_data</code></a> function. All arguments available
for that function not included in the argument list here can be given as one of the <em>kwargs</em> to this function.</p>
<p>The data will be plotted using matplotlib's <code>axline</code> function. Additional arguments to this function can be
passed as one of the <em>kwargs</em> to this function. Some arguments have enhanced behaviour detailed in a
section below.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>models</code></b>
          –
          <div class="doc-md-description">
            <p>A collection of models to plot. A subselection of these models can be made using the <em>where</em>
argument.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>xkey,</code></b>
              (<code>ykey (str, int, slice</code>)
          –
          <div class="doc-md-description">
            <p>This can either be a valid index to the <em>default_attrname</em> array or the path, with
or without a valid index, of a different attribute. See <a href="simple.get_data"><code>get_data</code></a> for more details.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>default_attrname</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>The name of the default attribute to use if <em>xkey</em> and <em>ykey</em> are indexes.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>unit</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>The desired unit for the <em>xkey</em> and <em>ykey</em>. Different units for <em>xkey</em> and <em>ykey</em> can be specified
by supplying a <code>(&lt;xkey_unit&gt;, &lt;ykey_unit&gt;)</code> sequence.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>where</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>If given will be used to create a subselection of <em>models</em>. Any <em>kwargs</em> prefixed
with <code>where_</code> will be supplied as keyword arguments. See
 <a href="simple.models.ModelCollection.where"><code>ModelCollection.where</code></a> for more details.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>mask</code></b>
              (<code>(<span title="str">str</span>, <span title="int">int</span>, <span title="slice">slice</span>)</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Can be used to apply a mask to the data which is plotted. See the <code>get_mask</code> function of the Model
object.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>mask_na</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>If <code>True</code> masked values will be replaced by <code>np.nan</code> values. Only works if both <em>xkey</em> and
<em>ykey</em> have a float based datatype.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>ax</code></b>
          –
          <div class="doc-md-description">
            <p>The axes where the data is plotted. Accepted values are any matplotlib Axes object or plt instance.
Defaults to <code>plt.gca()</code>.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>legend</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to create a legend. By default, a legend will be created if one or more datapoints have
a valid label.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>update_ax,</code></b>
              (<code>update_fig (bool</code>)
          –
          <div class="doc-md-description">
            <p>Whether to update the axes and figure objects using kwargs that have the prefix
<code>ax_</code> and <code>fig_</code>. See <a href="simple.plotting.update_axes"><code>simple.plotting.update_axes</code></a> for more details.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>**kwargs</code></b>
          –
          <div class="doc-md-description">
            <p>Valid keyword arguments are those using one of the prefixes define by other arguments, any argument
for the <a href="simple.get_data"><code>simple.get_data</code></a> function, or any valid keyword argument for
matplotlib's <code>plot</code> function.</p>
          </div>
        </li>
    </ul>


<details class="data-and-axis-labels" open>
  <summary>Data and axis labels</summary>
  <p>Labels for each axis and individual datapoints will be automatically generated. By default, the axis labels
will contain the information common to all datasets while the label for the individual datapoints will contain
only the unique information. You can override the axis labels by passing <code>ax_xlabel</code> and <code>ax_ylabel</code> as
one of the <em>kwargs</em>. You can also override the datapoint labels by passing a list of labels, one each
for each datapoint in the legend. See <a href="simple.get_data"><code>get_data</code></a> for more details on customising the
labels.</p>
</details>

<details class="iterable-plot-arguments" open>
  <summary>Iterable plot arguments</summary>
  <p>The following arguments for matplotlibs <code>plot</code> function have enhanced behaviour that allows them to be
iterated through when plotting different models and/or datasets.</p>
<ul>
<li>
<p><code>linestyle</code> Can be a list of linestyles that will be iterated through. If <code>True</code> simple's predefined
list of linestyles is used. If <code>False</code> no lines will be shown.</p>
</li>
<li>
<p><code>color</code> Can be a list of colors that will be iterated through. If <code>True</code> simple's predefined
list of colors is used. If <code>False</code> the colour defaults to black.</p>
</li>
</ul>
<p>There are two ways these values can be iterated through. Either all the datapoints of a given model gets the
same value or each set of datapoints across the different models gets the same value. By default, if there are
multiple models then all the datasets for each model will have the same <em>color</em>. If there is only one model
then the color will be different for the different datasets. If there are multiple datasets then each dataset
across the different models will have the same <em>linestyle</em> and <em>marker</em>. If there is only one dataset then
<em>linestyle</em> and <em>marker</em> will be different for each model.</p>
<p>This behaviour can be changed by passing <code>fixed_model_linestyle</code>, <code>fixed_model_color</code>
and <code>fixed_model_marker</code> keyword arguments set to either <code>True</code> or <code>False</code> If <code>True</code> each model will
have the same value. If <code>False</code> each dataset across the different models will have the same value.</p>
</details>

<details class="default-kwargs-and-shortcuts" open>
  <summary>Default kwargs and shortcuts</summary>
  <p>The default values for arguments can be updated by changing the  <code>plot.default_kwargs</code> dictionary. Any
argument not defined in the function description will be included in <em>kwargs</em>. Default values given in the
function definition will be used only if a default value does not exist in <code>plot.default_kwargs</code>.
Additionally, one or more shortcuts with additional/different default values are attached to this function.
The following shortcuts exist for this function:</p>
<ul>
<li>
<p><code>plotm.intnorm</code> Default values to plot internally normalised data. This sets <em>default_attrname</em> to
    <code>intnorm</code> and the <code>default_unit</code> to <code>None</code>.</p>
</li>
<li>
<p><code>plotm.stdnorm</code> Default values to plot the basic ratio normalised data. This sets
        <em>default_attrname</em> to <code>stdnorm</code> and the <code>default_unit</code> to <code>None</code>.</p>
</li>
</ul>
</details>

<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          –
          <div class="doc-md-description">
            <p>The axes where the data was plotted.</p>
          </div>
        </li>
    </ul>


            <details class="quote">
              <summary>Source code in <code>simple/plotting.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1708</span>
<span class="normal">1709</span>
<span class="normal">1710</span>
<span class="normal">1711</span>
<span class="normal">1712</span>
<span class="normal">1713</span>
<span class="normal">1714</span>
<span class="normal">1715</span>
<span class="normal">1716</span>
<span class="normal">1717</span>
<span class="normal">1718</span>
<span class="normal">1719</span>
<span class="normal">1720</span>
<span class="normal">1721</span>
<span class="normal">1722</span>
<span class="normal">1723</span>
<span class="normal">1724</span>
<span class="normal">1725</span>
<span class="normal">1726</span>
<span class="normal">1727</span>
<span class="normal">1728</span>
<span class="normal">1729</span>
<span class="normal">1730</span>
<span class="normal">1731</span>
<span class="normal">1732</span>
<span class="normal">1733</span>
<span class="normal">1734</span>
<span class="normal">1735</span>
<span class="normal">1736</span>
<span class="normal">1737</span>
<span class="normal">1738</span>
<span class="normal">1739</span>
<span class="normal">1740</span>
<span class="normal">1741</span>
<span class="normal">1742</span>
<span class="normal">1743</span>
<span class="normal">1744</span>
<span class="normal">1745</span>
<span class="normal">1746</span>
<span class="normal">1747</span>
<span class="normal">1748</span>
<span class="normal">1749</span>
<span class="normal">1750</span>
<span class="normal">1751</span>
<span class="normal">1752</span>
<span class="normal">1753</span>
<span class="normal">1754</span>
<span class="normal">1755</span>
<span class="normal">1756</span>
<span class="normal">1757</span>
<span class="normal">1758</span>
<span class="normal">1759</span>
<span class="normal">1760</span>
<span class="normal">1761</span>
<span class="normal">1762</span>
<span class="normal">1763</span>
<span class="normal">1764</span>
<span class="normal">1765</span>
<span class="normal">1766</span>
<span class="normal">1767</span>
<span class="normal">1768</span>
<span class="normal">1769</span>
<span class="normal">1770</span>
<span class="normal">1771</span>
<span class="normal">1772</span>
<span class="normal">1773</span>
<span class="normal">1774</span>
<span class="normal">1775</span>
<span class="normal">1776</span>
<span class="normal">1777</span>
<span class="normal">1778</span>
<span class="normal">1779</span>
<span class="normal">1780</span>
<span class="normal">1781</span>
<span class="normal">1782</span>
<span class="normal">1783</span>
<span class="normal">1784</span>
<span class="normal">1785</span>
<span class="normal">1786</span>
<span class="normal">1787</span>
<span class="normal">1788</span>
<span class="normal">1789</span>
<span class="normal">1790</span>
<span class="normal">1791</span>
<span class="normal">1792</span>
<span class="normal">1793</span>
<span class="normal">1794</span>
<span class="normal">1795</span>
<span class="normal">1796</span>
<span class="normal">1797</span>
<span class="normal">1798</span>
<span class="normal">1799</span>
<span class="normal">1800</span>
<span class="normal">1801</span>
<span class="normal">1802</span>
<span class="normal">1803</span>
<span class="normal">1804</span>
<span class="normal">1805</span>
<span class="normal">1806</span>
<span class="normal">1807</span>
<span class="normal">1808</span>
<span class="normal">1809</span>
<span class="normal">1810</span>
<span class="normal">1811</span>
<span class="normal">1812</span>
<span class="normal">1813</span>
<span class="normal">1814</span>
<span class="normal">1815</span>
<span class="normal">1816</span>
<span class="normal">1817</span>
<span class="normal">1818</span>
<span class="normal">1819</span>
<span class="normal">1820</span>
<span class="normal">1821</span>
<span class="normal">1822</span>
<span class="normal">1823</span>
<span class="normal">1824</span>
<span class="normal">1825</span>
<span class="normal">1826</span>
<span class="normal">1827</span>
<span class="normal">1828</span>
<span class="normal">1829</span>
<span class="normal">1830</span>
<span class="normal">1831</span>
<span class="normal">1832</span>
<span class="normal">1833</span>
<span class="normal">1834</span>
<span class="normal">1835</span>
<span class="normal">1836</span>
<span class="normal">1837</span>
<span class="normal">1838</span>
<span class="normal">1839</span>
<span class="normal">1840</span>
<span class="normal">1841</span>
<span class="normal">1842</span>
<span class="normal">1843</span>
<span class="normal">1844</span>
<span class="normal">1845</span>
<span class="normal">1846</span>
<span class="normal">1847</span>
<span class="normal">1848</span>
<span class="normal">1849</span>
<span class="normal">1850</span>
<span class="normal">1851</span>
<span class="normal">1852</span>
<span class="normal">1853</span>
<span class="normal">1854</span>
<span class="normal">1855</span>
<span class="normal">1856</span>
<span class="normal">1857</span>
<span class="normal">1858</span>
<span class="normal">1859</span>
<span class="normal">1860</span>
<span class="normal">1861</span>
<span class="normal">1862</span>
<span class="normal">1863</span>
<span class="normal">1864</span>
<span class="normal">1865</span>
<span class="normal">1866</span>
<span class="normal">1867</span>
<span class="normal">1868</span>
<span class="normal">1869</span>
<span class="normal">1870</span>
<span class="normal">1871</span>
<span class="normal">1872</span>
<span class="normal">1873</span>
<span class="normal">1874</span>
<span class="normal">1875</span>
<span class="normal">1876</span>
<span class="normal">1877</span>
<span class="normal">1878</span>
<span class="normal">1879</span>
<span class="normal">1880</span>
<span class="normal">1881</span>
<span class="normal">1882</span>
<span class="normal">1883</span>
<span class="normal">1884</span>
<span class="normal">1885</span>
<span class="normal">1886</span>
<span class="normal">1887</span>
<span class="normal">1888</span>
<span class="normal">1889</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@utils</span><span class="o">.</span><span class="n">add_shortcut</span><span class="p">(</span><span class="s1">&#39;abundance&#39;</span><span class="p">,</span> <span class="n">default_attrname</span> <span class="o">=</span><span class="s1">&#39;abundance&#39;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="nd">@utils</span><span class="o">.</span><span class="n">add_shortcut</span><span class="p">(</span><span class="s1">&#39;stdnorm&#39;</span><span class="p">,</span> <span class="n">default_attrname</span> <span class="o">=</span><span class="s1">&#39;stdnorm.Ri&#39;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="nd">@utils</span><span class="o">.</span><span class="n">add_shortcut</span><span class="p">(</span><span class="s1">&#39;intnorm&#39;</span><span class="p">,</span> <span class="n">default_attrname</span><span class="o">=</span><span class="s1">&#39;intnorm.eRi&#39;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="nd">@utils</span><span class="o">.</span><span class="n">set_default_kwargs</span><span class="p">(</span>
    <span class="n">linestyle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">fixed_model_linestyle</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">fixed_model_color</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">ax_kw_xlabel_fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
    <span class="n">ax_kw_ylabel_fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
    <span class="n">markersize</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">legend_outside</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">ax_tick_params</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="n">fig_size</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mf">6.5</span><span class="p">),</span>
    <span class="n">arrow_linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">arrow_length_includes_head</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">arrow_head_width</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
    <span class="n">arrow_zorder</span><span class="o">=</span><span class="mi">3</span>
    <span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">plotm</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">xkey</span><span class="p">,</span> <span class="n">ykey</span><span class="p">,</span> <span class="n">xycoord</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="o">*</span><span class="p">,</span>
         <span class="n">arrow</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">arrow_position</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span>
         <span class="n">default_attrname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
         <span class="n">where</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mask</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">mask_na</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
         <span class="n">legend</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">update_ax</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">update_fig</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
         <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot the slope of *ykey* / *xkey* for each model in `*models*.</span>

<span class="sd">    It is possible to plot multiple datasets if *xkey* and/or *ykey* is a list of multiple keys for a isotope key</span>
<span class="sd">    array. If only one of the arguments is a list then the second argument will be reused for each dataset. If a key</span>
<span class="sd">    is not present in an array then a default value is used. See [``get_data``](simple.get_data) for more details.</span>

<span class="sd">    The data to be plotted is retrieved using the [``get_data``](simple.get_data) function. All arguments available</span>
<span class="sd">    for that function not included in the argument list here can be given as one of the *kwargs* to this function.</span>

<span class="sd">    The data will be plotted using matplotlib&#39;s ``axline`` function. Additional arguments to this function can be</span>
<span class="sd">    passed as one of the *kwargs* to this function. Some arguments have enhanced behaviour detailed in a</span>
<span class="sd">    section below.</span>

<span class="sd">    Args:</span>
<span class="sd">        models (): A collection of models to plot. A subselection of these models can be made using the *where*</span>
<span class="sd">            argument.</span>
<span class="sd">        xkey, ykey (str, int, slice): This can either be a valid index to the *default_attrname* array or the path, with</span>
<span class="sd">            or without a valid index, of a different attribute. See [``get_data``](simple.get_data) for more details.</span>
<span class="sd">        default_attrname (str): The name of the default attribute to use if *xkey* and *ykey* are indexes.</span>
<span class="sd">        unit (str): The desired unit for the *xkey* and *ykey*. Different units for *xkey* and *ykey* can be specified</span>
<span class="sd">            by supplying a ``(&lt;xkey_unit&gt;, &lt;ykey_unit&gt;)`` sequence.</span>
<span class="sd">        where (str): If given will be used to create a subselection of *models*. Any *kwargs* prefixed</span>
<span class="sd">            with ``where_`` will be supplied as keyword arguments. See</span>
<span class="sd">             [``ModelCollection.where``](simple.models.ModelCollection.where) for more details.</span>
<span class="sd">        mask (str, int, slice): Can be used to apply a mask to the data which is plotted. See the ``get_mask`` function of the Model</span>
<span class="sd">            object.</span>
<span class="sd">        mask_na (bool): If ``True`` masked values will be replaced by ``np.nan`` values. Only works if both *xkey* and</span>
<span class="sd">            *ykey* have a float based datatype.</span>
<span class="sd">        ax (): The axes where the data is plotted. Accepted values are any matplotlib Axes object or plt instance.</span>
<span class="sd">            Defaults to ``plt.gca()``.</span>
<span class="sd">        legend (bool): Whether to create a legend. By default, a legend will be created if one or more datapoints have</span>
<span class="sd">            a valid label.</span>
<span class="sd">        update_ax, update_fig (bool): Whether to update the axes and figure objects using kwargs that have the prefix</span>
<span class="sd">            ``ax_`` and ``fig_``. See [``simple.plotting.update_axes``](simple.plotting.update_axes) for more details.</span>
<span class="sd">        **kwargs ():</span>
<span class="sd">            Valid keyword arguments are those using one of the prefixes define by other arguments, any argument</span>
<span class="sd">            for the [``simple.get_data``](simple.get_data) function, or any valid keyword argument for</span>
<span class="sd">            matplotlib&#39;s ``plot`` function.</span>

<span class="sd">    Data and axis labels:</span>
<span class="sd">        Labels for each axis and individual datapoints will be automatically generated. By default, the axis labels</span>
<span class="sd">        will contain the information common to all datasets while the label for the individual datapoints will contain</span>
<span class="sd">        only the unique information. You can override the axis labels by passing ``ax_xlabel`` and ``ax_ylabel`` as</span>
<span class="sd">        one of the *kwargs*. You can also override the datapoint labels by passing a list of labels, one each</span>
<span class="sd">        for each datapoint in the legend. See [``get_data``](simple.get_data) for more details on customising the</span>
<span class="sd">        labels.</span>


<span class="sd">    Iterable plot arguments:</span>
<span class="sd">        The following arguments for matplotlibs ``plot`` function have enhanced behaviour that allows them to be</span>
<span class="sd">        iterated through when plotting different models and/or datasets.</span>

<span class="sd">        - ``linestyle`` Can be a list of linestyles that will be iterated through. If ``True`` simple&#39;s predefined</span>
<span class="sd">        list of linestyles is used. If ``False`` no lines will be shown.</span>

<span class="sd">        - ``color`` Can be a list of colors that will be iterated through. If ``True`` simple&#39;s predefined</span>
<span class="sd">        list of colors is used. If ``False`` the colour defaults to black.</span>

<span class="sd">        There are two ways these values can be iterated through. Either all the datapoints of a given model gets the</span>
<span class="sd">        same value or each set of datapoints across the different models gets the same value. By default, if there are</span>
<span class="sd">        multiple models then all the datasets for each model will have the same *color*. If there is only one model</span>
<span class="sd">        then the color will be different for the different datasets. If there are multiple datasets then each dataset</span>
<span class="sd">        across the different models will have the same *linestyle* and *marker*. If there is only one dataset then</span>
<span class="sd">        *linestyle* and *marker* will be different for each model.</span>

<span class="sd">        This behaviour can be changed by passing ``fixed_model_linestyle``, ``fixed_model_color``</span>
<span class="sd">        and ``fixed_model_marker`` keyword arguments set to either ``True`` or ``False`` If ``True`` each model will</span>
<span class="sd">        have the same value. If ``False`` each dataset across the different models will have the same value.</span>

<span class="sd">    Default kwargs and shortcuts:</span>
<span class="sd">        The default values for arguments can be updated by changing the  ``plot.default_kwargs`` dictionary. Any</span>
<span class="sd">        argument not defined in the function description will be included in *kwargs*. Default values given in the</span>
<span class="sd">        function definition will be used only if a default value does not exist in ``plot.default_kwargs``.</span>
<span class="sd">        Additionally, one or more shortcuts with additional/different default values are attached to this function.</span>
<span class="sd">        The following shortcuts exist for this function:</span>

<span class="sd">        - ``plotm.intnorm`` Default values to plot internally normalised data. This sets *default_attrname* to</span>
<span class="sd">            ``intnorm`` and the ``default_unit`` to ``None``.</span>

<span class="sd">        - ``plotm.stdnorm`` Default values to plot the basic ratio normalised data. This sets</span>
<span class="sd">                *default_attrname* to ``stdnorm`` and the ``default_unit`` to ``None``.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The axes where the data was plotted.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">get_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>  <span class="c1"># We are working on the axes object proper</span>

    <span class="n">where_kwargs</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">extract_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;where&#39;</span><span class="p">)</span>
    <span class="n">models</span> <span class="o">=</span> <span class="n">get_models</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">where</span><span class="p">,</span> <span class="n">where_kwargs</span><span class="o">=</span><span class="n">where_kwargs</span><span class="p">)</span>

    <span class="c1"># Get the linestyle, color and marker for each thing to be plotted.</span>
    <span class="n">linestyles</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">markers</span> <span class="o">=</span> <span class="n">parse_lscm</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;linestyle&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">),</span>
                                             <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;color&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">),</span>
                                             <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;marker&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">))</span>
    <span class="n">fixed_model_linestyle</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;fixed_model_linestyle&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">fixed_model_color</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;fixed_model_color&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="n">legend_kwargs</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">extract_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;legend&#39;</span><span class="p">)</span>

    <span class="n">label_kwargs</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">extract_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="s1">&#39;prefix_label&#39;</span><span class="p">,</span> <span class="s1">&#39;suffix_label&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;key_in_label&#39;</span><span class="p">,</span> <span class="s1">&#39;numer_in_label&#39;</span><span class="p">,</span> <span class="s1">&#39;denom_in_label&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;model_in_label&#39;</span><span class="p">,</span> <span class="s1">&#39;unit_in_label&#39;</span><span class="p">,</span> <span class="s1">&#39;attrname_in_label&#39;</span><span class="p">)</span>
    <span class="n">arrow_kwargs</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">extract_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;arrow&#39;</span><span class="p">)</span>

    <span class="c1"># If there is only one model it is set as the title to make the legend shorter</span>
    <span class="n">model_in_label</span> <span class="o">=</span> <span class="n">label_kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;model_in_label&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">models</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">model_in_label</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">label_kwargs</span><span class="p">[</span><span class="s1">&#39;model_in_label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">legend_kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="n">models</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">label_kwargs</span><span class="p">[</span><span class="s1">&#39;model_in_label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">model_in_label</span>


    <span class="n">modeldata</span><span class="p">,</span> <span class="n">axis_labels</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="n">xkey</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">ykey</span><span class="p">},</span>
                                      <span class="n">default_attrname</span><span class="o">=</span><span class="n">default_attrname</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">unit</span><span class="p">,</span>
                                      <span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">,</span> <span class="n">mask_na</span><span class="o">=</span><span class="n">mask_na</span><span class="p">,</span> <span class="n">_kwargs</span><span class="o">=</span><span class="n">kwargs</span><span class="p">,</span> <span class="o">**</span><span class="n">label_kwargs</span><span class="p">)</span>

    <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;ax_xlabel&#39;</span><span class="p">,</span> <span class="n">axis_labels</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">])</span>
    <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;ax_ylabel&#39;</span><span class="p">,</span> <span class="n">axis_labels</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">])</span>
    <span class="n">delayed_kwargs</span> <span class="o">=</span> <span class="n">update_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="s1">&#39;ax_legend&#39;</span><span class="p">,</span> <span class="n">update_ax</span><span class="o">=</span><span class="n">update_ax</span><span class="p">,</span> <span class="n">update_fig</span><span class="o">=</span><span class="n">update_fig</span><span class="p">)</span>

    <span class="n">has_labels</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">for</span> <span class="n">mi</span><span class="p">,</span> <span class="p">(</span><span class="n">model_name</span><span class="p">,</span> <span class="n">model_dataset</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">modeldata</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
        <span class="k">for</span> <span class="n">ki</span><span class="p">,</span> <span class="n">key_data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">model_dataset</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">fixed_model_linestyle</span> <span class="ow">or</span> <span class="p">(</span><span class="n">fixed_model_linestyle</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">model_dataset</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
                <span class="n">ls</span> <span class="o">=</span> <span class="n">linestyles</span><span class="p">[</span><span class="n">mi</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ls</span> <span class="o">=</span> <span class="n">linestyles</span><span class="p">[</span><span class="n">ki</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">fixed_model_color</span> <span class="ow">is</span> <span class="kc">True</span> <span class="ow">or</span> <span class="p">(</span><span class="n">fixed_model_color</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">modeldata</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">):</span>
                <span class="n">c</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="n">mi</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">c</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="n">ki</span><span class="p">]</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">has_labels</span> <span class="ow">and</span> <span class="n">key_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
                <span class="n">has_labels</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="n">label</span> <span class="o">=</span> <span class="n">key_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">key_data</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">])):</span>
                <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">key_data</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">key_data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
                <span class="n">slope</span> <span class="o">=</span> <span class="n">y</span> <span class="o">/</span> <span class="n">x</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">axline</span><span class="p">(</span><span class="n">xycoord</span><span class="p">,</span> <span class="n">slope</span><span class="o">=</span><span class="n">slope</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span>
                          <span class="n">color</span> <span class="o">=</span> <span class="n">c</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="n">ls</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="n">label</span> <span class="o">=</span> <span class="kc">None</span>

                <span class="k">if</span> <span class="n">arrow</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">slope</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">y_arrow</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">arrow_position</span><span class="p">,</span> <span class="n">arrow_position</span> <span class="o">+</span> <span class="mf">0.01</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="k">if</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">1</span><span class="p">)</span>
                        <span class="n">x_arrow</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">y_arrow</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">x_arrow</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">arrow_position</span><span class="p">,</span> <span class="n">arrow_position</span> <span class="o">+</span> <span class="mf">0.01</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">1</span><span class="p">)</span>
                        <span class="n">y_arrow</span> <span class="o">=</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">x_arrow</span>

                    <span class="n">ax</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="n">x_arrow</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y_arrow</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">x_arrow</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x_arrow</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y_arrow</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">y_arrow</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                            <span class="n">facecolor</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="o">**</span><span class="n">arrow_kwargs</span><span class="p">)</span>

    <span class="n">update_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">delayed_kwargs</span><span class="p">,</span> <span class="n">update_ax</span><span class="o">=</span><span class="n">update_ax</span><span class="p">,</span> <span class="n">update_fig</span><span class="o">=</span><span class="n">update_fig</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">legend</span> <span class="ow">or</span> <span class="p">(</span><span class="n">legend</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">has_labels</span><span class="p">):</span>
        <span class="n">create_legend</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="o">**</span><span class="n">legend_kwargs</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">ax</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="simple.plotting.rad2deg" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">simple.plotting.rad2deg</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">rad2deg</span><span class="p">(</span><span class="n">rad</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Convert a degree angle into a radian angle`value</p>


            <details class="quote">
              <summary>Source code in <code>simple/plotting.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">rad2deg</span><span class="p">(</span><span class="n">rad</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert a degree angle into a radian angle`value&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">rad2deg</span><span class="p">(</span><span class="n">rad</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="simple.plotting.update_axes" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">simple.plotting.update_axes</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">update_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">update_ax</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">update_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">delay_all</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Updates the axes and figure objects.</p>
<p>Keywords beginning with <code>ax_&lt;name&gt;</code>, <code>xax_&lt;name&gt;</code>, <code>yax_&lt;name&gt;</code> and <code>fig_&lt;name&gt;</code> will be stripped
from kwargs. These will then be used to call the <code>set_&lt;name&gt;</code> or <code>&lt;name&gt;</code> method of the axes, axis or
figure object.</p>
<p>If the value mapped to the above arguments is:
- A boolean it is used to determine whether to call the method. The boolean itself will not be passed to
    the method. To pass a boolean to a method place it in a tuple, e.g. <code>(True, )</code>.
- A tuple then the contents of the tuple is unpacked as arguments for the method call.
- A dictionary then the contents of the dictionary is unpacked as keyword arguments for the method call.
- Any other value will be passed as the first argument to the method call.</p>
<p>Additional keyword arguments can be passed to methods by mapping e.g. <code>&lt;ax|xax|yax|fig&gt;_kw_&lt;name&gt;_&lt;keyword&gt;</code>
kwargs to the value. These additional keyword arguments are only used if the
<code>&lt;ax|xax|yax|fig&gt;_&lt;name&gt;</code> kwargs exists. Note however that they are always stripped from <code>kwargs</code>.</p>
<p>It is possible to delay calling certain method by adding <code>&lt;ax|xax|yax|fig&gt;_&lt;name&gt;</code> to <code>*delay</code>. Keywords
associated with these method will then be included in the returned dictionary. This dictionary can be passed back
to the function at a later time. To delay all calls but remove the relevant kwargs from <em>kwargs</em> use
<code>delay_all=True</code>.</p>
<p>Returns
    dict: A dictionary containing the delayed method calls.</p>


            <details class="quote">
              <summary>Source code in <code>simple/plotting.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span>
<span class="normal">1467</span>
<span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span>
<span class="normal">1528</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">update_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">update_ax</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">update_fig</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">delay_all</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Updates the axes and figure objects.</span>

<span class="sd">    Keywords beginning with ``ax_&lt;name&gt;``, ``xax_&lt;name&gt;``, ``yax_&lt;name&gt;`` and ``fig_&lt;name&gt;`` will be stripped</span>
<span class="sd">    from kwargs. These will then be used to call the ``set_&lt;name&gt;`` or ``&lt;name&gt;`` method of the axes, axis or</span>
<span class="sd">    figure object.</span>

<span class="sd">    If the value mapped to the above arguments is:</span>
<span class="sd">    - A boolean it is used to determine whether to call the method. The boolean itself will not be passed to</span>
<span class="sd">        the method. To pass a boolean to a method place it in a tuple, e.g. ``(True, )``.</span>
<span class="sd">    - A tuple then the contents of the tuple is unpacked as arguments for the method call.</span>
<span class="sd">    - A dictionary then the contents of the dictionary is unpacked as keyword arguments for the method call.</span>
<span class="sd">    - Any other value will be passed as the first argument to the method call.</span>

<span class="sd">    Additional keyword arguments can be passed to methods by mapping e.g. ``&lt;ax|xax|yax|fig&gt;_kw_&lt;name&gt;_&lt;keyword&gt;``</span>
<span class="sd">    kwargs to the value. These additional keyword arguments are only used if the</span>
<span class="sd">    ``&lt;ax|xax|yax|fig&gt;_&lt;name&gt;`` kwargs exists. Note however that they are always stripped from ``kwargs``.</span>

<span class="sd">    It is possible to delay calling certain method by adding ``&lt;ax|xax|yax|fig&gt;_&lt;name&gt;`` to ``*delay``. Keywords</span>
<span class="sd">    associated with these method will then be included in the returned dictionary. This dictionary can be passed back</span>
<span class="sd">    to the function at a later time. To delay all calls but remove the relevant kwargs from *kwargs* use</span>
<span class="sd">    ``delay_all=True``.</span>

<span class="sd">    Returns</span>
<span class="sd">        dict: A dictionary containing the delayed method calls.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">ax</span> <span class="o">=</span> <span class="n">get_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">axes_meth</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">extract_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;ax&#39;</span><span class="p">)</span>
    <span class="n">axes_kw</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">extract_kwargs</span><span class="p">(</span><span class="n">axes_meth</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;kw&#39;</span><span class="p">)</span>

    <span class="n">xaxes_meth</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">extract_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;xax&#39;</span><span class="p">)</span>
    <span class="n">xaxes_kw</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">extract_kwargs</span><span class="p">(</span><span class="n">axes_meth</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;kw&#39;</span><span class="p">)</span>

    <span class="n">yaxes_meth</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">extract_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;yax&#39;</span><span class="p">)</span>
    <span class="n">yaxes_kw</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">extract_kwargs</span><span class="p">(</span><span class="n">axes_meth</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;kw&#39;</span><span class="p">)</span>

    <span class="n">figure_meth</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">extract_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;fig&#39;</span><span class="p">)</span>
    <span class="n">figure_kw</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">extract_kwargs</span><span class="p">(</span><span class="n">figure_meth</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;kw&#39;</span><span class="p">)</span>

    <span class="c1"># Special cases</span>
    <span class="k">if</span> <span class="s1">&#39;size&#39;</span> <span class="ow">in</span> <span class="n">figure_meth</span><span class="p">:</span> <span class="n">figure_meth</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;size_inches&#39;</span><span class="p">,</span> <span class="n">figure_meth</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;size&#39;</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">delay</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">delay</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">delay</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">delay</span> <span class="o">=</span> <span class="p">[</span><span class="n">delay</span><span class="p">]</span>
    <span class="n">delayed_kwargs</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">meth_kwargs</span><span class="p">,</span> <span class="n">kw_kwargs</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">var</span><span class="p">,</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">meth_kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">var_kwargs</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">extract_kwargs</span><span class="p">(</span><span class="n">kw_kwargs</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="n">var</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;set_</span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">var</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1"> object has no method called ``set_</span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s1">`` or ``</span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s1">``&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s1">&#39;</span> <span class="ow">in</span> <span class="n">delay</span> <span class="ow">or</span> <span class="n">delay_all</span><span class="p">:</span>
                <span class="n">delayed_kwargs</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">arg</span>
                <span class="n">delayed_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">_kw_</span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">var_kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()})</span>
                <span class="k">continue</span>

            <span class="k">elif</span> <span class="n">arg</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">elif</span> <span class="n">arg</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">arg</span> <span class="o">=</span> <span class="p">()</span>
            <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">dict</span><span class="p">:</span>
                <span class="n">var_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
                <span class="n">arg</span> <span class="o">=</span> <span class="p">()</span>
            <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">tuple</span><span class="p">:</span>
                <span class="n">arg</span> <span class="o">=</span> <span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="p">)</span>

            <span class="n">method</span><span class="p">(</span><span class="o">*</span><span class="n">arg</span><span class="p">,</span> <span class="o">**</span><span class="n">var_kwargs</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">update_ax</span><span class="p">:</span>
        <span class="n">update</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="s1">&#39;ax&#39;</span><span class="p">,</span> <span class="n">axes_meth</span><span class="p">,</span> <span class="n">axes_kw</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">xaxes_meth</span><span class="p">:</span>
            <span class="n">update</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="p">,</span> <span class="s1">&#39;xax&#39;</span><span class="p">,</span> <span class="n">xaxes_meth</span><span class="p">,</span> <span class="n">xaxes_kw</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">yaxes_meth</span><span class="p">:</span>
            <span class="n">update</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="p">,</span> <span class="s1">&#39;yax&#39;</span><span class="p">,</span> <span class="n">yaxes_meth</span><span class="p">,</span> <span class="n">yaxes_kw</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">update_fig</span><span class="p">:</span>
        <span class="n">update</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_figure</span><span class="p">(),</span> <span class="s1">&#39;fig&#39;</span><span class="p">,</span> <span class="n">figure_meth</span><span class="p">,</span> <span class="n">figure_kw</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">delayed_kwargs</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="simple.plotting.xy2deg" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">simple.plotting.xy2deg</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">xy2deg</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">xscale</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">yscale</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Convert <em>x</em>, <em>y</em> coordinated into a angle value given in degrees.</p>


            <details class="quote">
              <summary>Source code in <code>simple/plotting.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">xy2deg</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">xscale</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">yscale</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert *x*, *y* coordinated into a angle value given in degrees.</span>
<span class="sd">        &quot;&quot;&quot;</span>
    <span class="n">rad</span> <span class="o">=</span> <span class="n">xy2rad</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">xscale</span><span class="o">=</span><span class="n">xscale</span><span class="p">,</span> <span class="n">yscale</span><span class="o">=</span><span class="n">yscale</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">rad2deg</span><span class="p">(</span><span class="n">rad</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="simple.plotting.xy2rad" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">simple.plotting.xy2rad</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">xy2rad</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">xscale</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">yscale</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Convert <em>x</em>, <em>y</em> coordinated into a angle value given in radians.</p>


            <details class="quote">
              <summary>Source code in <code>simple/plotting.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">xy2rad</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">xscale</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">yscale</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert *x*, *y* coordinated into a angle value given in radians.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">calc</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">y</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span>

        <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mf">0.5</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span><span class="n">y</span> <span class="o">/</span> <span class="n">x</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mf">1.5</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span><span class="n">y</span> <span class="o">/</span> <span class="n">x</span><span class="p">)</span>

    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">as1darray</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">calc</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">xscale</span><span class="p">,</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">yscale</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">)])</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>