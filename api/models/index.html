
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../norm/">
      
      
        <link rel="next" href="../utils/">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>simple.models - SIMPLE v0.4.3</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#the-simplemodels-namespace" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="SIMPLE v0.4.3" class="md-header__button md-logo" aria-label="SIMPLE v0.4.3" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            SIMPLE v0.4.3
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              simple.models
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="SIMPLE v0.4.3" class="md-nav__button md-logo" aria-label="SIMPLE v0.4.3" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    SIMPLE v0.4.3
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    User Guide
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Tutorials
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Tutorials
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/ccsne_tutorial1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tutorial 1 - Getting Started
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/ccsne_tutorial2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tutorial 2 - Normalising abundances
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/ccsne_tutorial3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tutorial 3 - Plotting
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Examples
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Examples
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/create_simple_db/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Create CCSNe database
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/rose_diagram/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Introduction to rose diagrams
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../simple/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    User Reference
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    API Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    API Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../plotting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    simple.plotting
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../norm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    simple.norm
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    simple.models
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    simple.models
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#simple.models.AllModelClasses" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;AllModelClasses
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.models.HDF5Dict" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;HDF5Dict
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.models.IsoRef" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;IsoRef
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" IsoRef">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#simple.models.IsoRef.ISREF" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;ISREF
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.models.IsoRef.REPR_ATTRS" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;REPR_ATTRS
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.models.IsoRef.REQUIRED_ATTRS" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;REQUIRED_ATTRS
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.models.ModelBase" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ModelBase
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" ModelBase">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#simple.models.ModelBase.ABUNDANCE_KEYARRAY" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;ABUNDANCE_KEYARRAY
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.models.ModelBase.REPR_ATTRS" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;REPR_ATTRS
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.models.ModelBase.REQUIRED_ATTRS" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;REQUIRED_ATTRS
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.models.ModelBase.VALUES_KEYS_TO_ARRAY" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;VALUES_KEYS_TO_ARRAY
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.models.ModelBase.convert_array" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;convert_array
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.models.ModelBase.get_array" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_array
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.models.ModelBase.get_array_labels" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_array_labels
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.models.ModelBase.get_mask" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_mask
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.models.ModelBase.internal_normalisation" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;internal_normalisation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.models.ModelBase.select_isolist" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;select_isolist
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.models.ModelBase.setattr" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;setattr
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.models.ModelBase.standard_normalisation" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;standard_normalisation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.models.ModelCollection" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ModelCollection
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" ModelCollection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#simple.models.ModelCollection.models" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;models
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.models.ModelCollection.refs" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;refs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.models.ModelCollection.add_model" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;add_model
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.models.ModelCollection.add_ref" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;add_ref
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.models.ModelCollection.get_model" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_model
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.models.ModelCollection.get_ref" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_ref
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.models.ModelCollection.internal_normalisation" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;internal_normalisation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.models.ModelCollection.load_file" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;load_file
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.models.ModelCollection.new_model" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;new_model
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.models.ModelCollection.new_ref" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;new_ref
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.models.ModelCollection.save" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;save
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.models.ModelCollection.select_isolist" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;select_isolist
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.models.ModelCollection.standard_normalisation" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;standard_normalisation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.models.ModelCollection.where" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;where
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.models.load_collection" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;load_collection
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.models.load_csv_h" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;load_csv_h
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.models.load_models" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;load_models
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.models.load_ppn" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;load_ppn
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.models.new_collection" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;new_collection
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    simple.utils
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ccsne/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    simple.ccsne
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../roseaxes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    simple.roseaxes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../changelog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Changelog
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    About
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#simple.models.AllModelClasses" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;AllModelClasses
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.models.HDF5Dict" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;HDF5Dict
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.models.IsoRef" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;IsoRef
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" IsoRef">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#simple.models.IsoRef.ISREF" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;ISREF
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.models.IsoRef.REPR_ATTRS" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;REPR_ATTRS
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.models.IsoRef.REQUIRED_ATTRS" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;REQUIRED_ATTRS
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.models.ModelBase" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ModelBase
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" ModelBase">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#simple.models.ModelBase.ABUNDANCE_KEYARRAY" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;ABUNDANCE_KEYARRAY
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.models.ModelBase.REPR_ATTRS" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;REPR_ATTRS
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.models.ModelBase.REQUIRED_ATTRS" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;REQUIRED_ATTRS
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.models.ModelBase.VALUES_KEYS_TO_ARRAY" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;VALUES_KEYS_TO_ARRAY
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.models.ModelBase.convert_array" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;convert_array
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.models.ModelBase.get_array" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_array
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.models.ModelBase.get_array_labels" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_array_labels
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.models.ModelBase.get_mask" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_mask
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.models.ModelBase.internal_normalisation" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;internal_normalisation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.models.ModelBase.select_isolist" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;select_isolist
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.models.ModelBase.setattr" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;setattr
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.models.ModelBase.standard_normalisation" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;standard_normalisation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.models.ModelCollection" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ModelCollection
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" ModelCollection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#simple.models.ModelCollection.models" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;models
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.models.ModelCollection.refs" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;refs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.models.ModelCollection.add_model" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;add_model
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.models.ModelCollection.add_ref" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;add_ref
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.models.ModelCollection.get_model" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_model
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.models.ModelCollection.get_ref" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_ref
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.models.ModelCollection.internal_normalisation" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;internal_normalisation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.models.ModelCollection.load_file" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;load_file
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.models.ModelCollection.new_model" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;new_model
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.models.ModelCollection.new_ref" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;new_ref
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.models.ModelCollection.save" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;save
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.models.ModelCollection.select_isolist" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;select_isolist
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.models.ModelCollection.standard_normalisation" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;standard_normalisation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple.models.ModelCollection.where" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;where
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.models.load_collection" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;load_collection
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.models.load_csv_h" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;load_csv_h
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.models.load_models" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;load_models
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.models.load_ppn" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;load_ppn
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple.models.new_collection" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;new_collection
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="the-simplemodels-namespace">The <code>simple.models</code> Namespace</h1>
<p>The <em>models</em> submodule contains everything pertaining the primary object structure which keeps track of different
models.</p>
<hr />


<div class="doc doc-object doc-module">




    <div class="doc doc-contents first">



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h2 id="simple.models.AllModelClasses" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">simple.models.AllModelClasses</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">AllModelClasses</span> <span class="o">=</span> <span class="p">{}</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>A dictionary containing all the avaliable model classes. </p>
<p>When a new model class is created subclassing <a class="autorefs autorefs-internal" href="#simple.models.ModelBase"><code>ModelBase</code></a> it is automatically
added to this dictionary.</p>
    </div>

</div>


<div class="doc doc-object doc-class">



<h2 id="simple.models.HDF5Dict" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">simple.models.HDF5Dict</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">HDF5Dict</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="simple.utils.NamedDict" href="../utils/#simple.utils.NamedDict">NamedDict</a></code></p>


        <p>A subclass of <a class="autorefs autorefs-internal" href="../utils/#simple.utils.NamedDict">NamedDict</a> where all values are passed to
<a class="autorefs autorefs-internal" href="../simple/#simple.asarray">asarray</a> before being added to the dictionary.</p>
<p>All contents on this dictionary should be compatiable with HDF5 files.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">nd</span> <span class="o">=</span> <span class="n">simple</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">NamedDict</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nd</span><span class="o">.</span><span class="n">a</span>
<span class="go">array(1)</span>
</code></pre></div>

        <p>Initialise the dictionary and track attribute types.</p>

                  <details class="quote">
                    <summary>Source code in <code>simple/models.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialise the dictionary and track attribute types.&quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="s1">&#39;_attr_type&#39;</span><span class="p">,</span> <span class="p">{},</span> <span class="n">item</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="simple.models.IsoRef" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">simple.models.IsoRef</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">IsoRef</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">reference_models_</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">hdf5_attrs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="simple.models.ModelBase" href="#simple.models.ModelBase">ModelBase</a></code></p>


        <p>Model specifically for storing reference isotope values.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><span title="simple.models.IsoRef.type">type</span></code></b>
              (<code><span title="str">str</span></code>)
          –
          <div class="doc-md-description">
            <p>The type of data stored in the model. <strong>Required at initialisation</strong></p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="simple.models.IsoRef.citation">citation</span></code></b>
              (<code><span title="str">str</span></code>)
          –
          <div class="doc-md-description">
            <p>A citation for the data. <strong>Required at initialisation</strong></p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="simple.models.IsoRef.data">data</span></code></b>
          –
          <div class="doc-md-description">
            <p>A key array containing the data. Is created upon model initiation from the
<code>data_values</code> and <code>data_keys</code> attributes.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="simple.models.IsoRef.data_values">data_values</span></code></b>
          –
          <div class="doc-md-description">
            <p>A 2dim array containing the data. <strong>Required at initialisation</strong></p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="simple.models.IsoRef.data_keys">data_keys</span></code></b>
          –
          <div class="doc-md-description">
            <p>Keys for the second dimension of <code>data_values</code>. <strong>Required at initialisation</strong></p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="simple.models.IsoRef.data_unit">data_unit</span></code></b>
          –
          <div class="doc-md-description">
            <p>Unit for the data. <strong>Required at initialisation</strong></p>
          </div>
        </li>
    </ul>

        <p>Create a model instance and populate <code>hdf5_attrs</code>.</p>

                  <details class="quote">
                    <summary>Source code in <code>simple/models.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">reference_models_</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">hdf5_attrs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a model instance and populate ``hdf5_attrs``.&quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="s1">&#39;hdf5_attrs&#39;</span><span class="p">,</span> <span class="n">HDF5Dict</span><span class="p">())</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="s1">&#39;normal_attrs&#39;</span><span class="p">,</span> <span class="n">NamedDict</span><span class="p">())</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="s1">&#39;_hash&#39;</span><span class="p">,</span> <span class="nb">hash</span><span class="p">(</span><span class="nb">object</span><span class="p">()))</span>

    <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">REQUIRED_ATTRS</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">attr</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">hdf5_attrs</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">{{</span><span class="s2">Required attribute &#39;</span><span class="si">{</span><span class="n">attr</span><span class="si">}</span><span class="s2">&#39; does not exist in initialisation arguments</span><span class="se">}}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">hdf5_attrs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setattr</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">hdf5_compatible</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># This is how we know which class to create. Need to be set after attrs incase you remapp the</span>
    <span class="c1"># class name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setattr</span><span class="p">(</span><span class="s1">&#39;clsname&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">hdf5_compatible</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Automatically creates &lt;name&gt; key array if &lt;name&gt;_values and &lt;name&gt;_keys exists</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">VALUES_KEYS_TO_ARRAY</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">hdf5_attrs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">key</span><span class="p">[</span><span class="o">-</span><span class="mi">7</span><span class="p">:]</span> <span class="o">==</span> <span class="s1">&#39;_values&#39;</span><span class="p">:</span>
                <span class="n">aattr</span> <span class="o">=</span> <span class="n">key</span><span class="p">[:</span><span class="o">-</span><span class="mi">7</span><span class="p">]</span>
                <span class="n">vattr</span> <span class="o">=</span> <span class="n">key</span>
                <span class="n">kattr</span> <span class="o">=</span> <span class="n">key</span><span class="p">[:</span><span class="o">-</span><span class="mi">7</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;_keys&#39;</span>
                <span class="k">if</span> <span class="n">kattr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">hdf5_attrs</span> <span class="ow">and</span> <span class="n">aattr</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">hdf5_attrs</span><span class="p">:</span>
                    <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hdf5_attrs</span><span class="p">[</span><span class="n">vattr</span><span class="p">]</span>
                    <span class="n">k</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hdf5_attrs</span><span class="p">[</span><span class="n">kattr</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">setattr</span><span class="p">(</span><span class="n">aattr</span><span class="p">,</span> <span class="n">utils</span><span class="o">.</span><span class="n">askeyarray</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">k</span><span class="p">),</span> <span class="n">hdf5_compatible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">hdf5_attrs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">key</span><span class="p">[:</span><span class="mi">6</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;refid_&#39;</span><span class="p">:</span>
            <span class="n">id_name</span> <span class="o">=</span> <span class="n">key</span><span class="p">[</span><span class="mi">6</span><span class="p">:]</span>
            <span class="k">if</span> <span class="n">reference_models_</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No reference models were supplied&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">ref</span> <span class="ow">in</span> <span class="n">reference_models_</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">ref</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">value</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">setattr</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ref_</span><span class="si">{</span><span class="n">id_name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">ref</span><span class="p">,</span> <span class="n">hdf5_compatible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                    <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No model called &#39;</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&#39; was found in the supplied reference models&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="simple.models.IsoRef.ISREF" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">ISREF</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">ISREF</span> <span class="o">=</span> <span class="kc">True</span>
</code></pre></div>

    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="simple.models.IsoRef.REPR_ATTRS" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">REPR_ATTRS</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">REPR_ATTRS</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="simple.models.IsoRef.REQUIRED_ATTRS" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">REQUIRED_ATTRS</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">REQUIRED_ATTRS</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="s1">&#39;citation&#39;</span><span class="p">,</span> <span class="s1">&#39;data_values&#39;</span><span class="p">,</span> <span class="s1">&#39;data_keys&#39;</span><span class="p">,</span> <span class="s1">&#39;data_unit&#39;</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">
    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="simple.models.ModelBase" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">simple.models.ModelBase</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">ModelBase</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">reference_models_</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">hdf5_attrs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">


        <p>This class can be subclassed to create new model classes.</p>
<p>Once subclassed the new model will automatically be available through <code>ModelCollection.new_model</code>.</p>
<p>There are a number of class attributes that can be set to determine behaviour of the new class:</p>
<ul>
<li><code>REQUIRED_ATTRS</code> - A list of attributes that must be supplied when creating the class. An exception
    will be raised if any of these attributes are missing.</li>
<li><code>REPR_ATTRS</code> - A list of the attributes that values will be shown in the repr.</li>
<li><code>ABUNDANCE_KEYARRAY</code> - The name of a key array containing the abundances that should be normalised. Alternatively
    you can subclass the <code>internal_normalisation</code> and <code>standard_normalisation</code> methods for more customisation.</li>
<li><code>VALUES_KEYS_TO_ARRAY</code> - If <code>True</code> a key array named <code>&lt;name&gt;</code> is automatically created upon model
    initialisation if attributes called.
    <code>&lt;name&gt;_values</code> and <code>&lt;name&gt;_keys</code> exits.</li>
</ul>

        <p>Create a model instance and populate <code>hdf5_attrs</code>.</p>

                  <details class="quote">
                    <summary>Source code in <code>simple/models.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">reference_models_</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">hdf5_attrs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a model instance and populate ``hdf5_attrs``.&quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="s1">&#39;hdf5_attrs&#39;</span><span class="p">,</span> <span class="n">HDF5Dict</span><span class="p">())</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="s1">&#39;normal_attrs&#39;</span><span class="p">,</span> <span class="n">NamedDict</span><span class="p">())</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="s1">&#39;_hash&#39;</span><span class="p">,</span> <span class="nb">hash</span><span class="p">(</span><span class="nb">object</span><span class="p">()))</span>

    <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">REQUIRED_ATTRS</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">attr</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">hdf5_attrs</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">{{</span><span class="s2">Required attribute &#39;</span><span class="si">{</span><span class="n">attr</span><span class="si">}</span><span class="s2">&#39; does not exist in initialisation arguments</span><span class="se">}}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">hdf5_attrs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setattr</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">hdf5_compatible</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># This is how we know which class to create. Need to be set after attrs incase you remapp the</span>
    <span class="c1"># class name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setattr</span><span class="p">(</span><span class="s1">&#39;clsname&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">hdf5_compatible</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Automatically creates &lt;name&gt; key array if &lt;name&gt;_values and &lt;name&gt;_keys exists</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">VALUES_KEYS_TO_ARRAY</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">hdf5_attrs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">key</span><span class="p">[</span><span class="o">-</span><span class="mi">7</span><span class="p">:]</span> <span class="o">==</span> <span class="s1">&#39;_values&#39;</span><span class="p">:</span>
                <span class="n">aattr</span> <span class="o">=</span> <span class="n">key</span><span class="p">[:</span><span class="o">-</span><span class="mi">7</span><span class="p">]</span>
                <span class="n">vattr</span> <span class="o">=</span> <span class="n">key</span>
                <span class="n">kattr</span> <span class="o">=</span> <span class="n">key</span><span class="p">[:</span><span class="o">-</span><span class="mi">7</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;_keys&#39;</span>
                <span class="k">if</span> <span class="n">kattr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">hdf5_attrs</span> <span class="ow">and</span> <span class="n">aattr</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">hdf5_attrs</span><span class="p">:</span>
                    <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hdf5_attrs</span><span class="p">[</span><span class="n">vattr</span><span class="p">]</span>
                    <span class="n">k</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hdf5_attrs</span><span class="p">[</span><span class="n">kattr</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">setattr</span><span class="p">(</span><span class="n">aattr</span><span class="p">,</span> <span class="n">utils</span><span class="o">.</span><span class="n">askeyarray</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">k</span><span class="p">),</span> <span class="n">hdf5_compatible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">hdf5_attrs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">key</span><span class="p">[:</span><span class="mi">6</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;refid_&#39;</span><span class="p">:</span>
            <span class="n">id_name</span> <span class="o">=</span> <span class="n">key</span><span class="p">[</span><span class="mi">6</span><span class="p">:]</span>
            <span class="k">if</span> <span class="n">reference_models_</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No reference models were supplied&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">ref</span> <span class="ow">in</span> <span class="n">reference_models_</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">ref</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">value</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">setattr</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ref_</span><span class="si">{</span><span class="n">id_name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">ref</span><span class="p">,</span> <span class="n">hdf5_compatible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                    <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No model called &#39;</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&#39; was found in the supplied reference models&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="simple.models.ModelBase.ABUNDANCE_KEYARRAY" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">ABUNDANCE_KEYARRAY</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">ABUNDANCE_KEYARRAY</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="simple.models.ModelBase.REPR_ATTRS" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">REPR_ATTRS</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">REPR_ATTRS</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="simple.models.ModelBase.REQUIRED_ATTRS" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">REQUIRED_ATTRS</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">REQUIRED_ATTRS</span> <span class="o">=</span> <span class="p">[]</span>
</code></pre></div>

    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="simple.models.ModelBase.VALUES_KEYS_TO_ARRAY" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">VALUES_KEYS_TO_ARRAY</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">VALUES_KEYS_TO_ARRAY</span> <span class="o">=</span> <span class="kc">True</span>
</code></pre></div>

    <div class="doc doc-contents ">
    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="simple.models.ModelBase.convert_array" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">convert_array</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">convert_array</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">desired_unit</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">attrname</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Return a copy of the array converted to the desired unit.</p>
<p>Supported units are the <a class="autorefs autorefs-internal" href="../utils/#simple.utils.UNITS">mole and mass units</a>. Converting between the <em>mass</em> and <em>mole</em>* units is done by
dividing/multiplying the values by the mass number.</p>
<p>Always return a copy of <code>array</code> even if not conversion takes place.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code>array</code></b>
          –
          <div class="doc-md-description">
            <p>A key array.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>unit</code></b>
          –
          <div class="doc-md-description">
            <p>The current unit of the data in <code>array</code>. If <code>None</code> the unit is assumed to be that of the
<code>desired_unit_args</code>.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>desired_unit</code></b>
          –
          <div class="doc-md-description">
            <p>The unit the array should be converted to. If <code>None</code> no conversion is made
and the original array`is returned.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>attrname</code></b>
          –
          <div class="doc-md-description">
            <p>The name of the attribute storing the array. Used for logging purposes.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Raises:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="ValueError">ValueError</span></code>
            –
          <div class="doc-md-description">
            <p>If the array cannot be converted from <code>unit</code> to <code>desired_unit_args</code>.</p>
          </div>
        </li>
    </ul>

            <details class="quote">
              <summary>Source code in <code>simple/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">convert_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">array</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">desired_unit</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">attrname</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a copy of the array converted to the desired unit.</span>

<span class="sd">    Supported units are the [mole and mass units][simple.utils.UNITS]. Converting between the *mass* and *mole** units is done by</span>
<span class="sd">    dividing/multiplying the values by the mass number.</span>

<span class="sd">    Always return a copy of ``array`` even if not conversion takes place.</span>

<span class="sd">    Args:</span>
<span class="sd">        array (): A key array.</span>
<span class="sd">        unit (): The current unit of the data in ``array``. If ``None`` the unit is assumed to be that of the</span>
<span class="sd">            ``desired_unit_args``.</span>
<span class="sd">        desired_unit (): The unit the array should be converted to. If ``None`` no conversion is made</span>
<span class="sd">            and the original array`is returned.</span>
<span class="sd">        attrname (): The name of the attribute storing the array. Used for logging purposes.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the array cannot be converted from ``unit`` to ``desired_unit_args``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">array</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">desired_unit</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}{</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">attrname</span><span class="p">)</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">attrname</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">: No desired unit specified. Assuming the desired unit is the current unit&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">array</span><span class="p">,</span> <span class="n">unit</span>
    <span class="k">elif</span> <span class="n">unit</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}{</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">attrname</span><span class="p">)</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">attrname</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">: Array does not have an assigned unit. Assuming the unit is the desired unit&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">array</span><span class="p">,</span> <span class="n">desired_unit</span>

    <span class="k">if</span> <span class="n">unit</span> <span class="ow">in</span> <span class="n">utils</span><span class="o">.</span><span class="n">UNITS</span><span class="p">[</span><span class="s1">&#39;mole&#39;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">desired_unit</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">utils</span><span class="o">.</span><span class="n">UNITS</span><span class="p">[</span><span class="s1">&#39;mole&#39;</span><span class="p">]:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}{</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">attrname</span><span class="p">)</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">attrname</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">:Both array unit and desired unit are ``mole`` units.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">array</span><span class="p">,</span> <span class="n">unit</span>
        <span class="k">elif</span> <span class="n">desired_unit</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">utils</span><span class="o">.</span><span class="n">UNITS</span><span class="p">[</span><span class="s1">&#39;mass&#39;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">array</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}{</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">attrname</span><span class="p">)</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">attrname</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">: Can only convert isotope key arrays&quot;</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}{</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">attrname</span><span class="p">)</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">attrname</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">: Converting array from ``mole`` to ``mass`` unit by multiplying the data by the mass number&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">array</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">m</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">asisotope</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="o">.</span><span class="n">mass</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                    <span class="k">pass</span> <span class="c1"># Leaves non-isotope values unchanged</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">array</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">*=</span> <span class="n">m</span>
            <span class="k">return</span> <span class="n">array</span><span class="p">,</span> <span class="n">desired_unit</span>

    <span class="k">elif</span> <span class="n">unit</span> <span class="ow">in</span> <span class="n">utils</span><span class="o">.</span><span class="n">UNITS</span><span class="p">[</span><span class="s1">&#39;mass&#39;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">desired_unit</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">utils</span><span class="o">.</span><span class="n">UNITS</span><span class="p">[</span><span class="s1">&#39;mass&#39;</span><span class="p">]:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}{</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">attrname</span><span class="p">)</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">attrname</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">: Both array unit and desired unit are ``mass`` units.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">array</span><span class="p">,</span> <span class="n">unit</span>
        <span class="k">elif</span> <span class="n">desired_unit</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">utils</span><span class="o">.</span><span class="n">UNITS</span><span class="p">[</span><span class="s1">&#39;mole&#39;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">array</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}{</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">attrname</span><span class="p">)</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">attrname</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">: Can only convert isotope key arrays&quot;</span><span class="p">)</span>

            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}{</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">attrname</span><span class="p">)</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">attrname</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">: Converting array from ``mass`` to ``mole`` unit by dividing the data by the mass number&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">array</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">m</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">asisotope</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="o">.</span><span class="n">mass</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                    <span class="k">pass</span> <span class="c1"># Leaves non-isotope values unchanged</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">array</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">/=</span> <span class="n">m</span>
            <span class="k">return</span> <span class="n">array</span><span class="p">,</span> <span class="n">desired_unit</span>

    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}{</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">attrname</span><span class="p">)</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">attrname</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">: Unable to convert from &#39;</span><span class="si">{</span><span class="n">unit</span><span class="si">}</span><span class="s2">&#39; to &#39;</span><span class="si">{</span><span class="n">desired_unit</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="simple.models.ModelBase.get_array" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">get_array</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_array</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">desired_unit</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Returns a copy of the named array with the desired unit.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code>name</code></b>
          –
          <div class="doc-md-description">
            <p>Name of the array to return. If <code>None</code> the default abundance array is returned.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>desired_unit</code></b>
          –
          <div class="doc-md-description">
            <p>The desired unit of the returned array.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          –
          <div class="doc-md-description">
            <p>A copy of the array with the desired unit.</p>
          </div>
        </li>
    </ul>

            <details class="quote">
              <summary>Source code in <code>simple/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">desired_unit</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a copy of the named array with the desired unit.</span>

<span class="sd">    Args:</span>
<span class="sd">        name (): Name of the array to return. If ``None`` the default abundance array is returned.</span>
<span class="sd">        desired_unit (): The desired unit of the returned array.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A copy of the array with the desired unit.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ABUNDANCE_KEYARRAY</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: No default array associated with this model&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ABUNDANCE_KEYARRAY</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_last_attr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: This model has no attribute called &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: Model attribute &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; is not an array&quot;</span><span class="p">)</span>

    <span class="n">unit</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_last_attr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">_unit&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">desired_unit</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="n">unit</span>
    <span class="k">elif</span> <span class="n">unit</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: Keyarray &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; has no unit attribute. Assuming unit is </span><span class="si">{</span><span class="n">desired_unit</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="n">desired_unit</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_array</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">desired_unit</span><span class="p">,</span> <span class="n">attrname</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">desired_unit</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="n">desired_unit</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">unit</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_last_attr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">_unit&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">unit</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: Keyarray &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; has no unit attribute. Assuming unit is </span><span class="si">{</span><span class="n">desired_unit</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="n">desired_unit</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_array</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">desired_unit</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="simple.models.ModelBase.get_array_labels" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">get_array_labels</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_array_labels</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Return default labels for a key array.</p>

            <details class="quote">
              <summary>Source code in <code>simple/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_array_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return default labels for a key array.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ABUNDANCE_KEYARRAY</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: No default array associated with this model&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ABUNDANCE_KEYARRAY</span>

    <span class="n">data_label</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">key_labels</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">latex</span><span class="p">:</span>
        <span class="n">data_label</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_last_attr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">_label_latex&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">key_labels</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_last_attr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">_keylabels_latex&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">data_label</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">data_label</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_last_attr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">_label&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">key_labels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">key_labels</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_last_attr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">_keylabels&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">data_label</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">data_label</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">parse_attrname</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">key_labels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_last_attr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">a</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="ow">and</span> <span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">names</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">key_labels</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">asisotopes</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
                <span class="n">key_labels</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">latex</span><span class="p">:</span>
                    <span class="n">key_labels</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">k</span><span class="o">.</span><span class="n">latex</span><span class="p">()</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">key_labels</span><span class="p">}</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">key_labels</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">key_labels</span><span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">key_labels</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">data_label</span><span class="p">,</span> <span class="n">key_labels</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="simple.models.ModelBase.get_mask" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">get_mask</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_mask</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">mask_attrs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Returns a selection mask for an array with <code>shape</code>.</p>
<p>This function is used by plotting functions to plot only a sub selction of the data. The mask string
can an integer representing an index, a slice or a condition that generates a mask. Use <code>&amp;</code> or <code>|</code>
to combine multiple indexes and/or conditions.</p>
<p>Supplied attributes can be accesed by putting a dot infront of the name, e.g. <code>.data &gt; 1</code>. The available
operators for mask conditions are <code>==</code>, <code>!=</code>, <code>&gt;</code>, <code>&gt;=</code>, <code>&lt;</code>, <code>&lt;=</code>.</p>
<p>The result of the mask evaluation must be broadcastable with <code>shape</code>. If it is not an all <code>False</code> mask is
returned.</p>
<p><strong>Note</strong>
- It is not possible to mix <code>&amp;</code> and <code>|</code> seperators. Doing so will raise an exception.
- Any text not precceded by a dot will be evaluated as text. Text on its own will always be evaluated
as <code>False</code>.
- An empty string will be evaluated as <code>True</code></p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code>mask</code></b>
          –
          <div class="doc-md-description">
            <p>String or object that will be evaluated to create a mask.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>shape</code></b>
          –
          <div class="doc-md-description">
            <p>Shape of the returned mask. If omitted the shape of the default abundance array is used.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>**mask_attrs</code></b>
          –
          <div class="doc-md-description">
            <p>Attributes to be used during the evaluation.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">get_mask</span><span class="p">(</span><span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">array([False, False, False,  True,  False])</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">get_mask</span><span class="p">(</span><span class="s1">&#39;1:3&#39;</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">array([False, True, True,  False,  False])</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">get_mask</span><span class="p">(</span><span class="s1">&#39;.data &gt;= 1 &amp; .data &lt; 3&#39;</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">a</span><span class="p">)</span>
<span class="go">array([False, True, True,  False,  False])</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">get_mask</span><span class="p">(</span><span class="s1">&#39;.data &gt;= 1 | .data &gt; 3&#39;</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">a</span><span class="p">)</span>
<span class="go">rray([True, True, False,  False,  True])</span>
</code></pre></div>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          –
          <div class="doc-md-description">
            <p>A boolean numpy array with <code>shape</code>.</p>
          </div>
        </li>
    </ul>

            <details class="quote">
              <summary>Source code in <code>simple/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_mask</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">shape</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">mask_attrs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a selection mask for an array with ``shape``.</span>

<span class="sd">    This function is used by plotting functions to plot only a sub selction of the data. The mask string</span>
<span class="sd">    can an integer representing an index, a slice or a condition that generates a mask. Use ``&amp;`` or ``|``</span>
<span class="sd">    to combine multiple indexes and/or conditions.</span>

<span class="sd">    Supplied attributes can be accesed by putting a dot infront of the name, e.g. ``.data &gt; 1``. The available</span>
<span class="sd">    operators for mask conditions are ``==``, ``!=``, ``&gt;``, ``&gt;=``, ``&lt;``, ``&lt;=``.</span>

<span class="sd">    The result of the mask evaluation must be broadcastable with ``shape``. If it is not an all ``False`` mask is</span>
<span class="sd">    returned.</span>

<span class="sd">    **Note**</span>
<span class="sd">    - It is not possible to mix ``&amp;`` and ``|`` seperators. Doing so will raise an exception.</span>
<span class="sd">    - Any text not precceded by a dot will be evaluated as text. Text on its own will always be evaluated</span>
<span class="sd">    as ``False``.</span>
<span class="sd">    - An empty string will be evaluated as ``True``</span>


<span class="sd">    Args:</span>
<span class="sd">        mask (): String or object that will be evaluated to create a mask.</span>
<span class="sd">        shape (): Shape of the returned mask. If omitted the shape of the default abundance array is used.</span>
<span class="sd">        **mask_attrs (): Attributes to be used during the evaluation.</span>


<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; a = np.array([0,1,2,3,4])</span>
<span class="sd">        &gt;&gt;&gt; model.get_mask(&#39;3&#39;, a.shape)</span>
<span class="sd">        array([False, False, False,  True,  False])</span>

<span class="sd">        &gt;&gt;&gt; model.get_mask(&#39;1:3&#39;, a.shape)</span>
<span class="sd">        array([False, True, True,  False,  False])</span>

<span class="sd">        &gt;&gt;&gt; model.get_mask(&#39;.data &gt;= 1 &amp; .data &lt; 3&#39;, a.shape, data=a)</span>
<span class="sd">        array([False, True, True,  False,  False])</span>

<span class="sd">        &gt;&gt;&gt; model.get_mask(&#39;.data &gt;= 1 | .data &gt; 3&#39;, a.shape, data=a)</span>
<span class="sd">        rray([True, True, False,  False,  True])</span>

<span class="sd">    Returns:</span>
<span class="sd">        A boolean numpy array with ``shape``.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">shape</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ABUNDANCE_KEYARRAY</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: Shape is required as there is no default key array associated with this model&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">shape</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ABUNDANCE_KEYARRAY</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>

    <span class="k">return</span> <span class="n">utils</span><span class="o">.</span><span class="n">mask_eval</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="o">**</span><span class="n">mask_attrs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="simple.models.ModelBase.internal_normalisation" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">internal_normalisation</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">internal_normalisation</span><span class="p">(</span><span class="n">normrat</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">isotopes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">enrichment_factor</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">relative_enrichment</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">convert_unit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">attrname</span><span class="o">=</span><span class="s1">&#39;intnorm&#39;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;largest_offset&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">method_kwargs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Internally normalise the appropriate data of the model. See
<a class="autorefs autorefs-internal" href="../norm/#simple.norm.internal_normalisation">internal_normalisation</a> for a description of the procedure and a
description of the arguments.</p>
<p>The result of the normalisation will be saved under the <code>normname</code> attribute.</p>


<p><span class="doc-section-title">Raises:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="NotImplementedError">NotImplementedError</span></code>
            –
          <div class="doc-md-description">
            <p>Raised if the data to be normalised has not been specified for this model class.</p>
          </div>
        </li>
    </ul>

            <details class="quote">
              <summary>Source code in <code>simple/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span>
<span class="normal">955</span>
<span class="normal">956</span>
<span class="normal">957</span>
<span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span>
<span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span>
<span class="normal">967</span>
<span class="normal">968</span>
<span class="normal">969</span>
<span class="normal">970</span>
<span class="normal">971</span>
<span class="normal">972</span>
<span class="normal">973</span>
<span class="normal">974</span>
<span class="normal">975</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">internal_normalisation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">normrat</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">isotopes</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                           <span class="n">enrichment_factor</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">relative_enrichment</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                           <span class="n">convert_unit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">attrname</span><span class="o">=</span><span class="s1">&#39;intnorm&#39;</span><span class="p">,</span>
                           <span class="n">method</span><span class="o">=</span><span class="s1">&#39;largest_offset&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">method_kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Internally normalise the appropriate data of the model. See</span>
<span class="sd">    [internal_normalisation][simple.norm.internal_normalisation] for a description of the procedure and a</span>
<span class="sd">    description of the arguments.</span>

<span class="sd">    The result of the normalisation will be saved under the ``normname`` attribute.</span>

<span class="sd">    Raises:</span>
<span class="sd">        NotImplementedError: Raised if the data to be normalised has not been specified for this model class.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ABUNDANCE_KEYARRAY</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">: The data to be normalised in has not been specified for this model&#39;</span><span class="p">)</span>

    <span class="c1"># The abundances to be normalised</span>
    <span class="n">abu</span><span class="p">,</span> <span class="n">abu_unit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ABUNDANCE_KEYARRAY</span><span class="p">,</span> <span class="s1">&#39;mol&#39;</span> <span class="k">if</span> <span class="n">convert_unit</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>

    <span class="c1"># Isotope masses</span>
    <span class="n">stdmass</span><span class="p">,</span> <span class="n">stdmass_unit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ref_isomass</span><span class="o">.</span><span class="n">get_array</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">)</span>

    <span class="c1"># The reference abundances. Typically, the initial values of the model</span>
    <span class="n">stdabu</span><span class="p">,</span> <span class="n">stdabu_unit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ref_isoabu</span><span class="o">.</span><span class="n">get_array</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="s1">&#39;mol&#39;</span> <span class="k">if</span> <span class="n">convert_unit</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>

    <span class="n">result</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">internal_normalisation</span><span class="p">(</span><span class="n">abu</span><span class="p">,</span> <span class="n">isotopes</span><span class="p">,</span> <span class="n">normrat</span><span class="p">,</span> <span class="n">stdmass</span><span class="p">,</span> <span class="n">stdabu</span><span class="p">,</span>
                                         <span class="n">enrichment_factor</span><span class="o">=</span><span class="n">enrichment_factor</span><span class="p">,</span> <span class="n">relative_enrichment</span><span class="o">=</span><span class="n">relative_enrichment</span><span class="p">,</span>
                                         <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
                                         <span class="n">msg_prefix</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">.</span><span class="si">{</span><span class="n">utils</span><span class="o">.</span><span class="n">parse_attrname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ABUNDANCE_KEYARRAY</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
                                         <span class="o">**</span><span class="n">method_kwargs</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">setattr</span><span class="p">(</span><span class="n">attrname</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">hdf5_compatible</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="simple.models.ModelBase.select_isolist" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">select_isolist</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">select_isolist</span><span class="p">(</span><span class="n">isolist</span><span class="p">,</span> <span class="n">convert_unit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Used to create a subselection of the data used for normalisation in the current model.</p>
<p><strong>Notes</strong></p>
<p>The original array will be overwritten with the new subselection.</p>
<p>If <code>&lt;name&gt;_values</code> and <code>&lt;name&gt;_keys</code> exist they will also be overwritten with the
result of the new selection.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code>isolist</code></b>
          –
          <div class="doc-md-description">
            <p>Either a list of isotopes to be selected or a dictionary consisting of the
final isotope mapped to a list of isotopes to be added together for this isotope.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>convert_unit</code></b>
          –
          <div class="doc-md-description">
            <p>If <code>True</code>  and data is stored in a mass unit all values will be divided by the mass number of
the isotope before summing values together. The final value is then multiplied by the mass number of the
output isotope.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Raises:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="NotImplementedError">NotImplementedError</span></code>
            –
          <div class="doc-md-description">
            <p>Raised if the data to be normalised has not been specified for this model class.</p>
          </div>
        </li>
    </ul>

            <details class="quote">
              <summary>Source code in <code>simple/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">select_isolist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">isolist</span><span class="p">,</span> <span class="n">convert_unit</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Used to create a subselection of the data used for normalisation in the current model.</span>

<span class="sd">    **Notes**</span>

<span class="sd">    The original array will be overwritten with the new subselection.</span>

<span class="sd">    If ``&lt;name&gt;_values`` and ``&lt;name&gt;_keys`` exist they will also be overwritten with the</span>
<span class="sd">    result of the new selection.</span>

<span class="sd">    Args:</span>
<span class="sd">        isolist (): Either a list of isotopes to be selected or a dictionary consisting of the</span>
<span class="sd">            final isotope mapped to a list of isotopes to be added together for this isotope.</span>
<span class="sd">        convert_unit: If ``True``  and data is stored in a mass unit all values will be divided by the mass number of</span>
<span class="sd">            the isotope before summing values together. The final value is then multiplied by the mass number of the</span>
<span class="sd">            output isotope.</span>

<span class="sd">    Raises:</span>
<span class="sd">        NotImplementedError: Raised if the data to be normalised has not been specified for this model class.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Updates the relevant arrays inplace</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ABUNDANCE_KEYARRAY</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">: The data to be normalised in has not been specified for this model&#39;</span><span class="p">)</span>

    <span class="n">abu</span><span class="p">,</span> <span class="n">abu_unit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ABUNDANCE_KEYARRAY</span><span class="p">,</span> <span class="s1">&#39;mol&#39;</span> <span class="k">if</span> <span class="n">convert_unit</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>

    <span class="n">abu</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">select_isolist</span><span class="p">(</span><span class="n">isolist</span><span class="p">,</span> <span class="n">abu</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">convert_unit</span><span class="p">:</span>
        <span class="n">original_unit</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ABUNDANCE_KEYARRAY</span><span class="si">}</span><span class="s2">_unit&quot;</span><span class="p">,</span> <span class="s2">&quot;mol&quot;</span><span class="p">)</span>
        <span class="n">abu</span><span class="p">,</span> <span class="n">abu_unit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_array</span><span class="p">(</span><span class="n">abu</span><span class="p">,</span> <span class="s1">&#39;mol&#39;</span><span class="p">,</span> <span class="n">original_unit</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ABUNDANCE_KEYARRAY</span><span class="p">,</span> <span class="n">abu</span><span class="p">,</span> <span class="n">hdf5_compatible</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">vname</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ABUNDANCE_KEYARRAY</span><span class="si">}</span><span class="s2">_values&quot;</span>
    <span class="k">if</span> <span class="n">vname</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">hdf5_attrs</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setattr</span><span class="p">(</span><span class="n">vname</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">abu</span><span class="o">.</span><span class="n">tolist</span><span class="p">()),</span> <span class="n">hdf5_compatible</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">vname</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">normal_attrs</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setattr</span><span class="p">(</span><span class="n">vname</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">abu</span><span class="o">.</span><span class="n">tolist</span><span class="p">()),</span> <span class="n">hdf5_compatible</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">kname</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ABUNDANCE_KEYARRAY</span><span class="si">}</span><span class="s2">_keys&quot;</span>
    <span class="k">if</span> <span class="n">kname</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">hdf5_attrs</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setattr</span><span class="p">(</span><span class="n">kname</span><span class="p">,</span> <span class="n">utils</span><span class="o">.</span><span class="n">asisotopes</span><span class="p">(</span><span class="n">abu</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">names</span><span class="p">),</span> <span class="n">hdf5_compatible</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">kname</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">normal_attrs</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setattr</span><span class="p">(</span><span class="n">kname</span><span class="p">,</span> <span class="n">utils</span><span class="o">.</span><span class="n">asisotopes</span><span class="p">(</span><span class="n">abu</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">names</span><span class="p">),</span> <span class="n">hdf5_compatible</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="simple.models.ModelBase.setattr" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">setattr</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nb">setattr</span><span class="p">(</span><span class="nf">name</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">hdf5_compatible</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Set the value of a model attribute.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code>name</code></b>
          –
          <div class="doc-md-description">
            <p>Name of the attribute</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>value</code></b>
          –
          <div class="doc-md-description">
            <p>The value of the attribute</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>hdf5_compatible</code></b>
          –
          <div class="doc-md-description">
            <p>Should be <code>True</code> if the attribute should be included when the model is
saved as a hdf5 file. <code>value</code> will be automatically converted to a hdf5 compatible value.
An exception may be raised if this is not possible.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>overwrite</code></b>
          –
          <div class="doc-md-description">
            <p>Overwrite any existing attribute called <code>name</code>. An exception is raised if <code>name</code>
exists and <code>overwrite</code> is <code>False</code>.</p>
          </div>
        </li>
    </ul>

            <details class="quote">
              <summary>Source code in <code>simple/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">hdf5_compatible</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">overwrite</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set the value of a model attribute.</span>

<span class="sd">    Args:</span>
<span class="sd">        name (): Name of the attribute</span>
<span class="sd">        value (): The value of the attribute</span>
<span class="sd">        hdf5_compatible (): Should be ``True`` if the attribute should be included when the model is</span>
<span class="sd">            saved as a hdf5 file. ``value`` will be automatically converted to a hdf5 compatible value.</span>
<span class="sd">            An exception may be raised if this is not possible.</span>
<span class="sd">        overwrite (): Overwrite any existing attribute called ``name``. An exception is raised if ``name``</span>
<span class="sd">            exists and ``overwrite`` is ``False``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; object has an attribute &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">hdf5_attrs</span> <span class="ow">or</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">normal_attrs</span><span class="p">)</span> <span class="ow">and</span> <span class="n">overwrite</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; already exists&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">hdf5_attrs</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hdf5_attrs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">normal_attrs</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">REQUIRED_ATTRS</span> <span class="ow">and</span> <span class="n">hdf5_compatible</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> is a required attribute and therefore must be hdf5 compatible&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">normal_attrs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">hdf5_compatible</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hdf5_attrs</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">normal_attrs</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="simple.models.ModelBase.standard_normalisation" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">standard_normalisation</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">standard_normalisation</span><span class="p">(</span><span class="n">normiso</span><span class="p">,</span> <span class="n">isotopes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">enrichment_factor</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">relative_enrichment</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">convert_unit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">attrname</span><span class="o">=</span><span class="s1">&#39;stdnorm&#39;</span><span class="p">,</span> <span class="n">dilution_factor</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Normalise the appropriate data of the model. See
<a class="autorefs autorefs-internal" href="../norm/#simple.norm.standard_normalisation">standard_normalisation</a> for a description of the procedure and a
description of the arguments.</p>
<p>The result of the normalisation will be saved under the <code>normname</code> attribute.</p>


<p><span class="doc-section-title">Raises:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="NotImplementedError">NotImplementedError</span></code>
            –
          <div class="doc-md-description">
            <p>Raised if the data to be normalised has not been specified for this model class.</p>
          </div>
        </li>
    </ul>

            <details class="quote">
              <summary>Source code in <code>simple/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">standard_normalisation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">normiso</span><span class="p">,</span> <span class="n">isotopes</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">enrichment_factor</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">relative_enrichment</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                         <span class="n">convert_unit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">attrname</span><span class="o">=</span><span class="s1">&#39;stdnorm&#39;</span><span class="p">,</span> <span class="n">dilution_factor</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Normalise the appropriate data of the model. See</span>
<span class="sd">    [standard_normalisation][simple.norm.standard_normalisation] for a description of the procedure and a</span>
<span class="sd">    description of the arguments.</span>

<span class="sd">    The result of the normalisation will be saved under the ``normname`` attribute.</span>

<span class="sd">    Raises:</span>
<span class="sd">        NotImplementedError: Raised if the data to be normalised has not been specified for this model class.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ABUNDANCE_KEYARRAY</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">: The data to be normalised has not been specified for this model&#39;</span><span class="p">)</span>

    <span class="n">abu</span><span class="p">,</span> <span class="n">abu_unit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ABUNDANCE_KEYARRAY</span><span class="p">,</span> <span class="s1">&#39;mol&#39;</span> <span class="k">if</span> <span class="n">convert_unit</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>

    <span class="n">stdabu</span><span class="p">,</span> <span class="n">stdabu_unit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ref_isoabu</span><span class="o">.</span><span class="n">get_array</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="s1">&#39;mol&#39;</span> <span class="k">if</span> <span class="n">convert_unit</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>

    <span class="n">result</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">standard_normalisation</span><span class="p">(</span><span class="n">abu</span><span class="p">,</span> <span class="n">isotopes</span><span class="p">,</span> <span class="n">normiso</span><span class="p">,</span> <span class="n">stdabu</span><span class="p">,</span>
                                         <span class="n">enrichment_factor</span><span class="o">=</span><span class="n">enrichment_factor</span><span class="p">,</span> <span class="n">relative_enrichment</span><span class="o">=</span><span class="n">relative_enrichment</span><span class="p">,</span>
                                         <span class="n">dilution_factor</span><span class="o">=</span><span class="n">dilution_factor</span><span class="p">,</span>
                                         <span class="n">msg_prefix</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">.</span><span class="si">{</span><span class="n">utils</span><span class="o">.</span><span class="n">parse_attrname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ABUNDANCE_KEYARRAY</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">setattr</span><span class="p">(</span><span class="n">attrname</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">hdf5_compatible</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="simple.models.ModelCollection" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">simple.models.ModelCollection</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">ModelCollection</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">


        <p>The main interface for working with a collection of models.</p>

        <p>Create an empty model collection.</p>

                  <details class="quote">
                    <summary>Source code in <code>simple/models.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create an empty model collection.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">refs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">models</span> <span class="o">=</span> <span class="p">[]</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="simple.models.ModelCollection.models" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">models</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">models</span> <span class="o">=</span> <span class="p">[]</span>
</code></pre></div>

    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="simple.models.ModelCollection.refs" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">refs</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">refs</span> <span class="o">=</span> <span class="p">[]</span>
</code></pre></div>

    <div class="doc doc-contents ">
    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="simple.models.ModelCollection.add_model" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">add_model</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">add_model</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Add <code>model</code> to the collection if it is not already present.</p>

            <details class="quote">
              <summary>Source code in <code>simple/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add ``model`` to the collection if it is not already present.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">ModelBase</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;``model`` must be a Model object, not </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">model</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">model</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">model</span>

    <span class="k">if</span> <span class="kc">True</span> <span class="ow">in</span> <span class="p">[</span><span class="n">m</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">model</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;A model with the name &#39;</span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; already exists in this collection&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">normal_attrs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">k</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;ref_&#39;</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">ModelBase</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_ref</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">model</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="simple.models.ModelCollection.add_ref" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">add_ref</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">add_ref</span><span class="p">(</span><span class="n">ref</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Add reference <code>ref</code> to the collection if it is not already present.</p>

            <details class="quote">
              <summary>Source code in <code>simple/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_ref</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ref</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add reference ``ref`` to the collection if it is not already present.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ref</span><span class="p">,</span> <span class="n">ModelBase</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;``ref`` must be a Model object, not </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">ref</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">ref</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">refs</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ref</span>

    <span class="k">if</span> <span class="kc">True</span> <span class="ow">in</span> <span class="p">[</span><span class="n">m</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">ref</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">refs</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;A reference model with the name &#39;</span><span class="si">{</span><span class="n">ref</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; already exists in this collection&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ref</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ref</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="simple.models.ModelCollection.get_model" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">get_model</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_model</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">attr</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Returns the model with the given name.</p>
<p>If <code>attr</code> is given then the value of that attribute from the model is returned instead.</p>

            <details class="quote">
              <summary>Source code in <code>simple/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">attr</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the model with the given name.</span>

<span class="sd">    If ``attr`` is given then the value of that attribute from the model is returned instead.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">name</span><span class="p">:</span>
            <span class="k">break</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No model called &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; exists&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">attr</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">model</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">model</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="simple.models.ModelCollection.get_ref" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">get_ref</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_ref</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">attr</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Returns the reference model with the given name.</p>
<p>If <code>attr</code> is given then the value of that attribute from the model is returned instead.</p>

            <details class="quote">
              <summary>Source code in <code>simple/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_ref</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">attr</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the reference model with the given name.</span>

<span class="sd">    If ``attr`` is given then the value of that attribute from the model is returned instead.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">ref</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">refs</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ref</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">name</span><span class="p">:</span>
            <span class="k">break</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No reference called &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; exists&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">attr</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ref</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ref</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="simple.models.ModelCollection.internal_normalisation" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">internal_normalisation</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">internal_normalisation</span><span class="p">(</span><span class="n">normrat</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">isotopes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">enrichment_factor</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">relative_enrichment</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">convert_unit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">attrname</span><span class="o">=</span><span class="s1">&#39;intnorm&#39;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;largest_offset&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">method_kwargs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Internally normalise the appropriate data of the model. See
<a class="autorefs autorefs-internal" href="../norm/#simple.norm.internal_normalisation">internal_normalisation</a> for a description of the procedure and a
description of the arguments.</p>
<p>The result of the normalisation will be saved to each model under the <code>normname</code> attribute.</p>


<p><span class="doc-section-title">Raises:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="NotImplementedError">NotImplementedError</span></code>
            –
          <div class="doc-md-description">
            <p>Raised if the data to be normalised has not been specified for this model class.</p>
          </div>
        </li>
    </ul>

            <details class="quote">
              <summary>Source code in <code>simple/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">internal_normalisation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">normrat</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">isotopes</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                           <span class="n">enrichment_factor</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">relative_enrichment</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                           <span class="n">convert_unit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">attrname</span> <span class="o">=</span> <span class="s1">&#39;intnorm&#39;</span><span class="p">,</span>
                           <span class="n">method</span><span class="o">=</span><span class="s1">&#39;largest_offset&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">method_kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Internally normalise the appropriate data of the model. See</span>
<span class="sd">    [internal_normalisation][simple.norm.internal_normalisation] for a description of the procedure and a</span>
<span class="sd">    description of the arguments.</span>

<span class="sd">    The result of the normalisation will be saved to each model under the ``normname`` attribute.</span>

<span class="sd">    Raises:</span>
<span class="sd">        NotImplementedError: Raised if the data to be normalised has not been specified for this model class.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">:</span>
        <span class="n">model</span><span class="o">.</span><span class="n">internal_normalisation</span><span class="p">(</span><span class="n">normrat</span><span class="p">,</span> <span class="n">isotopes</span><span class="o">=</span><span class="n">isotopes</span><span class="p">,</span>
                                     <span class="n">enrichment_factor</span><span class="o">=</span><span class="n">enrichment_factor</span><span class="p">,</span> <span class="n">relative_enrichment</span><span class="o">=</span><span class="n">relative_enrichment</span><span class="p">,</span>
                                     <span class="n">convert_unit</span><span class="o">=</span><span class="n">convert_unit</span><span class="p">,</span> <span class="n">attrname</span><span class="o">=</span><span class="n">attrname</span><span class="p">,</span>
                                     <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="o">**</span><span class="n">method_kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="simple.models.ModelCollection.load_file" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">load_file</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">load_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">isolist</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">convert_unit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">where_kwargs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Add models from file to the current collection.</p>
<p><strong>Note</strong> existing models with the same name one of the loaded models will be overwritten.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code>filename</code></b>
          –
          <div class="doc-md-description">
            <p>Name of the file to load.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>isolist</code></b>
          –
          <div class="doc-md-description">
            <p>Isolist applied to loaded models. If <code>None</code> no subselection is made.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>convert_unit</code></b>
          –
          <div class="doc-md-description">
            <p>Whether to convert units to the mole unit, as recommended, when creating the isolist.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>where</code></b>
          –
          <div class="doc-md-description">
            <p>String evaluation used to select which models to load.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>**where_kwargs</code></b>
          –
          <div class="doc-md-description">
            <p>Additional keyword arguments used together with <code>where</code>.</p>
          </div>
        </li>
    </ul>

            <details class="quote">
              <summary>Source code in <code>simple/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">load_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">isolist</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">convert_unit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">where_kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Add models from file to the current collection.</span>

<span class="sd">    **Note** existing models with the same name one of the loaded models will be overwritten.</span>

<span class="sd">    Args:</span>
<span class="sd">        filename (): Name of the file to load.</span>
<span class="sd">        isolist (): Isolist applied to loaded models. If ``None`` no subselection is made.</span>
<span class="sd">        convert_unit (): Whether to convert units to the mole unit, as recommended, when creating the isolist.</span>
<span class="sd">        where (): String evaluation used to select which models to load.</span>
<span class="sd">        **where_kwargs (): Additional keyword arguments used together with ``where``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Loading file: </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">t0</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">efile</span><span class="p">:</span>
        <span class="n">file_type</span> <span class="o">=</span> <span class="n">efile</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FILE_TYPE&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">version</span> <span class="o">=</span> <span class="n">efile</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;VERSION&#39;</span><span class="p">,</span> <span class="s2">&quot;-1&quot;</span><span class="p">)</span>
        <span class="n">created</span> <span class="o">=</span> <span class="n">efile</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CREATED&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">file_type</span> <span class="o">!=</span> <span class="s2">&quot;simple.ModelCollection&quot;</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;File </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s1"> is not a simple.ModelCollection file&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">version</span><span class="p">))</span> <span class="o">!=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__version__</span><span class="p">)):</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;File </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s1"> was created with ModelCollection v</span><span class="si">{</span><span class="n">version</span><span class="si">}</span><span class="s1">, but this version of simple uses ModelCollection v</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">__version__</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">efile</span><span class="p">[</span><span class="s1">&#39;refs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">ref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load_ref</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_ref</span><span class="p">(</span><span class="n">ref</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">efile</span><span class="p">[</span><span class="s1">&#39;models&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load_model</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">isolist</span><span class="p">,</span> <span class="n">convert_unit</span><span class="p">,</span> <span class="n">where</span><span class="p">,</span> <span class="n">where_kwargs</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_model</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

    <span class="n">t</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="n">t0</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Time to load file: </span><span class="si">{</span><span class="n">t</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="simple.models.ModelCollection.new_model" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">new_model</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">new_model</span><span class="p">(</span><span class="n">clsname</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">attrs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Create a new model and add it to the current collection.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code>clsname</code></b>
          –
          <div class="doc-md-description">
            <p>The name of the model class to be created.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>name</code></b>
          –
          <div class="doc-md-description">
            <p>Name of the new model.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>**attrs</code></b>
          –
          <div class="doc-md-description">
            <p>Attributes to be added to the new model.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          –
          <div class="doc-md-description">
            <p>The newly created model.</p>
          </div>
        </li>
    </ul>

            <details class="quote">
              <summary>Source code in <code>simple/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">new_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">clsname</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">attrs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a new model and add it to the current collection.</span>

<span class="sd">    Args:</span>
<span class="sd">        clsname (): The name of the model class to be created.</span>
<span class="sd">        name (): Name of the new model.</span>
<span class="sd">        **attrs (): Attributes to be added to the new model.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The newly created model.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">clsname</span> <span class="ow">in</span> <span class="n">AllModelClasses</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">AllModelClasses</span><span class="p">[</span><span class="n">clsname</span><span class="p">](</span><span class="n">name</span><span class="p">,</span> <span class="n">reference_models_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">refs</span><span class="p">,</span> <span class="o">**</span><span class="n">attrs</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_model</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No model class called &#39;</span><span class="si">{</span><span class="n">clsname</span><span class="si">}</span><span class="s2">&#39; exists&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="simple.models.ModelCollection.new_ref" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">new_ref</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">new_ref</span><span class="p">(</span><span class="n">clsname</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">attrs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Create a new reference model and add it to the current collection.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code>clsname</code></b>
          –
          <div class="doc-md-description">
            <p>The name of the model class to be created.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>name</code></b>
          –
          <div class="doc-md-description">
            <p>Name of the new model.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>**attrs</code></b>
          –
          <div class="doc-md-description">
            <p>Attributes to be added to the new model.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          –
          <div class="doc-md-description">
            <p>The newly created reference model.</p>
          </div>
        </li>
    </ul>

            <details class="quote">
              <summary>Source code in <code>simple/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">new_ref</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">clsname</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">attrs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a new reference model and add it to the current collection.</span>

<span class="sd">    Args:</span>
<span class="sd">        clsname (): The name of the model class to be created.</span>
<span class="sd">        name (): Name of the new model.</span>
<span class="sd">        **attrs (): Attributes to be added to the new model.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The newly created reference model.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">clsname</span> <span class="ow">in</span> <span class="n">AllModelClasses</span><span class="p">:</span>
        <span class="n">ref</span> <span class="o">=</span> <span class="n">AllModelClasses</span><span class="p">[</span><span class="n">clsname</span><span class="p">](</span><span class="n">name</span><span class="p">,</span> <span class="n">reference_models_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">refs</span><span class="p">,</span> <span class="o">**</span><span class="n">attrs</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_ref</span><span class="p">(</span><span class="n">ref</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No model class called &#39;</span><span class="si">{</span><span class="n">clsname</span><span class="si">}</span><span class="s2">&#39; exists&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="simple.models.ModelCollection.save" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">save</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">save</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Save the current selection of models.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code>filename</code></b>
          –
          <div class="doc-md-description">
            <p>Name of the file to be created.</p>
          </div>
        </li>
    </ul>

            <details class="quote">
              <summary>Source code in <code>simple/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Save the current selection of models.</span>

<span class="sd">    Args:</span>
<span class="sd">        filename (): Name of the file to be created.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">filename</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">:]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">!=</span> <span class="s1">&#39;.hdf5&#39;</span><span class="p">:</span>
        <span class="n">filename</span> <span class="o">+=</span> <span class="s1">&#39;.hdf5&#39;</span>

    <span class="n">t0</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">file</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;FILE_TYPE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;simple.ModelCollection&quot;</span>
        <span class="n">file</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;VERSION&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__version__</span>
        <span class="n">file</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;CREATED&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Saving ModelCollection(v</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">__version__</span><span class="si">}</span><span class="s1">) as: </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="n">ref_group</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">create_group</span><span class="p">(</span><span class="s1">&#39;refs&#39;</span><span class="p">,</span> <span class="n">track_order</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ref</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">refs</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;saving ref: </span><span class="si">{</span><span class="n">ref</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_save_model</span><span class="p">(</span><span class="n">ref_group</span><span class="p">,</span> <span class="n">ref</span><span class="p">)</span>

        <span class="n">model_group</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">create_group</span><span class="p">(</span><span class="s1">&#39;models&#39;</span><span class="p">,</span> <span class="n">track_order</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;saving model: </span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_save_model</span><span class="p">(</span><span class="n">model_group</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>

    <span class="n">t</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="n">t0</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Filesize: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">1024</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">1024</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> MB&#39;</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Time to save file: </span><span class="si">{</span><span class="n">t</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="simple.models.ModelCollection.select_isolist" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">select_isolist</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">select_isolist</span><span class="p">(</span><span class="n">isolist</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Used to create a subselection of data from each model.</p>
<p><strong>Note</strong> The original array may be overwritten with the new subselection.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code>isolist</code></b>
          –
          <div class="doc-md-description">
            <p>Either a list of isotopes to be selected or a dictionary consisting of the</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Raises:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="NotImplementedError">NotImplementedError</span></code>
            –
          <div class="doc-md-description">
            <p>Raised if this method has not been implemented for a model class.</p>
          </div>
        </li>
    </ul>

            <details class="quote">
              <summary>Source code in <code>simple/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">select_isolist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">isolist</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Used to create a subselection of data from each model.</span>

<span class="sd">    **Note** The original array may be overwritten with the new subselection.</span>

<span class="sd">    Args:</span>
<span class="sd">        isolist (): Either a list of isotopes to be selected or a dictionary consisting of the</span>
<span class="sd">        final isotope mapped to a list of isotopes to be added together for this isotope.</span>

<span class="sd">    Raises:</span>
<span class="sd">        NotImplementedError: Raised if this method has not been implemented for a model class.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">:</span>
        <span class="n">model</span><span class="o">.</span><span class="n">select_isolist</span><span class="p">(</span><span class="n">isolist</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="simple.models.ModelCollection.standard_normalisation" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">standard_normalisation</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">standard_normalisation</span><span class="p">(</span><span class="n">normiso</span><span class="p">,</span> <span class="n">enrichment_factor</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">relative_enrichment</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">convert_unit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">attrname</span><span class="o">=</span><span class="s1">&#39;stdnorm&#39;</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Normalise the appropriate data of the model. See
[simple_normalisation][simple.norm.simple_normalisation] for a description of the procedure and a
description of the arguments.</p>
<p>The result of the normalisation will be saved to each model under the <code>normname</code> attribute.</p>


<p><span class="doc-section-title">Raises:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="NotImplementedError">NotImplementedError</span></code>
            –
          <div class="doc-md-description">
            <p>Raised if the data to be normalised has not been specified for this model class.</p>
          </div>
        </li>
    </ul>

            <details class="quote">
              <summary>Source code in <code>simple/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">standard_normalisation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">normiso</span><span class="p">,</span> <span class="n">enrichment_factor</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">relative_enrichment</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                         <span class="n">convert_unit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">attrname</span> <span class="o">=</span> <span class="s1">&#39;stdnorm&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Normalise the appropriate data of the model. See</span>
<span class="sd">    [simple_normalisation][simple.norm.simple_normalisation] for a description of the procedure and a</span>
<span class="sd">    description of the arguments.</span>

<span class="sd">    The result of the normalisation will be saved to each model under the ``normname`` attribute.</span>

<span class="sd">    Raises:</span>
<span class="sd">        NotImplementedError: Raised if the data to be normalised has not been specified for this model class.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">:</span>
        <span class="n">model</span><span class="o">.</span><span class="n">standard_normalisation</span><span class="p">(</span><span class="n">normiso</span><span class="p">,</span> <span class="n">enrichment_factor</span><span class="o">=</span><span class="n">enrichment_factor</span><span class="p">,</span>
                                     <span class="n">relative_enrichment</span><span class="o">=</span><span class="n">relative_enrichment</span><span class="p">,</span>
                                     <span class="n">convert_unit</span><span class="o">=</span><span class="n">convert_unit</span><span class="p">,</span> <span class="n">attrname</span><span class="o">=</span><span class="n">attrname</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="simple.models.ModelCollection.where" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">where</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">where</span><span class="p">(</span><span class="n">where</span><span class="p">,</span> <span class="o">**</span><span class="n">where_kwargs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Returns a copy of the collection containing only the models which match the <code>where</code> argument.</p>
<p>Use <code>&amp;</code> or <code>|</code> to combine multiple evaluations. To evaluate an attribute of each model put a
dot before the name e.g. <code>.mass == 15</code>. To use one of the <code>where_kwargs</code> values put the name
of the kwarg within pointy brackets e.g. <code>.mass == {mass_kwarg}</code>.</p>
<p>The available operators for evaluations are <code>==</code>, <code>!=</code>, <code>&gt;</code>, <code>&gt;=</code>, <code>&lt;</code>, <code>&lt;=</code>,
<code>IN</code>, and <code>NOT IN</code>.</p>
<p><strong>Note</strong> that a shallow copy of the matching models is returned.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code>where</code></b>
          –
          <div class="doc-md-description">
            <p>A string with the evaluation to perform for each model.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>**where_kwargs</code></b>
          –
          <div class="doc-md-description">
            <p>Arguments used for the evaluation.</p>
          </div>
        </li>
    </ul>

            <details class="quote">
              <summary>Source code in <code>simple/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">where</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">where</span><span class="p">,</span> <span class="o">**</span><span class="n">where_kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a copy of the collection containing only the models which match the ``where`` argument.</span>

<span class="sd">    Use ``&amp;`` or ``|`` to combine multiple evaluations. To evaluate an attribute of each model put a</span>
<span class="sd">    dot before the name e.g. ``.mass == 15``. To use one of the ``where_kwargs`` values put the name</span>
<span class="sd">    of the kwarg within pointy brackets e.g. ``.mass == {mass_kwarg}``.</span>

<span class="sd">    The available operators for evaluations are ``==``, ``!=``, ``&gt;``, ``&gt;=``, ``&lt;``, ``&lt;=``,</span>
<span class="sd">    `` IN ``, and `` NOT IN ``.</span>

<span class="sd">    **Note** that a shallow copy of the matching models is returned.</span>

<span class="sd">    Args:</span>
<span class="sd">        where (): A string with the evaluation to perform for each model.</span>
<span class="sd">        **where_kwargs (): Arguments used for the evaluation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">models</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">models_where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">,</span> <span class="n">where</span><span class="p">,</span> <span class="o">**</span><span class="n">where_kwargs</span><span class="p">)</span>

    <span class="n">new_collection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span><span class="p">:</span>
        <span class="n">new_collection</span><span class="o">.</span><span class="n">add_model</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">new_collection</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="simple.models.load_collection" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">simple.models.load_collection</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">load_collection</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">dbfilename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">default_isolist</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">convert_unit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">where_kwargs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Loads a selection of models from a file.</p>
<p>If that file does not exist it will create the file from the specified models file. Only when doing this
is the <code>default_isolist</code> applied. If <code>filename</code> already exits the <strong>assumption</strong> is it has the correct isolist.</p>
<p><strong>*Notes</strong></p>
<p>The entire file will be read into memory. This might be an issue if reading very large files. The hdf5 are
compressed so will be significantly larger when stored in memory.</p>
<p>When reading the database file to create a subselection of the data using <code>default_isolist</code>, the subselection is
 made when each model is loaded which reduces the amount of memory used.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code>filename</code></b>
              (<code><span title="str">str</span></code>)
          –
          <div class="doc-md-description">
            <p>Name of the file to load or create.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>dbfilename</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Name of the _func models file</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>default_isolist</code></b>
          –
          <div class="doc-md-description">
            <p>Isolist applied to loaded models from <code>dbfilename</code>.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>convert_units</code></b>
              (<code><span title="bool">bool</span></code>)
          –
          <div class="doc-md-description">
            <p>If <code>True</code>  and data is stored in a mass unit all values will be divided by the
mass number of the isotope before summing values together. The final value is then multiplied by the
mass number of the output isotope.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>overwrite</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>If <code>True</code> a new file will be created even if <code>filename</code> already exists.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>where</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Used to select which models to load.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>**where_kwargs</code></b>
          –
          <div class="doc-md-description">
            <p>Keyword arguments used in combination with <code>where</code>.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          –
          <div class="doc-md-description">
            <p>A <a class="autorefs autorefs-internal" href="#simple.models.ModelCollection">ModelCollection</a> object containing all the loaded models.</p>
          </div>
        </li>
    </ul>

            <details class="quote">
              <summary>Source code in <code>simple/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">load_collection</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">dbfilename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">default_isolist</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">convert_unit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">where</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">where_kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Loads a selection of models from a file.</span>

<span class="sd">    If that file does not exist it will create the file from the specified models file. Only when doing this</span>
<span class="sd">    is the ``default_isolist`` applied. If ``filename`` already exits the **assumption** is it has the correct isolist.</span>

<span class="sd">    ***Notes**</span>

<span class="sd">    The entire file will be read into memory. This might be an issue if reading very large files. The hdf5 are</span>
<span class="sd">    compressed so will be significantly larger when stored in memory.</span>

<span class="sd">    When reading the database file to create a subselection of the data using ``default_isolist``, the subselection is</span>
<span class="sd">     made when each model is loaded which reduces the amount of memory used.</span>

<span class="sd">    Args:</span>
<span class="sd">        filename (str): Name of the file to load or create.</span>
<span class="sd">        dbfilename (str): Name of the _func models file</span>
<span class="sd">        default_isolist (): Isolist applied to loaded models from ``dbfilename``.</span>
<span class="sd">        convert_units (bool): If ``True``  and data is stored in a mass unit all values will be divided by the</span>
<span class="sd">            mass number of the isotope before summing values together. The final value is then multiplied by the</span>
<span class="sd">            mass number of the output isotope.</span>
<span class="sd">        overwrite (bool): If ``True`` a new file will be created even if ``filename`` already exists.</span>
<span class="sd">        where (str): Used to select which models to load.</span>
<span class="sd">        **where_kwargs (): Keyword arguments used in combination with ``where``.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A [ModelCollection][simple.models.ModelCollection] object containing all the loaded models.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mc</span> <span class="o">=</span> <span class="n">ModelCollection</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">overwrite</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Loading existing file: </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">mc</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">where</span><span class="p">,</span> <span class="o">**</span><span class="n">where_kwargs</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">filename</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">:]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">!=</span> <span class="s1">&#39;.hdf5&#39;</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s1">.hdf5&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">overwrite</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Loading existing file: </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s1">.hdf5&#39;</span><span class="p">)</span>
        <span class="n">mc</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s1">.hdf5&#39;</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">where</span><span class="p">,</span> <span class="o">**</span><span class="n">where_kwargs</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">dbfilename</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;File </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s1"> does not exist&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">dbfilename</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Creating: &quot;</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s1">&quot; from database: &quot;</span><span class="si">{</span><span class="n">dbfilename</span><span class="si">}</span><span class="s1">&quot;&#39;</span><span class="p">)</span>
        <span class="n">mc</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="n">dbfilename</span><span class="p">,</span> <span class="n">isolist</span><span class="o">=</span><span class="n">default_isolist</span><span class="p">,</span> <span class="n">convert_unit</span><span class="o">=</span><span class="n">convert_unit</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">where</span><span class="p">,</span> <span class="o">**</span><span class="n">where_kwargs</span><span class="p">)</span>
        <span class="n">mc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Neither &quot;</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s1">&quot; or &quot;</span><span class="si">{</span><span class="n">dbfilename</span><span class="si">}</span><span class="s1">&quot; exist&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">mc</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="simple.models.load_csv_h" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">simple.models.load_csv_h</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">load_csv_h</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Returns a key array from a csv file where the first from is the columns keys and the remaining
rows contain the data.</p>

            <details class="quote">
              <summary>Source code in <code>simple/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">load_csv_h</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a key array from a csv file where the first from is the columns keys and the remaining</span>
<span class="sd">    rows contain the data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">csvfile</span><span class="p">:</span>
        <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">csvfile</span><span class="p">,</span> <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">row</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">reader</span> <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;#&#39;</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]]),</span> <span class="n">utils</span><span class="o">.</span><span class="n">asisotopes</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">allow_invalid</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="simple.models.load_models" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">simple.models.load_models</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">load_models</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

            <details class="quote">
              <summary>Source code in <code>simple/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">load_models</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="c1"># Keeps for legacy reasons. Use load_collection instead</span>
    <span class="k">return</span> <span class="n">load_collection</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="simple.models.load_ppn" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">simple.models.load_ppn</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">load_ppn</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Load a key array from a ppn file.</p>

            <details class="quote">
              <summary>Source code in <code>simple/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">load_ppn</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Load a key array from a ppn file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">isotopes</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">values</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">():</span>
            <span class="n">isotopes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">9</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">))</span>
            <span class="n">values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">10</span><span class="p">:]</span><span class="o">.</span><span class="n">strip</span><span class="p">()))</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">values</span><span class="p">),</span> <span class="n">utils</span><span class="o">.</span><span class="n">asisotopes</span><span class="p">(</span><span class="n">isotopes</span><span class="p">,</span> <span class="n">allow_invalid</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="simple.models.new_collection" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">simple.models.new_collection</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">new_collection</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Return an empty <a class="autorefs autorefs-internal" href="#simple.models.ModelCollection">ModelCollection</a> object.</p>

            <details class="quote">
              <summary>Source code in <code>simple/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">new_collection</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return an empty [ModelCollection][simple.models.ModelCollection] object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">ModelCollection</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>